<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_logger.f90 &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Contributing and specs</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>stdlib_logger.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.6% of total for source files.">683 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/stdlib_logger.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">stdlib_logger.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stdlib_logger.html">stdlib_logger</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stdlib_logger.f90.html#src">stdlib_logger.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.46.1 (20210213.1702)
 -->
<!-- Title: sourcefile~~stdlib_logger.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestdlib_loggerf90EfferentGraph" width="352pt" height="74pt"
 viewBox="0.00 0.00 352.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>sourcefile~~stdlib_logger.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 348,-70 348,4 -4,4"/>
<!-- sourcefile~stdlib_logger.f90 -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~stdlib_logger.f90</title>
<polygon fill="none" stroke="black" points="344,-45 253,-45 253,-21 344,-21 344,-45"/>
<text text-anchor="middle" x="298.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">stdlib_logger.f90</text>
</g>
<!-- sourcefile~stdlib_optval.fypp -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~stdlib_optval.fypp</title>
<g id="a_sourcefile~~stdlib_logger.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/stdlib_optval.fypp.html" xlink:title="stdlib_optval.fypp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="217,-66 122,-66 122,-42 217,-42 217,-66"/>
<text text-anchor="middle" x="169.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stdlib_optval.fypp</text>
</a>
</g>
</g>
<!-- sourcefile~stdlib_logger.f90&#45;&gt;sourcefile~stdlib_optval.fypp -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~stdlib_logger.f90&#45;&gt;sourcefile~stdlib_optval.fypp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.72,-40.4C244.41,-41.78 235.62,-43.23 227.01,-44.66"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.31,-41.22 217.02,-46.31 227.46,-48.13 226.31,-41.22"/>
</g>
<!-- sourcefile~stdlib_ascii.f90 -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~stdlib_ascii.f90</title>
<g id="a_sourcefile~~stdlib_logger.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/stdlib_ascii.f90.html" xlink:title="stdlib_ascii.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="210.5,-24 128.5,-24 128.5,0 210.5,0 210.5,-24"/>
<text text-anchor="middle" x="169.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stdlib_ascii.f90</text>
</a>
</g>
</g>
<!-- sourcefile~stdlib_logger.f90&#45;&gt;sourcefile~stdlib_ascii.f90 -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~stdlib_logger.f90&#45;&gt;sourcefile~stdlib_ascii.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M252.72,-25.6C242.33,-23.88 231.21,-22.04 220.61,-20.29"/>
<polygon fill="#ff0000" stroke="#ff0000" points="221.08,-16.82 210.64,-18.64 219.94,-23.72 221.08,-16.82"/>
</g>
<!-- sourcefile~stdlib_kinds.f90 -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~stdlib_kinds.f90</title>
<g id="a_sourcefile~~stdlib_logger.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/stdlib_kinds.f90.html" xlink:title="stdlib_kinds.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="86,-66 0,-66 0,-42 86,-42 86,-66"/>
<text text-anchor="middle" x="43" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stdlib_kinds.f90</text>
</a>
</g>
</g>
<!-- sourcefile~stdlib_optval.fypp&#45;&gt;sourcefile~stdlib_kinds.f90 -->
<g id="sourcefile~~stdlib_logger.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~stdlib_optval.fypp&#45;&gt;sourcefile~stdlib_kinds.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M121.79,-54C113.45,-54 104.71,-54 96.23,-54"/>
<polygon fill="#ff0000" stroke="#ff0000" points="96.05,-50.5 86.05,-54 96.05,-57.5 96.05,-50.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.46.1 (20210213.1702)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stdlib_logger.html">stdlib_logger</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stdlib_logger.f90.html#src">stdlib_logger.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="k">module </span><span class="n">stdlib_logger</span>
<a name="ln-2"></a><span class="c">!!### Module stdlib_logger</span>
<a name="ln-3"></a><span class="c">!!</span>
<a name="ln-4"></a><span class="c">!! This module defines a derived type, procedures, a variable, and</span>
<a name="ln-5"></a><span class="c">!! constants to be used for logging information and reporting errors</span>
<a name="ln-6"></a><span class="c">!! in Fortran applications.</span>
<a name="ln-7"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html))</span>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="c">!! The derived type, `logger_type`, is to be used to define variables to</span>
<a name="ln-10"></a><span class="c">!! serve as both local and global loggers. A logger directs its messages</span>
<a name="ln-11"></a><span class="c">!! to selected I/O units so the user has a record (a log) of major events.</span>
<a name="ln-12"></a><span class="c">!! For each entity of `logger_type` the reports go to a list of I/O units</span>
<a name="ln-13"></a><span class="c">!! represented by the private internal array, `log_units`. If `log_units` is</span>
<a name="ln-14"></a><span class="c">!! empty then output by default goes to `output_unit`. Otherwise reports</span>
<a name="ln-15"></a><span class="c">!! go to `output_unit` only if it has been explicitly added to `log_units`.</span>
<a name="ln-16"></a><span class="c">!! Each entity of type `logger_type` also maintains an internal state</span>
<a name="ln-17"></a><span class="c">!! controlling the formatting of output.</span>
<a name="ln-18"></a><span class="c">!!</span>
<a name="ln-19"></a><span class="c">!! The procedures are as follows. The logical function</span>
<a name="ln-20"></a><span class="c">!! `log_units_assigned` returns the number of I/O units in `log_units`. The</span>
<a name="ln-21"></a><span class="c">!! subroutines `add_log_file` and `add_log_unit` include the specified file</span>
<a name="ln-22"></a><span class="c">!! in `log_units`. `remove_log_units` removes the specified logical unit from</span>
<a name="ln-23"></a><span class="c">!! the `log_units` array and optionally closes the file. `configure`</span>
<a name="ln-24"></a><span class="c">!! configures the details of the logging process. `configuration`</span>
<a name="ln-25"></a><span class="c">!! reports the details of that configuration. The subroutines</span>
<a name="ln-26"></a><span class="c">!! `log_error`, `log_information`, `log_io_error`, `log_message`,</span>
<a name="ln-27"></a><span class="c">!! `log_text_error`, and `log_warning` send messages to the log units.</span>
<a name="ln-28"></a><span class="c">!!</span>
<a name="ln-29"></a><span class="c">!! The variable `global_logger` of type `logger_type` can be used</span>
<a name="ln-30"></a><span class="c">!! as a default global logger anywhere in the source code.</span>
<a name="ln-31"></a><span class="c">!!</span>
<a name="ln-32"></a><span class="c">!! The constants are used to report errors by some of the subroutines</span>
<a name="ln-33"></a><span class="c">!! in their optional `stat` arguments. The constants are as follows.</span>
<a name="ln-34"></a><span class="c">!! `success` indicates that no error has occurred. `close_failure`</span>
<a name="ln-35"></a><span class="c">!! indicates that a `close` statement for an I/O unit failed.</span>
<a name="ln-36"></a><span class="c">!! `index_invalid_error` indicates that `column` was invalid for</span>
<a name="ln-37"></a><span class="c">!! the given `line`. `open_failure` indicates that an `open` statement</span>
<a name="ln-38"></a><span class="c">!! failed. `read_only_error` indicates that an output unit did not have a</span>
<a name="ln-39"></a><span class="c">!! `&quot;write&quot;` or `&quot;readwrite&quot;` action. `non_sequential_error` indicates</span>
<a name="ln-40"></a><span class="c">!! that the unit did not have `sequential` access. `unformatted_in_error`</span>
<a name="ln-41"></a><span class="c">!! indicates that the unit did not have a `form` of `&quot;formatted&quot;`.</span>
<a name="ln-42"></a><span class="c">!! `unopened_in_error` indicates that the unit was not opened. `write_failure`</span>
<a name="ln-43"></a><span class="c">!! indicates that at least one of the writes to `log_units` failed.</span>
<a name="ln-44"></a>
<a name="ln-45"></a>    <span class="k">use</span><span class="p">,</span> <span class="k">intrinsic</span> <span class="kd">::</span>           <span class="p">&amp;</span>
<a name="ln-46"></a>        <span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="p">&amp;</span>
<a name="ln-47"></a>        <span class="n">error_unit</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-48"></a>        <span class="n">input_unit</span><span class="p">,</span>             <span class="p">&amp;</span>
<a name="ln-49"></a>        <span class="n">output_unit</span>
<a name="ln-50"></a>
<a name="ln-51"></a>    <span class="k">use </span><span class="n">stdlib_ascii</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">to_lower</span>
<a name="ln-52"></a>    <span class="k">use </span><span class="n">stdlib_optval</span><span class="p">,</span> <span class="n">only</span> <span class="p">:</span> <span class="n">optval</span>
<a name="ln-53"></a>
<a name="ln-54"></a>    <span class="k">implicit none</span>
<a name="ln-55"></a>
<a name="ln-56"></a><span class="k">    private</span>
<a name="ln-57"></a><span class="k">    public</span> <span class="kd">::</span> <span class="n">global_logger</span><span class="p">,</span> <span class="n">logger_type</span>
<a name="ln-58"></a>
<a name="ln-59"></a>    <span class="c">!! public constants used as error flags</span>
<a name="ln-60"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span> <span class="p">&amp;</span>
<a name="ln-61"></a>        <span class="n">success</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>              <span class="p">&amp;</span>
<a name="ln-62"></a>        <span class="n">close_failure</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-63"></a>        <span class="n">index_invalid_error</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-64"></a>        <span class="n">non_sequential_error</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-65"></a>        <span class="n">open_failure</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-66"></a>        <span class="n">read_only_error</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-67"></a>        <span class="n">unformatted_in_error</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-68"></a>        <span class="n">unopened_in_error</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-69"></a>        <span class="n">write_failure</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-70"></a>
<a name="ln-71"></a>    <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span><span class="p">,</span> <span class="k">public</span> <span class="kd">::</span>      <span class="p">&amp;</span>
<a name="ln-72"></a>        <span class="n">debug_level</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-73"></a>        <span class="n">information_level</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-74"></a>        <span class="n">warning_level</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-75"></a>        <span class="n">error_level</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-76"></a>        <span class="n">io_error_level</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>    <span class="p">&amp;</span>
<a name="ln-77"></a>        <span class="n">text_error_level</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-78"></a>        <span class="n">all_level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-79"></a>            <span class="n">debug_level</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-80"></a>            <span class="n">information_level</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-81"></a>            <span class="n">warning_level</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-82"></a>            <span class="n">error_level</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-83"></a>            <span class="n">io_error_level</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-84"></a>            <span class="n">text_error_level</span><span class="p">),</span>  <span class="p">&amp;</span>
<a name="ln-85"></a>        <span class="n">none_level</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span>  <span class="p">&amp;</span>
<a name="ln-86"></a>            <span class="n">debug_level</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-87"></a>            <span class="n">information_level</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-88"></a>            <span class="n">warning_level</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-89"></a>            <span class="n">error_level</span><span class="p">,</span>        <span class="p">&amp;</span>
<a name="ln-90"></a>            <span class="n">io_error_level</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-91"></a>            <span class="n">text_error_level</span><span class="p">)</span>
<a name="ln-92"></a>
<a name="ln-93"></a>    <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">module_name</span> <span class="o">=</span> <span class="s1">&#39;stdlib_logger&#39;</span>
<a name="ln-94"></a>
<a name="ln-95"></a>    <span class="k">type</span> <span class="kd">::</span> <span class="n">logger_type</span>
<a name="ln-96"></a>        <span class="c">!! version: experimental</span>
<a name="ln-97"></a>        
<a name="ln-98"></a>        <span class="c">!! Public derived type ([Specification](../page/specs/stdlib_logger.html#the-derived-type-logger_type))</span>
<a name="ln-99"></a>        <span class="k">private</span>
<a name="ln-100"></a>
<a name="ln-101"></a><span class="k">        </span><span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">add_blank_line</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-102"></a>        <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">indent_lines</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-103"></a>        <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">level</span> <span class="o">=</span> <span class="n">information_level</span>
<a name="ln-104"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span>      <span class="kd">::</span> <span class="n">log_units</span><span class="p">(:)</span>
<a name="ln-105"></a>        <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">max_width</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-106"></a>        <span class="kt">logical</span>                   <span class="kd">::</span> <span class="n">time_stamp</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-107"></a>        <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">units</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-108"></a>
<a name="ln-109"></a>    <span class="k">contains</span>
<a name="ln-110"></a>
<a name="ln-111"></a><span class="k">        private</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">        procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">add_log_file</span>
<a name="ln-114"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">add_log_unit</span>
<a name="ln-115"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">configuration</span>
<a name="ln-116"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">configure</span>
<a name="ln-117"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_debug</span>
<a name="ln-118"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_error</span>
<a name="ln-119"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_information</span>
<a name="ln-120"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_io_error</span>
<a name="ln-121"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_message</span>
<a name="ln-122"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_text_error</span>
<a name="ln-123"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_units_assigned</span>
<a name="ln-124"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">log_warning</span>
<a name="ln-125"></a>        <span class="k">procedure</span><span class="p">,</span> <span class="k">public</span><span class="p">,</span> <span class="k">pass</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="kd">::</span> <span class="n">remove_log_unit</span>
<a name="ln-126"></a>
<a name="ln-127"></a>        <span class="k">final</span> <span class="kd">::</span> <span class="n">final_logger</span>
<a name="ln-128"></a>
<a name="ln-129"></a>    <span class="k">end type </span><span class="n">logger_type</span>
<a name="ln-130"></a>
<a name="ln-131"></a>    <span class="c">!! Variable of type `logger_type` to be used as a global logger</span>
<a name="ln-132"></a>    <span class="k">type</span><span class="p">(</span><span class="n">logger_type</span><span class="p">)</span> <span class="kd">::</span> <span class="n">global_logger</span>
<a name="ln-133"></a>
<a name="ln-134"></a>    <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="p">&amp;</span>
<a name="ln-135"></a>        <span class="n">invalid_column</span> <span class="o">=</span> <span class="s1">&#39;column is not a valid index to line.&#39;</span>
<a name="ln-136"></a>
<a name="ln-137"></a><span class="k">contains</span>
<a name="ln-138"></a>
<a name="ln-139"></a><span class="k">    subroutine </span><span class="n">add_log_file</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-140"></a>                             <span class="nb">stat</span> <span class="p">)</span>
<a name="ln-141"></a><span class="c">!! version: experimental</span>
<a name="ln-142"></a>
<a name="ln-143"></a><span class="c">!! Opens a formatted sequential access output file, `filename` using</span>
<a name="ln-144"></a><span class="c">!! `newunit` and adds the resulting unit number to `self`&#39;s `log_units`</span>
<a name="ln-145"></a><span class="c">!! array. `action`, if present, is the `action` specifier of the `open`</span>
<a name="ln-146"></a><span class="c">!! statement, and has the default value of `&quot;write&quot;`. `position`, if present,</span>
<a name="ln-147"></a><span class="c">!! is the `position` specifier, and has the default value of `&quot;REWIND&quot;`.</span>
<a name="ln-148"></a><span class="c">!! `status`, if present, is the `status` specifier of the `open` statement,</span>
<a name="ln-149"></a><span class="c">!! and has the default value of `&quot;REPLACE&quot;`. `stat`, if present, has the value</span>
<a name="ln-150"></a><span class="c">!! `success` if `filename` could be opened, `read_only_error` if `action` is</span>
<a name="ln-151"></a><span class="c">!! `&quot;read&quot;`, and `open_failure` otherwise.</span>
<a name="ln-152"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#add_log_file-open-a-file-and-add-its-unit-to-self-log_units))</span>
<a name="ln-153"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">self</span>
<a name="ln-154"></a><span class="c">!! The logger variable to which the file is to be added</span>
<a name="ln-155"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-156"></a><span class="c">!! The name of the file to be  added to the logger</span>
<a name="ln-157"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-158"></a><span class="c">!! The resulting I/O unit number</span>
<a name="ln-159"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">action</span>
<a name="ln-160"></a><span class="c">!! The `action` specifier for the `open`` statement</span>
<a name="ln-161"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">position</span>
<a name="ln-162"></a><span class="c">!! The `position` specifier for the `open` statement</span>
<a name="ln-163"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">status</span>
<a name="ln-164"></a><span class="c">!! The `status` specifier for the  `open`  statement</span>
<a name="ln-165"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-166"></a><span class="c">!! The error status on exit with the possible values</span>
<a name="ln-167"></a><span class="c">!! * `success` - no errors found</span>
<a name="ln-168"></a><span class="c">!! * `read_only_error` - file unopened as `action1 was `&quot;read&quot;` for an output</span>
<a name="ln-169"></a><span class="c">!!   file</span>
<a name="ln-170"></a><span class="c">!! * `open_failure` - the `open` statement failed</span>
<a name="ln-171"></a>
<a name="ln-172"></a>
<a name="ln-173"></a><span class="c">!!##### Example</span>
<a name="ln-174"></a><span class="c">!!</span>
<a name="ln-175"></a><span class="c">!!     program main</span>
<a name="ln-176"></a><span class="c">!!         use stdlib_logger</span>
<a name="ln-177"></a><span class="c">!!         ...</span>
<a name="ln-178"></a><span class="c">!!         integer :: unit, stat</span>
<a name="ln-179"></a><span class="c">!!         ...</span>
<a name="ln-180"></a><span class="c">!!         call global_logger % add_log_file( &#39;error_log.txt&#39;, unit,      &amp;</span>
<a name="ln-181"></a><span class="c">!!                                            position=&#39;asis&#39;, stat=stat )</span>
<a name="ln-182"></a><span class="c">!!         if ( stat /= success ) then</span>
<a name="ln-183"></a><span class="c">!!             error stop &#39;Unable to open &quot;error_log.txt&quot;.&#39;</span>
<a name="ln-184"></a><span class="c">!!         end if</span>
<a name="ln-185"></a><span class="c">!!         ...</span>
<a name="ln-186"></a><span class="c">!!     end program main</span>
<a name="ln-187"></a>
<a name="ln-188"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">aaction</span><span class="p">,</span> <span class="n">aposition</span><span class="p">,</span> <span class="n">astatus</span>
<a name="ln-189"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">aunit</span>
<a name="ln-190"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-191"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-192"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;add_log_file&#39;</span>
<a name="ln-193"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dummy</span><span class="p">(:)</span>
<a name="ln-194"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">lun</span>
<a name="ln-195"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">i</span>
<a name="ln-196"></a>
<a name="ln-197"></a>        <span class="n">aaction</span> <span class="o">=</span> <span class="n">optval</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">)</span>
<a name="ln-198"></a>        <span class="n">aposition</span> <span class="o">=</span> <span class="n">optval</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="s1">&#39;rewind&#39;</span><span class="p">)</span>
<a name="ln-199"></a>        <span class="n">astatus</span> <span class="o">=</span> <span class="n">optval</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-200"></a>
<a name="ln-201"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">aaction</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="k">            do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<a name="ln-204"></a>                <span class="n">aaction</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">to_lower</span><span class="p">(</span><span class="n">aaction</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">))</span>
<a name="ln-205"></a>            <span class="k">end do</span>
<a name="ln-206"></a>
<a name="ln-207"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">aaction</span> <span class="o">==</span> <span class="s1">&#39;read&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-208"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span> <span class="nb">stat</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-209"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">read_only_error</span>
<a name="ln-210"></a>                    <span class="k">return</span>
<a name="ln-211"></a><span class="k">                else</span>
<a name="ln-212"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;In &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span>         <span class="p">&amp;</span>
<a name="ln-213"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; action is &quot;read&quot; which &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-214"></a>                        <span class="s1">&#39;does not allow writes to the file.&#39;</span>
<a name="ln-215"></a>                <span class="k">end if</span>
<a name="ln-216"></a><span class="k">            end if</span>
<a name="ln-217"></a>
<a name="ln-218"></a><span class="k">        end if</span>
<a name="ln-219"></a>
<a name="ln-220"></a><span class="k">        open</span><span class="p">(</span> <span class="n">newunit</span><span class="o">=</span><span class="n">aunit</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">aaction</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-221"></a>              <span class="n">position</span><span class="o">=</span><span class="n">aposition</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">astatus</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-222"></a>              <span class="n">err</span><span class="o">=</span><span class="mi">999</span> <span class="p">)</span>
<a name="ln-223"></a>
<a name="ln-224"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">)</span> <span class="o">==</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-226"></a><span class="k">                allocate</span><span class="p">(</span> <span class="n">dummy</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-227"></a>                <span class="k">do </span><span class="n">lun</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-228"></a>                    <span class="n">dummy</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span>
<a name="ln-229"></a>                <span class="k">end do</span>
<a name="ln-230"></a><span class="k">                </span><span class="n">dummy</span><span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span><span class="o">+</span><span class="mi">1</span><span class="p">:)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-231"></a>                <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span> <span class="p">)</span>
<a name="ln-232"></a>            <span class="k">end if</span>
<a name="ln-233"></a><span class="k">        else</span>
<a name="ln-234"></a><span class="k">            allocate</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-235"></a>        <span class="k">end if</span>
<a name="ln-236"></a>
<a name="ln-237"></a><span class="k">        </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="n">aunit</span>
<a name="ln-238"></a>        <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-239"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="p">)</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">aunit</span>
<a name="ln-240"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">success</span>
<a name="ln-241"></a>
<a name="ln-242"></a>        <span class="k">return</span>
<a name="ln-243"></a>
<a name="ln-244"></a><span class="mi">999</span>     <span class="k">if</span> <span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-245"></a><span class="k">            </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">open_failure</span>
<a name="ln-246"></a>            <span class="k">return</span>
<a name="ln-247"></a><span class="k">        else</span>
<a name="ln-248"></a><span class="k">            call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_io_error</span><span class="p">(</span> <span class="s1">&#39;Unable to open &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-249"></a>                                      <span class="k">module</span> <span class="o">=</span> <span class="n">module_name</span><span class="p">,</span>                <span class="p">&amp;</span>
<a name="ln-250"></a>                                      <span class="k">procedure</span> <span class="o">=</span> <span class="n">procedure_name</span><span class="p">,</span>          <span class="p">&amp;</span>
<a name="ln-251"></a>                                      <span class="n">iostat</span> <span class="o">=</span> <span class="n">iostat</span><span class="p">,</span>                     <span class="p">&amp;</span>
<a name="ln-252"></a>                                      <span class="n">iomsg</span> <span class="o">=</span> <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-253"></a>            <span class="n">error</span> <span class="k">stop </span><span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="n">procedure_name</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-254"></a>                <span class="s1">&#39;: Unable to open file&#39;</span>
<a name="ln-255"></a>        <span class="k">end if</span>
<a name="ln-256"></a>
<a name="ln-257"></a><span class="k">    end subroutine </span><span class="n">add_log_file</span>
<a name="ln-258"></a>
<a name="ln-259"></a>
<a name="ln-260"></a>    <span class="k">subroutine </span><span class="n">add_log_unit</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="nb">stat</span> <span class="p">)</span>
<a name="ln-261"></a><span class="c">!! version: experimental</span>
<a name="ln-262"></a>
<a name="ln-263"></a><span class="c">!! Adds `unit` to the log file units in `log_units`. `unit` must be an `open`</span>
<a name="ln-264"></a><span class="c">!! file, of `form` `&quot;formatted&quot;`, with `&quot;sequential&quot;` `access`, and an `action`</span>
<a name="ln-265"></a><span class="c">!! of `&quot;write&quot;` or `&quot;readwrite&quot;`, otherwise either `stat`, if present, has a</span>
<a name="ln-266"></a><span class="c">!! value other than `success` and `unit` is not entered into `log_units`,</span>
<a name="ln-267"></a><span class="c">!! or, if `stat` is not presecn, processing stops.</span>
<a name="ln-268"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#add_log_unit-add-a-unit-to-the-array-self-log_units))</span>
<a name="ln-269"></a>
<a name="ln-270"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
<a name="ln-271"></a><span class="c">!! The logger variable to which the I/O unit is to be added</span>
<a name="ln-272"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-273"></a><span class="c">!! The input logical unit number</span>
<a name="ln-274"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-275"></a><span class="c">!! An error code with the possible values</span>
<a name="ln-276"></a><span class="c">!! * `success` - no problems were found</span>
<a name="ln-277"></a><span class="c">!! * `non_sequential_error` - `unit` did not have sequential access</span>
<a name="ln-278"></a><span class="c">!! * `read_only_error` - `unit` was not writeable</span>
<a name="ln-279"></a><span class="c">!! * `unformatted_in_error` - `unit` was an `&#39;unformatted&#39;` file</span>
<a name="ln-280"></a><span class="c">!! * `unopened_in_error` - `unit` was not opened</span>
<a name="ln-281"></a>
<a name="ln-282"></a><span class="c">!!##### Example</span>
<a name="ln-283"></a><span class="c">!!</span>
<a name="ln-284"></a><span class="c">!!     program main</span>
<a name="ln-285"></a><span class="c">!!         use stdlib_logger</span>
<a name="ln-286"></a><span class="c">!!         ...</span>
<a name="ln-287"></a><span class="c">!!         character(256) :: iomsg</span>
<a name="ln-288"></a><span class="c">!!         integer :: iostat, unit, stat</span>
<a name="ln-289"></a><span class="c">!!         ...</span>
<a name="ln-290"></a><span class="c">!!         open( newunit=unit, &#39;error_log.txt&#39;, form=&#39;formatted&#39;, &amp;</span>
<a name="ln-291"></a><span class="c">!!               status=&#39;replace&#39;, position=&#39;rewind&#39;, err=999,    &amp;</span>
<a name="ln-292"></a><span class="c">!!               action=&#39;read&#39;, iostat=iostat, iomsg=iomsg )</span>
<a name="ln-293"></a><span class="c">!!         ...</span>
<a name="ln-294"></a><span class="c">!!         call global_logger % add_log_unit( unit, stat )</span>
<a name="ln-295"></a><span class="c">!!         select case ( stat )</span>
<a name="ln-296"></a><span class="c">!!         ...</span>
<a name="ln-297"></a><span class="c">!!         case ( read_only_error )</span>
<a name="ln-298"></a><span class="c">!!             error stop &#39;Unable to write to &quot;error_log.txt&quot;.&#39;</span>
<a name="ln-299"></a><span class="c">!!         ...</span>
<a name="ln-300"></a><span class="c">!!         end select</span>
<a name="ln-301"></a><span class="c">!!         ...</span>
<a name="ln-302"></a><span class="c">!!     999 error stop &#39;Unable to open &quot;error_log.txt&quot;.</span>
<a name="ln-303"></a><span class="c">!!         ...</span>
<a name="ln-304"></a><span class="c">!!     end program main</span>
<a name="ln-305"></a>
<a name="ln-306"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dummy</span><span class="p">(:)</span>
<a name="ln-307"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;set_log_unit&#39;</span>
<a name="ln-308"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lun</span>
<a name="ln-309"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="kd">::</span> <span class="n">specifier</span>
<a name="ln-310"></a>        <span class="kt">logical</span> <span class="kd">::</span> <span class="n">question</span>
<a name="ln-311"></a>
<a name="ln-312"></a>        <span class="k">call </span><span class="n">validate_unit</span><span class="p">()</span>
<a name="ln-313"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-314"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">stat</span> <span class="o">/=</span> <span class="n">success</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-315"></a><span class="k">        end if</span>
<a name="ln-316"></a>
<a name="ln-317"></a><span class="k">        do </span><span class="n">lun</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-318"></a><span class="c">! Check that unit is not already registered</span>
<a name="ln-319"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-320"></a><span class="k">        end do</span>
<a name="ln-321"></a>
<a name="ln-322"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">allocated</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-323"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">size</span><span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">)</span> <span class="o">==</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-324"></a><span class="k">                allocate</span><span class="p">(</span> <span class="n">dummy</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-325"></a>                <span class="k">do </span><span class="n">lun</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-326"></a>                    <span class="n">dummy</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span>
<a name="ln-327"></a>                <span class="k">end do</span>
<a name="ln-328"></a><span class="k">                call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span> <span class="p">)</span>
<a name="ln-329"></a>            <span class="k">end if</span>
<a name="ln-330"></a><span class="k">        else</span>
<a name="ln-331"></a><span class="k">            allocate</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-332"></a>        <span class="k">end if</span>
<a name="ln-333"></a>
<a name="ln-334"></a><span class="k">        </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">=</span> <span class="n">unit</span>
<a name="ln-335"></a>        <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-336"></a>
<a name="ln-337"></a>    <span class="k">contains</span>
<a name="ln-338"></a>
<a name="ln-339"></a><span class="k">        subroutine </span><span class="n">validate_unit</span><span class="p">()</span>
<a name="ln-340"></a>
<a name="ln-341"></a><span class="c">! Check that unit is not input_unit</span>
<a name="ln-342"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">input_unit</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-343"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-344"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">read_only_error</span>
<a name="ln-345"></a>                    <span class="k">return</span>
<a name="ln-346"></a><span class="k">                else</span>
<a name="ln-347"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;unit in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-348"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; must not be input_unit.&#39;</span>
<a name="ln-349"></a>                <span class="k">end if</span>
<a name="ln-350"></a><span class="k">            end if</span>
<a name="ln-351"></a>
<a name="ln-352"></a><span class="c">! Check that unit is opened</span>
<a name="ln-353"></a>            <span class="k">inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">opened</span><span class="o">=</span><span class="n">question</span> <span class="p">)</span>
<a name="ln-354"></a>            <span class="k">if</span> <span class="p">(</span> <span class="p">.</span><span class="nb">not</span><span class="p">.</span> <span class="n">question</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-355"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-356"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">unopened_in_error</span>
<a name="ln-357"></a>                    <span class="k">return</span>
<a name="ln-358"></a><span class="k">                else</span>
<a name="ln-359"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;unit in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-360"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; is not open.&#39;</span>
<a name="ln-361"></a>                <span class="k">end if</span>
<a name="ln-362"></a><span class="k">            end if</span>
<a name="ln-363"></a>
<a name="ln-364"></a><span class="c">! Check that unit is writeable</span>
<a name="ln-365"></a>            <span class="k">inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="k">write</span><span class="o">=</span><span class="n">specifier</span> <span class="p">)</span>
<a name="ln-366"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;Y&#39;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;y&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-367"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-368"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">read_only_error</span>
<a name="ln-369"></a>                    <span class="k">return</span>
<a name="ln-370"></a><span class="k">                else</span>
<a name="ln-371"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;unit in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-372"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; is not writeable.&#39;</span>
<a name="ln-373"></a>                <span class="k">end if</span>
<a name="ln-374"></a><span class="k">            end if</span>
<a name="ln-375"></a>
<a name="ln-376"></a><span class="k">            inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">sequential</span><span class="o">=</span><span class="n">specifier</span> <span class="p">)</span>
<a name="ln-377"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;Y&#39;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;y&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-378"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-379"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">non_sequential_error</span>
<a name="ln-380"></a>                    <span class="k">return</span>
<a name="ln-381"></a><span class="k">                else</span>
<a name="ln-382"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;unit in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-383"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; is not &quot;sequential&quot;.&#39;</span>
<a name="ln-384"></a>                <span class="k">end if</span>
<a name="ln-385"></a><span class="k">            end if</span>
<a name="ln-386"></a>
<a name="ln-387"></a><span class="k">            inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="n">specifier</span> <span class="p">)</span>
<a name="ln-388"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;Y&#39;</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">specifier</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span> <span class="o">/=</span> <span class="s1">&#39;y&#39;</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-389"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-390"></a><span class="k">                    </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">unformatted_in_error</span>
<a name="ln-391"></a>                    <span class="k">return</span>
<a name="ln-392"></a><span class="k">                else</span>
<a name="ln-393"></a><span class="k">                    </span><span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;unit in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-394"></a>                        <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; is not &quot;formatted&quot;.&#39;</span>
<a name="ln-395"></a>                <span class="k">end if</span>
<a name="ln-396"></a><span class="k">            end if</span>
<a name="ln-397"></a>
<a name="ln-398"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">success</span>
<a name="ln-399"></a>
<a name="ln-400"></a>        <span class="k">end subroutine </span><span class="n">validate_unit</span>
<a name="ln-401"></a>
<a name="ln-402"></a>    <span class="k">end subroutine </span><span class="n">add_log_unit</span>
<a name="ln-403"></a>
<a name="ln-404"></a>
<a name="ln-405"></a>    <span class="k">pure subroutine </span><span class="n">configuration</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">add_blank_line</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-406"></a>        <span class="n">max_width</span><span class="p">,</span> <span class="n">time_stamp</span><span class="p">,</span> <span class="n">log_units</span> <span class="p">)</span>
<a name="ln-407"></a><span class="c">!! version: experimental</span>
<a name="ln-408"></a>
<a name="ln-409"></a><span class="c">!! Reports the logging configuration of `self`. The following attributes are</span>
<a name="ln-410"></a><span class="c">!! reported:</span>
<a name="ln-411"></a><span class="c">!! 1. `add_blank_line` is a logical flag with `.true.` implying that output</span>
<a name="ln-412"></a><span class="c">!!    starts with a blank line, and `.false.` implying no blank line.</span>
<a name="ln-413"></a><span class="c">!! 2. `indent` is a logical flag with `.true.` implying that subsequent columns</span>
<a name="ln-414"></a><span class="c">!!    will be indented 4 spaces and `.false.` implying no indentation.</span>
<a name="ln-415"></a><span class="c">!! 3. `level` is the lowest level for printing a message</span>
<a name="ln-416"></a><span class="c">!! 4. `max_width` is the maximum number of columns of output text with</span>
<a name="ln-417"></a><span class="c">!!    `max_width` == 0 =&gt; no bounds on output width.</span>
<a name="ln-418"></a><span class="c">!! 5. `time_stamp` is a logical flag with `.true.` implying that the output</span>
<a name="ln-419"></a><span class="c">!!    will have a time stamp, and `.false.` implying that there will be no</span>
<a name="ln-420"></a><span class="c">!!    time stamp.</span>
<a name="ln-421"></a><span class="c">!! 6. `log_units` is an array of the I/O unit numbers to which log output</span>
<a name="ln-422"></a><span class="c">!!    will be written.</span>
<a name="ln-423"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#configuration-report-a-loggers-configuration))</span>
<a name="ln-424"></a>
<a name="ln-425"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">self</span>
<a name="ln-426"></a><span class="c">!! The logger variable whose configuration is being reported</span>
<a name="ln-427"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>              <span class="kd">::</span> <span class="n">add_blank_line</span>
<a name="ln-428"></a><span class="c">!! A logical flag to add a preceding blank line</span>
<a name="ln-429"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>              <span class="kd">::</span> <span class="n">indent</span>
<a name="ln-430"></a><span class="c">!! A logical flag to indent subsequent lines</span>
<a name="ln-431"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>              <span class="kd">::</span> <span class="n">level</span>
<a name="ln-432"></a><span class="c">!! The minimum level for printing a message</span>
<a name="ln-433"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>              <span class="kd">::</span> <span class="n">max_width</span>
<a name="ln-434"></a><span class="c">!! The maximum number of columns for most outputs</span>
<a name="ln-435"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>              <span class="kd">::</span> <span class="n">time_stamp</span>
<a name="ln-436"></a><span class="c">!! A logical flag to add a time stamp</span>
<a name="ln-437"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">optional</span> <span class="kd">::</span> <span class="n">log_units</span><span class="p">(:)</span>
<a name="ln-438"></a><span class="c">!! The I/O units used in output</span>
<a name="ln-439"></a>
<a name="ln-440"></a><span class="c">!!##### Example</span>
<a name="ln-441"></a><span class="c">!!</span>
<a name="ln-442"></a><span class="c">!!     module example_mod</span>
<a name="ln-443"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-444"></a><span class="c">!!       ...</span>
<a name="ln-445"></a><span class="c">!!     contains</span>
<a name="ln-446"></a><span class="c">!!       ...</span>
<a name="ln-447"></a><span class="c">!!       subroutine example_sub(unit, ...)</span>
<a name="ln-448"></a><span class="c">!!         integer, intent(in) :: unit</span>
<a name="ln-449"></a><span class="c">!!         ...</span>
<a name="ln-450"></a><span class="c">!!         integer, allocatable :: log_units(:)</span>
<a name="ln-451"></a><span class="c">!!         ...</span>
<a name="ln-452"></a><span class="c">!!         call global_logger % configuration( log_units=log_units )</span>
<a name="ln-453"></a><span class="c">!!         if ( size(log_units) == 0 ) then</span>
<a name="ln-454"></a><span class="c">!!            call add_logger_unit( unit )</span>
<a name="ln-455"></a><span class="c">!!         end if</span>
<a name="ln-456"></a><span class="c">!!         ..</span>
<a name="ln-457"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-458"></a><span class="c">!!       ...</span>
<a name="ln-459"></a><span class="c">!!     end module example_mod</span>
<a name="ln-460"></a>
<a name="ln-461"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">add_blank_line</span><span class="p">)</span> <span class="p">)</span> <span class="n">add_blank_line</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">add_blank_line</span>
<a name="ln-462"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span> <span class="p">)</span> <span class="n">indent</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">indent_lines</span>
<a name="ln-463"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">)</span> <span class="n">level</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span>
<a name="ln-464"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">max_width</span><span class="p">)</span> <span class="p">)</span> <span class="n">max_width</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span>
<a name="ln-465"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">time_stamp</span><span class="p">)</span> <span class="p">)</span> <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">time_stamp</span>
<a name="ln-466"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">log_units</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-467"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="p">.</span><span class="n">gt</span><span class="p">.</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-468"></a><span class="k">                </span><span class="n">log_units</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span><span class="p">)</span>
<a name="ln-469"></a>            <span class="k">else</span>
<a name="ln-470"></a><span class="k">                allocate</span><span class="p">(</span><span class="n">log_units</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<a name="ln-471"></a>            <span class="k">end if</span>
<a name="ln-472"></a><span class="k">        end if</span>
<a name="ln-473"></a>
<a name="ln-474"></a><span class="k">    end subroutine </span><span class="n">configuration</span>
<a name="ln-475"></a>
<a name="ln-476"></a>
<a name="ln-477"></a>    <span class="k">pure subroutine </span><span class="n">configure</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">add_blank_line</span><span class="p">,</span> <span class="n">indent</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">max_width</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-478"></a>        <span class="n">time_stamp</span> <span class="p">)</span>
<a name="ln-479"></a><span class="c">!! version: experimental</span>
<a name="ln-480"></a>
<a name="ln-481"></a><span class="c">!! Configures the logging process for SELF. The following attributes are</span>
<a name="ln-482"></a><span class="c">!! configured:</span>
<a name="ln-483"></a><span class="c">!! 1. `add_blank_line` is a logical flag with `.true.` implying that output</span>
<a name="ln-484"></a><span class="c">!!    starts with a blank line, and `.false.` implying no blank line.</span>
<a name="ln-485"></a><span class="c">!!    `add_blank_line` has a startup value of `.false.`.</span>
<a name="ln-486"></a><span class="c">!! 2. `indent` is a logical flag with `.true.` implying that subsequent lines</span>
<a name="ln-487"></a><span class="c">!!    will be indented 4 spaces and `.false.` implying no indentation. `indent`</span>
<a name="ln-488"></a><span class="c">!!    has a startup value of `.true.`.</span>
<a name="ln-489"></a><span class="c">!! 3. `level` is the lowest level for printing a message</span>
<a name="ln-490"></a><span class="c">!! 4. `max_width` is the maximum number of columns of output text with</span>
<a name="ln-491"></a><span class="c">!!    `max_width == 0` =&gt; no bounds on output width. `max_width` has a startup</span>
<a name="ln-492"></a><span class="c">!!    value of 0.</span>
<a name="ln-493"></a><span class="c">!! 5. `time_stamp` is a logical flag with `.true.` implying that the output</span>
<a name="ln-494"></a><span class="c">!!    will have a time stamp, and `.false.` implying that there will be no</span>
<a name="ln-495"></a><span class="c">!!    time stamp. `time_stamp` has a startup value of `.true.`.</span>
<a name="ln-496"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#configure-configure-the-logging-process))</span>
<a name="ln-497"></a><span class="c">!!##### Example</span>
<a name="ln-498"></a><span class="c">!!</span>
<a name="ln-499"></a><span class="c">!!     program main</span>
<a name="ln-500"></a><span class="c">!!         use stdlib_logger</span>
<a name="ln-501"></a><span class="c">!!         ...</span>
<a name="ln-502"></a><span class="c">!!         call global_logger % configure( indent=.false., max_width=72 )</span>
<a name="ln-503"></a><span class="c">!!         ...</span>
<a name="ln-504"></a>
<a name="ln-505"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
<a name="ln-506"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">add_blank_line</span>
<a name="ln-507"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">indent</span>
<a name="ln-508"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">level</span>
<a name="ln-509"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">max_width</span>
<a name="ln-510"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">time_stamp</span>
<a name="ln-511"></a>
<a name="ln-512"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">add_blank_line</span><span class="p">)</span> <span class="p">)</span> <span class="n">self</span> <span class="p">%</span> <span class="n">add_blank_line</span> <span class="o">=</span> <span class="n">add_blank_line</span>
<a name="ln-513"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">)</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
<a name="ln-514"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span> <span class="p">)</span> <span class="n">self</span> <span class="p">%</span> <span class="n">indent_lines</span> <span class="o">=</span> <span class="n">indent</span>
<a name="ln-515"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">max_width</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-516"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">max_width</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-517"></a><span class="k">                </span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-518"></a>            <span class="k">else</span>
<a name="ln-519"></a><span class="k">                </span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">=</span> <span class="n">max_width</span>
<a name="ln-520"></a>            <span class="k">end if</span>
<a name="ln-521"></a><span class="k">        end if</span>
<a name="ln-522"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">time_stamp</span><span class="p">)</span> <span class="p">)</span> <span class="n">self</span> <span class="p">%</span> <span class="n">time_stamp</span> <span class="o">=</span> <span class="n">time_stamp</span>
<a name="ln-523"></a>
<a name="ln-524"></a>    <span class="k">end subroutine </span><span class="n">configure</span>
<a name="ln-525"></a>
<a name="ln-526"></a>
<a name="ln-527"></a>    <span class="k">subroutine </span><span class="n">final_logger</span><span class="p">(</span> <span class="n">self</span> <span class="p">)</span>
<a name="ln-528"></a><span class="c">!! version: experimental</span>
<a name="ln-529"></a>
<a name="ln-530"></a><span class="c">!! Finalizes the `logger_type` entity `self` by flushing the units</span>
<a name="ln-531"></a>        <span class="k">type</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
<a name="ln-532"></a>
<a name="ln-533"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-534"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">message</span>
<a name="ln-535"></a>        <span class="kt">integer</span>        <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-536"></a>
<a name="ln-537"></a>        <span class="k">do </span><span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-538"></a>            <span class="nb">flush</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span> <span class="p">)</span>
<a name="ln-539"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">iostat</span> <span class="o">/=</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-540"></a><span class="k">                write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span> <span class="p">)</span> <span class="s1">&#39;In the logger_type &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-541"></a>                    <span class="s1">&#39;finalizer an error occurred in flushing unit = &#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-542"></a>                    <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
<a name="ln-543"></a>                <span class="k">write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;With iostat = &#39;</span><span class="p">,</span> <span class="n">iostat</span>
<a name="ln-544"></a>                <span class="k">write</span><span class="p">(</span><span class="n">error_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">)</span> <span class="s1">&#39;With iomsg = &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
<a name="ln-545"></a>            <span class="k">end if</span>
<a name="ln-546"></a><span class="k">        end do</span>
<a name="ln-547"></a>
<a name="ln-548"></a><span class="k">    end subroutine </span><span class="n">final_logger</span>
<a name="ln-549"></a>
<a name="ln-550"></a>
<a name="ln-551"></a>    <span class="k">subroutine </span><span class="n">format_output_string</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">col_indent</span><span class="p">,</span> <span class="n">len_buffer</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-552"></a><span class="c">!! version: experimental</span>
<a name="ln-553"></a>
<a name="ln-554"></a><span class="c">!! Writes the STRING to UNIT ensuring that the number of characters</span>
<a name="ln-555"></a><span class="c">!! does not exceed MAX_WIDTH and that the lines after the first</span>
<a name="ln-556"></a><span class="c">!! one are indented four characters.</span>
<a name="ln-557"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">self</span>
<a name="ln-558"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">string</span>
<a name="ln-559"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">col_indent</span>
<a name="ln-560"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">len_buffer</span>
<a name="ln-561"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-562"></a>
<a name="ln-563"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="nb">count</span><span class="p">,</span> <span class="n">indent_len</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">remain</span>
<a name="ln-564"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">new_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<a name="ln-565"></a>
<a name="ln-566"></a>        <span class="n">length</span> <span class="o">=</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<a name="ln-567"></a>        <span class="k">allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">length</span><span class="p">)</span> <span class="kd">::</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-568"></a>        <span class="n">len_buffer</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-569"></a>        <span class="n">indent_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">col_indent</span><span class="p">)</span>
<a name="ln-570"></a>        <span class="k">call </span><span class="n">format_first_line</span><span class="p">()</span>
<a name="ln-571"></a>
<a name="ln-572"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">indent_lines</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-573"></a><span class="k">            do while</span><span class="p">(</span> <span class="n">remain</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
<a name="ln-574"></a>                <span class="k">call </span><span class="n">indent_format_subsequent_line</span><span class="p">()</span>
<a name="ln-575"></a>            <span class="k">end do</span>
<a name="ln-576"></a><span class="k">        else</span>
<a name="ln-577"></a><span class="k">            do while</span><span class="p">(</span> <span class="n">remain</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
<a name="ln-578"></a>                <span class="k">call </span><span class="n">format_subsequent_line</span><span class="p">()</span>
<a name="ln-579"></a>            <span class="k">end do</span>
<a name="ln-580"></a><span class="k">        end if</span>
<a name="ln-581"></a>
<a name="ln-582"></a><span class="k">    contains</span>
<a name="ln-583"></a>
<a name="ln-584"></a><span class="k">        subroutine </span><span class="n">format_first_line</span><span class="p">()</span>
<a name="ln-585"></a>
<a name="ln-586"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span>                     <span class="p">&amp;</span>
<a name="ln-587"></a>                <span class="p">(</span> <span class="n">length</span> <span class="o">&lt;=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span>              <span class="p">&amp;</span>
<a name="ln-588"></a>                <span class="nb">index</span><span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">),</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-589"></a><span class="k">                </span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">)</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">)</span>
<a name="ln-590"></a>                <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">length</span>
<a name="ln-591"></a>                <span class="n">remain</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-592"></a>                <span class="k">return</span>
<a name="ln-593"></a><span class="k">            else</span>
<a name="ln-594"></a>
<a name="ln-595"></a><span class="k">                </span><span class="n">index_</span> <span class="o">=</span> <span class="nb">index</span><span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">)),</span> <span class="p">&amp;</span>
<a name="ln-596"></a>                                <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-597"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">index_</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-598"></a><span class="k">                    do </span><span class="n">index_</span><span class="o">=</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-599"></a>                        <span class="k">if</span> <span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="n">index_</span><span class="p">:</span><span class="n">index_</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="p">)</span> <span class="k">exit</span>
<a name="ln-600"></a><span class="k">                    end do</span>
<a name="ln-601"></a><span class="k">                end if</span>
<a name="ln-602"></a>
<a name="ln-603"></a><span class="k">                if</span> <span class="p">(</span> <span class="n">index_</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-604"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                        <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">)</span>
<a name="ln-606"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span>
<a name="ln-607"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span>
<a name="ln-608"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-609"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-610"></a><span class="k">                else</span>
<a name="ln-611"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">index_</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">index_</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-612"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">index_</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-613"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="n">index_</span>
<a name="ln-614"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-615"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-616"></a><span class="k">                end if</span>
<a name="ln-617"></a>
<a name="ln-618"></a><span class="k">            end if</span>
<a name="ln-619"></a>
<a name="ln-620"></a><span class="k">        end subroutine </span><span class="n">format_first_line</span>
<a name="ln-621"></a>
<a name="ln-622"></a>        <span class="k">subroutine </span><span class="n">format_subsequent_line</span><span class="p">()</span>
<a name="ln-623"></a>            <span class="kt">integer</span> <span class="kd">::</span> <span class="n">new_len_buffer</span>
<a name="ln-624"></a>            <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-625"></a>
<a name="ln-626"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">remain</span> <span class="o">&lt;=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-627"></a><span class="k">                </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">new_len</span>
<a name="ln-628"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-629"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-630"></a>                    <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-631"></a>                    <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-632"></a>                <span class="k">end if</span>
<a name="ln-633"></a><span class="k">                </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-634"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">)</span>
<a name="ln-635"></a>                <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-636"></a>                <span class="nb">count</span> <span class="o">=</span> <span class="n">length</span>
<a name="ln-637"></a>                <span class="n">remain</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-638"></a>                <span class="k">return</span>
<a name="ln-639"></a><span class="k">            else</span>
<a name="ln-640"></a>
<a name="ln-641"></a><span class="k">                </span><span class="n">index_</span> <span class="o">=</span> <span class="nb">count</span> <span class="o">+</span> <span class="nb">index</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">),&amp;</span>
<a name="ln-642"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<a name="ln-643"></a>                <span class="k">if</span><span class="p">(</span><span class="n">index_</span> <span class="o">==</span> <span class="nb">count</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-644"></a><span class="k">                    do </span><span class="n">index_</span><span class="o">=</span><span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">,</span> <span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-645"></a>                        <span class="k">if</span> <span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="n">index_</span><span class="p">:</span><span class="n">index_</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="p">)</span> <span class="k">exit</span>
<a name="ln-646"></a><span class="k">                    end do</span>
<a name="ln-647"></a><span class="k">                end if</span>
<a name="ln-648"></a>
<a name="ln-649"></a><span class="k">                if</span> <span class="p">(</span> <span class="n">index_</span> <span class="o">==</span> <span class="nb">count</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-650"></a><span class="k">                    </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-651"></a>                        <span class="n">new_len</span>
<a name="ln-652"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-653"></a><span class="k">                        allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-654"></a>                        <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-655"></a>                        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-656"></a>                    <span class="k">end if</span>
<a name="ln-657"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-658"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="p">)</span>
<a name="ln-659"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-660"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span>
<a name="ln-661"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-662"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-663"></a><span class="k">                else</span>
<a name="ln-664"></a><span class="k">                    </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">index_</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">&amp;</span>
<a name="ln-665"></a>                        <span class="o">-</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">new_len</span>
<a name="ln-666"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-667"></a><span class="k">                        allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-668"></a>                        <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-669"></a>                        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-670"></a>                    <span class="k">end if</span>
<a name="ln-671"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-672"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">index_</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-673"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-674"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="n">index_</span>
<a name="ln-675"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-676"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-677"></a><span class="k">                end if</span>
<a name="ln-678"></a>
<a name="ln-679"></a><span class="k">            end if</span>
<a name="ln-680"></a>
<a name="ln-681"></a><span class="k">        end subroutine </span><span class="n">format_subsequent_line</span>
<a name="ln-682"></a>
<a name="ln-683"></a>        <span class="k">subroutine </span><span class="n">indent_format_subsequent_line</span><span class="p">()</span>
<a name="ln-684"></a>            <span class="kt">integer</span> <span class="kd">::</span> <span class="n">new_len_buffer</span>
<a name="ln-685"></a>            <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-686"></a>
<a name="ln-687"></a>            <span class="k">if</span> <span class="p">(</span> <span class="nb">index</span><span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">),</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">&amp;</span>
<a name="ln-688"></a>                <span class="n">remain</span> <span class="o">&lt;=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">indent_len</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-689"></a><span class="k">                </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">length</span> <span class="p">&amp;</span>
<a name="ln-690"></a>                    <span class="o">-</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">new_len</span> <span class="o">+</span> <span class="n">indent_len</span>
<a name="ln-691"></a>                <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-692"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-693"></a>                    <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-694"></a>                    <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-695"></a>                <span class="k">end if</span>
<a name="ln-696"></a><span class="k">                </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-697"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">col_indent</span> <span class="o">//</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">)</span>
<a name="ln-698"></a>                <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-699"></a>                <span class="nb">count</span> <span class="o">=</span> <span class="n">length</span>
<a name="ln-700"></a>                <span class="n">remain</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-701"></a>                <span class="k">return</span>
<a name="ln-702"></a><span class="k">            else</span>
<a name="ln-703"></a>
<a name="ln-704"></a><span class="k">                </span><span class="n">index_</span> <span class="o">=</span> <span class="nb">count</span> <span class="o">+</span> <span class="nb">index</span><span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>                   <span class="p">&amp;</span>
<a name="ln-705"></a>                    <span class="nb">min</span> <span class="p">(</span> <span class="n">length</span><span class="p">,</span> <span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">indent_len</span><span class="p">)</span> <span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-706"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">))</span>
<a name="ln-707"></a>                <span class="k">if</span><span class="p">(</span><span class="n">index_</span> <span class="o">==</span> <span class="nb">count</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-708"></a><span class="k">                    do </span><span class="n">index_</span><span class="o">=</span><span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="o">-</span><span class="n">indent_len</span><span class="p">,</span> <span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-709"></a>                        <span class="k">if</span> <span class="p">(</span> <span class="n">string</span><span class="p">(</span><span class="n">index_</span><span class="p">:</span><span class="n">index_</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span> <span class="p">)</span> <span class="k">exit</span>
<a name="ln-710"></a><span class="k">                    end do</span>
<a name="ln-711"></a><span class="k">                end if</span>
<a name="ln-712"></a>
<a name="ln-713"></a><span class="k">                if</span> <span class="p">(</span> <span class="n">index_</span> <span class="o">==</span> <span class="nb">count</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-714"></a><span class="k">                    </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="p">&amp;</span>
<a name="ln-715"></a>                        <span class="o">+</span> <span class="n">new_len</span> 
<a name="ln-716"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-717"></a><span class="k">                        allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-718"></a>                        <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-719"></a>                        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-720"></a>                    <span class="k">end if</span>
<a name="ln-721"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-722"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">col_indent</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-723"></a>                        <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="nb">count</span><span class="o">+</span><span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span><span class="o">-</span><span class="n">indent_len</span><span class="p">)</span>
<a name="ln-724"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-725"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="nb">count</span> <span class="o">+</span> <span class="n">self</span> <span class="p">%</span> <span class="n">max_width</span> <span class="o">-</span> <span class="n">indent_len</span>
<a name="ln-726"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-727"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-728"></a><span class="k">                else</span>
<a name="ln-729"></a><span class="k">                    </span><span class="n">new_len_buffer</span> <span class="o">=</span> <span class="n">len_buffer</span> <span class="o">+</span> <span class="n">index_</span> <span class="o">-</span> <span class="nb">count</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">&amp;</span>
<a name="ln-730"></a>                        <span class="o">+</span> <span class="n">new_len</span> <span class="o">+</span> <span class="n">indent_len</span>
<a name="ln-731"></a>                    <span class="k">if</span> <span class="p">(</span> <span class="n">new_len_buffer</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-732"></a><span class="k">                        allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span> <span class="n">buffer</span> <span class="p">)</span> <span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span> <span class="p">)</span>
<a name="ln-733"></a>                        <span class="n">dummy</span> <span class="o">=</span> <span class="n">buffer</span>
<a name="ln-734"></a>                        <span class="k">call </span><span class="nb">move_alloc</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">buffer</span> <span class="p">)</span>
<a name="ln-735"></a>                    <span class="k">end if</span>
<a name="ln-736"></a><span class="k">                    </span><span class="n">buffer</span><span class="p">(</span> <span class="n">len_buffer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span> <span class="n">new_len_buffer</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
<a name="ln-737"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">col_indent</span> <span class="o">//</span> <span class="n">string</span><span class="p">(</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">index_</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-738"></a>                    <span class="n">len_buffer</span> <span class="o">=</span> <span class="n">new_len_buffer</span>
<a name="ln-739"></a>                    <span class="nb">count</span> <span class="o">=</span> <span class="n">index_</span>
<a name="ln-740"></a>                    <span class="n">remain</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">count</span>
<a name="ln-741"></a><span class="nb">                    </span><span class="k">return</span>
<a name="ln-742"></a><span class="k">                end if</span>
<a name="ln-743"></a>
<a name="ln-744"></a><span class="k">            end if</span>
<a name="ln-745"></a>
<a name="ln-746"></a><span class="k">        end subroutine </span><span class="n">indent_format_subsequent_line</span>
<a name="ln-747"></a>
<a name="ln-748"></a>    <span class="k">end subroutine </span><span class="n">format_output_string</span>
<a name="ln-749"></a>
<a name="ln-750"></a>
<a name="ln-751"></a>    <span class="k">subroutine </span><span class="n">handle_write_failure</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">procedure_name</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-752"></a><span class="c">!! version: experimental</span>
<a name="ln-753"></a>
<a name="ln-754"></a><span class="c">!! Handles a failure to write to `unit` in `procedure_name` with `iostat` and</span>
<a name="ln-755"></a><span class="c">!! `iomsg` by writing a description of the failure to `output_unit` and</span>
<a name="ln-756"></a><span class="c">!! stopping.</span>
<a name="ln-757"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-758"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">procedure_name</span>
<a name="ln-759"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-760"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-761"></a>
<a name="ln-762"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">name</span>
<a name="ln-763"></a>        <span class="kt">logical</span> <span class="kd">::</span> <span class="n">named</span>
<a name="ln-764"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="n">action</span>
<a name="ln-765"></a>
<a name="ln-766"></a>         <span class="k">write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span> <span class="p">)</span> <span class="s1">&#39;write failure in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-767"></a>             <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">procedure_name</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;.&#39;</span>
<a name="ln-768"></a>         <span class="k">if</span> <span class="p">(</span> <span class="n">unit</span> <span class="o">==</span> <span class="o">-</span><span class="mi">999</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-769"></a><span class="k">             write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span> <span class="p">)</span> <span class="s1">&#39;unit = internal file&#39;</span>
<a name="ln-770"></a>         <span class="k">else</span>
<a name="ln-771"></a><span class="k">             write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span> <span class="p">)</span> <span class="s1">&#39;unit = &#39;</span><span class="p">,</span> <span class="n">unit</span>
<a name="ln-772"></a>             <span class="k">inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">named</span><span class="o">=</span><span class="n">named</span> <span class="p">)</span>
<a name="ln-773"></a>
<a name="ln-774"></a>             <span class="k">if</span> <span class="p">(</span> <span class="n">named</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-775"></a><span class="k">                 inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span> <span class="p">)</span>
<a name="ln-776"></a>                 <span class="k">write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, a)&#39;</span> <span class="p">)</span> <span class="s1">&#39;name = &#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a name="ln-777"></a>             <span class="k">else</span>
<a name="ln-778"></a><span class="k">                 write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span> <span class="p">)</span> <span class="s1">&#39;unit is unnamed&#39;</span>
<a name="ln-779"></a>             <span class="k">end if</span>
<a name="ln-780"></a><span class="k">             inquire</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span> <span class="p">)</span>
<a name="ln-781"></a>             <span class="k">write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, a)&#39;</span> <span class="p">)</span> <span class="s1">&#39;action = &#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<a name="ln-782"></a>         <span class="k">end if</span>
<a name="ln-783"></a>
<a name="ln-784"></a><span class="k">         write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span> <span class="p">)</span> <span class="s1">&#39;iostat = &#39;</span><span class="p">,</span> <span class="n">iostat</span>
<a name="ln-785"></a>         <span class="k">write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a, a )&#39;</span> <span class="p">)</span> <span class="s1">&#39;iomsg = &#39;</span><span class="p">,</span> <span class="nb">trim</span><span class="p">(</span><span class="n">iomsg</span><span class="p">)</span>
<a name="ln-786"></a>         <span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;write failure in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39;.&#39;</span>
<a name="ln-787"></a>
<a name="ln-788"></a>     <span class="k">end subroutine </span><span class="n">handle_write_failure</span>
<a name="ln-789"></a>
<a name="ln-790"></a>
<a name="ln-791"></a>    <span class="k">subroutine </span><span class="n">log_debug</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span> <span class="p">)</span>
<a name="ln-792"></a><span class="c">!! version: experimental</span>
<a name="ln-793"></a>
<a name="ln-794"></a><span class="c">!! Writes the string `message` to `self % log_units` with optional additional</span>
<a name="ln-795"></a><span class="c">!! text.</span>
<a name="ln-796"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_debug-writes-the-string-message-to-self-log_units))</span>
<a name="ln-797"></a><span class="c">!!</span>
<a name="ln-798"></a><span class="c">!!##### Behavior</span>
<a name="ln-799"></a><span class="c">!!</span>
<a name="ln-800"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by</span>
<a name="ln-801"></a><span class="c">!! `module` and `procedure` if present, and then `message` is</span>
<a name="ln-802"></a><span class="c">!! written with the prefix &#39;DEBUG: &#39;.</span>
<a name="ln-803"></a><span class="c">!!</span>
<a name="ln-804"></a><span class="c">!!##### Example</span>
<a name="ln-805"></a><span class="c">!!</span>
<a name="ln-806"></a><span class="c">!!     module  example_mod</span>
<a name="ln-807"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-808"></a><span class="c">!!       ...</span>
<a name="ln-809"></a><span class="c">!!       real, allocatable :: a(:)</span>
<a name="ln-810"></a><span class="c">!!       ...</span>
<a name="ln-811"></a><span class="c">!!       type(logger_type) :: alogger</span>
<a name="ln-812"></a><span class="c">!!       ...</span>
<a name="ln-813"></a><span class="c">!!     contains</span>
<a name="ln-814"></a><span class="c">!!       ...</span>
<a name="ln-815"></a><span class="c">!!       subroutine example_sub( selection )</span>
<a name="ln-816"></a><span class="c">!!         integer, intent(out) :: selection</span>
<a name="ln-817"></a><span class="c">!!         integer        :: stat</span>
<a name="ln-818"></a><span class="c">!!         write(*,&#39;(a)&#39;) &quot;Enter an integer to select a widget&quot;</span>
<a name="ln-819"></a><span class="c">!!         read(*,&#39;(i0)&#39;) selection</span>
<a name="ln-820"></a><span class="c">!!         write( message, `(a, i0)&#39; )           &amp;</span>
<a name="ln-821"></a><span class="c">!!               &quot;The user selected &quot;, selection</span>
<a name="ln-822"></a><span class="c">!!         call alogger % log_debug( message,                   &amp;</span>
<a name="ln-823"></a><span class="c">!!                                   module = &#39;EXAMPLE_MOD&#39;,    &amp;</span>
<a name="ln-824"></a><span class="c">!!                                   procedure = &#39;EXAMPLE_SUB&#39; )</span>
<a name="ln-825"></a><span class="c">!!         ...</span>
<a name="ln-826"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-827"></a><span class="c">!!       ...</span>
<a name="ln-828"></a><span class="c">!!     end module example_mod</span>
<a name="ln-829"></a><span class="c">!!</span>
<a name="ln-830"></a>
<a name="ln-831"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-832"></a><span class="c">!! The logger used to send the message</span>
<a name="ln-833"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-834"></a><span class="c">!! A string to be written to log_unit</span>
<a name="ln-835"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-836"></a><span class="c">!! The name of the module containing the current invocation of `log_information`</span>
<a name="ln-837"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-838"></a><span class="c">!! The name of the procedure containing the current invocation of</span>
<a name="ln-839"></a><span class="c">!! `log_information`</span>
<a name="ln-840"></a>
<a name="ln-841"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">debug_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-842"></a>
<a name="ln-843"></a><span class="k">        call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_message</span><span class="p">(</span> <span class="n">message</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-844"></a>                                 <span class="k">module</span> <span class="o">=</span> <span class="k">module</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-845"></a>                                 <span class="k">procedure</span> <span class="o">=</span> <span class="k">procedure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-846"></a>                                 <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;DEBUG&#39;</span> <span class="p">)</span>
<a name="ln-847"></a>
<a name="ln-848"></a>    <span class="k">end subroutine </span><span class="n">log_debug</span>
<a name="ln-849"></a>
<a name="ln-850"></a>
<a name="ln-851"></a>    <span class="k">subroutine </span><span class="n">log_error</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span><span class="p">,</span> <span class="nb">stat</span><span class="p">,</span> <span class="n">errmsg</span> <span class="p">)</span>
<a name="ln-852"></a><span class="c">!! version: experimental</span>
<a name="ln-853"></a>
<a name="ln-854"></a><span class="c">!! Writes the string `message` to `self % log_units` with optional additional</span>
<a name="ln-855"></a><span class="c">!! text.</span>
<a name="ln-856"></a><span class="c">!! ([Specification](../specs/stdlib_logger.html#log_error-writes-the-string-message-to-self-log_units))</span>
<a name="ln-857"></a>
<a name="ln-858"></a><span class="c">!!##### Behavior</span>
<a name="ln-859"></a><span class="c">!!</span>
<a name="ln-860"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by</span>
<a name="ln-861"></a><span class="c">!! `module` and `procedure` if present, then `message` is</span>
<a name="ln-862"></a><span class="c">!! written with the prefix &#39;ERROR: &#39;, and then if `stat` or `errmsg`</span>
<a name="ln-863"></a><span class="c">!! are present they are written.</span>
<a name="ln-864"></a><span class="c">!!</span>
<a name="ln-865"></a><span class="c">!!##### Example</span>
<a name="ln-866"></a><span class="c">!!</span>
<a name="ln-867"></a><span class="c">!!     module  example_mod</span>
<a name="ln-868"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-869"></a><span class="c">!!       ...</span>
<a name="ln-870"></a><span class="c">!!       real, allocatable :: a(:)</span>
<a name="ln-871"></a><span class="c">!!       ...</span>
<a name="ln-872"></a><span class="c">!!       type(logger_type) :: alogger</span>
<a name="ln-873"></a><span class="c">!!       ...</span>
<a name="ln-874"></a><span class="c">!!     contains</span>
<a name="ln-875"></a><span class="c">!!       ...</span>
<a name="ln-876"></a><span class="c">!!       subroutine example_sub( size )</span>
<a name="ln-877"></a><span class="c">!!         integer, intent(in) :: size</span>
<a name="ln-878"></a><span class="c">!!         character(128) :: errmsg, message</span>
<a name="ln-879"></a><span class="c">!!         integer        :: stat</span>
<a name="ln-880"></a><span class="c">!!         allocate( a(size), stat=stat, errmsg=errmsg )</span>
<a name="ln-881"></a><span class="c">!!         if ( stat /= 0 ) then</span>
<a name="ln-882"></a><span class="c">!!           write( message, `(a, i0)&#39; )                    &amp;</span>
<a name="ln-883"></a><span class="c">!!               &quot;Allocation of A failed with SIZE = &quot;, size</span>
<a name="ln-884"></a><span class="c">!!           alogger % call log_error( message,                   &amp;</span>
<a name="ln-885"></a><span class="c">!!                                     module = &#39;EXAMPLE_MOD&#39;,    &amp;</span>
<a name="ln-886"></a><span class="c">!!                                     procedure = &#39;EXAMPLE_SUB&#39;, &amp;</span>
<a name="ln-887"></a><span class="c">!!                                     stat = stat,               &amp;</span>
<a name="ln-888"></a><span class="c">!!                                     errmsg = errmsg )</span>
<a name="ln-889"></a><span class="c">!!         end if</span>
<a name="ln-890"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-891"></a><span class="c">!!       ...</span>
<a name="ln-892"></a><span class="c">!!     end module example_mod</span>
<a name="ln-893"></a><span class="c">!!</span>
<a name="ln-894"></a>
<a name="ln-895"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-896"></a><span class="c">!! The logger to be used in logging the message</span>
<a name="ln-897"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-898"></a><span class="c">!! A string to be written to log_unit</span>
<a name="ln-899"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-900"></a><span class="c">!! The name of the module containing the current invocation of `log_error`</span>
<a name="ln-901"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-902"></a><span class="c">!! The name of the procedure containing the current invocation of `log_error`</span>
<a name="ln-903"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>           <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-904"></a><span class="c">!! The value of the `stat` specifier returned by a Fortran statement</span>
<a name="ln-905"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">errmsg</span>
<a name="ln-906"></a><span class="c">!! The value of the `errmsg` specifier returned by a Fortran statement</span>
<a name="ln-907"></a>
<a name="ln-908"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-909"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-910"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-911"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;log_error&#39;</span>
<a name="ln-912"></a>        <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">suffix</span>
<a name="ln-913"></a>
<a name="ln-914"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">error_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-915"></a>
<a name="ln-916"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-917"></a><span class="k">            write</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-918"></a>                <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;With stat = &quot;</span><span class="p">,</span> <span class="nb">stat</span>
<a name="ln-919"></a><span class="nb">        </span><span class="k">else</span>
<a name="ln-920"></a><span class="k">            </span><span class="n">dummy</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-921"></a>        <span class="k">end if</span>
<a name="ln-922"></a>
<a name="ln-923"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-924"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-925"></a><span class="k">                </span><span class="n">suffix</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-926"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;With errmsg = &quot;&#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-927"></a>            <span class="k">else</span>
<a name="ln-928"></a><span class="k">                </span><span class="n">suffix</span> <span class="o">=</span> <span class="n">dummy</span>
<a name="ln-929"></a>            <span class="k">end if</span>
<a name="ln-930"></a><span class="k">        else</span>
<a name="ln-931"></a><span class="k">            </span><span class="n">suffix</span> <span class="o">=</span> <span class="n">dummy</span>
<a name="ln-932"></a>        <span class="k">end if</span>
<a name="ln-933"></a>
<a name="ln-934"></a><span class="k">        call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_message</span><span class="p">(</span> <span class="nb">trim</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">//</span> <span class="n">suffix</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-935"></a>                                 <span class="k">module</span> <span class="o">=</span> <span class="k">module</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-936"></a>                                 <span class="k">procedure</span> <span class="o">=</span> <span class="k">procedure</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-937"></a>                                 <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;ERROR&#39;</span><span class="p">)</span>
<a name="ln-938"></a>
<a name="ln-939"></a>        <span class="k">return</span>
<a name="ln-940"></a>
<a name="ln-941"></a><span class="mi">999</span>     <span class="k">call </span><span class="n">handle_write_failure</span><span class="p">(</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">procedure_name</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-942"></a>
<a name="ln-943"></a>    <span class="k">end subroutine </span><span class="n">log_error</span>
<a name="ln-944"></a>
<a name="ln-945"></a>
<a name="ln-946"></a>    <span class="k">subroutine </span><span class="n">log_information</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span> <span class="p">)</span>
<a name="ln-947"></a><span class="c">!! version: experimental</span>
<a name="ln-948"></a>
<a name="ln-949"></a><span class="c">!! Writes the string `message` to `self % log_units` with optional additional</span>
<a name="ln-950"></a><span class="c">!! text.</span>
<a name="ln-951"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_information-writes-the-string-message-to-self-log_units))</span>
<a name="ln-952"></a><span class="c">!!</span>
<a name="ln-953"></a><span class="c">!!##### Behavior</span>
<a name="ln-954"></a><span class="c">!!</span>
<a name="ln-955"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by</span>
<a name="ln-956"></a><span class="c">!! `module` and `procedure` if present, and then `message` is</span>
<a name="ln-957"></a><span class="c">!! written with the prefix &#39;INFO: &#39;.</span>
<a name="ln-958"></a><span class="c">!!</span>
<a name="ln-959"></a><span class="c">!!##### Example</span>
<a name="ln-960"></a><span class="c">!!</span>
<a name="ln-961"></a><span class="c">!!     module  example_mod</span>
<a name="ln-962"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-963"></a><span class="c">!!       ...</span>
<a name="ln-964"></a><span class="c">!!       real, allocatable :: a(:)</span>
<a name="ln-965"></a><span class="c">!!       ...</span>
<a name="ln-966"></a><span class="c">!!       type(logger_type) :: alogger</span>
<a name="ln-967"></a><span class="c">!!       ...</span>
<a name="ln-968"></a><span class="c">!!     contains</span>
<a name="ln-969"></a><span class="c">!!       ...</span>
<a name="ln-970"></a><span class="c">!!       subroutine example_sub( selection )</span>
<a name="ln-971"></a><span class="c">!!         integer, intent(out) :: selection</span>
<a name="ln-972"></a><span class="c">!!         integer        :: stat</span>
<a name="ln-973"></a><span class="c">!!         write(*,&#39;(a)&#39;) &quot;Enter an integer to select a widget&quot;</span>
<a name="ln-974"></a><span class="c">!!         read(*,&#39;(i0)&#39;) selection</span>
<a name="ln-975"></a><span class="c">!!         write( message, `(a, i0)&#39; )           &amp;</span>
<a name="ln-976"></a><span class="c">!!               &quot;The user selected &quot;, selection</span>
<a name="ln-977"></a><span class="c">!!         call alogger % log_information( message,                   &amp;</span>
<a name="ln-978"></a><span class="c">!!                                         module = &#39;EXAMPLE_MOD&#39;,    &amp;</span>
<a name="ln-979"></a><span class="c">!!                                         procedure = &#39;EXAMPLE_SUB&#39; )</span>
<a name="ln-980"></a><span class="c">!!         ...</span>
<a name="ln-981"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-982"></a><span class="c">!!       ...</span>
<a name="ln-983"></a><span class="c">!!     end module example_mod</span>
<a name="ln-984"></a><span class="c">!!</span>
<a name="ln-985"></a>
<a name="ln-986"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-987"></a><span class="c">!! The logger used to send the message</span>
<a name="ln-988"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-989"></a><span class="c">!! A string to be written to log_unit</span>
<a name="ln-990"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-991"></a><span class="c">!! The name of the module containing the current invocation of `log_information`</span>
<a name="ln-992"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-993"></a><span class="c">!! The name of the procedure containing the current invocation of</span>
<a name="ln-994"></a><span class="c">!! `log_information`</span>
<a name="ln-995"></a>
<a name="ln-996"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">information_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-997"></a>
<a name="ln-998"></a><span class="k">        call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_message</span><span class="p">(</span> <span class="n">message</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-999"></a>                                 <span class="k">module</span> <span class="o">=</span> <span class="k">module</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1000"></a>                                 <span class="k">procedure</span> <span class="o">=</span> <span class="k">procedure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1001"></a>                                 <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;INFO&#39;</span> <span class="p">)</span>
<a name="ln-1002"></a>
<a name="ln-1003"></a>    <span class="k">end subroutine </span><span class="n">log_information</span>
<a name="ln-1004"></a>
<a name="ln-1005"></a>
<a name="ln-1006"></a>    <span class="k">subroutine </span><span class="n">log_io_error</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1007"></a>                             <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-1008"></a><span class="c">!! version: experimental</span>
<a name="ln-1009"></a>
<a name="ln-1010"></a><span class="c">!! Writes the string `message` to the `self % log_units` with optional</span>
<a name="ln-1011"></a><span class="c">!! additional text.</span>
<a name="ln-1012"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_io_error-write-the-string-message-to-self-log_units))</span>
<a name="ln-1013"></a><span class="c">!!</span>
<a name="ln-1014"></a><span class="c">!!##### Behavior</span>
<a name="ln-1015"></a><span class="c">!!</span>
<a name="ln-1016"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by</span>
<a name="ln-1017"></a><span class="c">!! `module` and `procedure` if present, then `message` is</span>
<a name="ln-1018"></a><span class="c">!! written with a prefix &#39;I/O ERROR: &#39;, and then if `iostat` or `iomsg`</span>
<a name="ln-1019"></a><span class="c">!! are present they are also written.</span>
<a name="ln-1020"></a><span class="c">!!</span>
<a name="ln-1021"></a><span class="c">!!##### Example</span>
<a name="ln-1022"></a><span class="c">!!</span>
<a name="ln-1023"></a><span class="c">!!    program example</span>
<a name="ln-1024"></a><span class="c">!!      use stdlib_logger</span>
<a name="ln-1025"></a><span class="c">!!      ...</span>
<a name="ln-1026"></a><span class="c">!!      character(*), parameter :: filename = &#39;dummy.txt&#39;</span>
<a name="ln-1027"></a><span class="c">!!      integer                 :: iostat, lun</span>
<a name="ln-1028"></a><span class="c">!!      character(128)          :: iomsg</span>
<a name="ln-1029"></a><span class="c">!!      character(*), parameter :: message = &#39;Failure in opening &quot;dummy.txt&quot;.&#39;</span>
<a name="ln-1030"></a><span class="c">!!</span>
<a name="ln-1031"></a><span class="c">!!      open( newunit=lun, file = filename, form=&#39;formatted&#39;, &amp;</span>
<a name="ln-1032"></a><span class="c">!!            status=&#39;old&#39;, iostat=iostat, iomsg=iomsg )</span>
<a name="ln-1033"></a><span class="c">!!      if ( iostat /= 0 ) then</span>
<a name="ln-1034"></a><span class="c">!!        call global_logger % log_io_error( message, procedure = &#39;EXAMPLE&#39;, &amp;</span>
<a name="ln-1035"></a><span class="c">!!            iostat=iostat, iomsg = iomsg )</span>
<a name="ln-1036"></a><span class="c">!!        error stop &#39;Error on opening &#39; // filename</span>
<a name="ln-1037"></a><span class="c">!!      end if</span>
<a name="ln-1038"></a><span class="c">!!      ...</span>
<a name="ln-1039"></a><span class="c">!!    end program example</span>
<a name="ln-1040"></a>
<a name="ln-1041"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1042"></a><span class="c">!! The logger variable to receivee the message</span>
<a name="ln-1043"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-1044"></a><span class="c">!! A string to be written to LOG_UNIT</span>
<a name="ln-1045"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-1046"></a><span class="c">!! The name of the module containing the current invocation of REPORT_ERROR</span>
<a name="ln-1047"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-1048"></a><span class="c">!! The name of the procedure containing the current invocation of REPORT_ERROR</span>
<a name="ln-1049"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>           <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-1050"></a><span class="c">!! The value of the IOSTAT specifier returned by a Fortran I/O statement</span>
<a name="ln-1051"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-1052"></a><span class="c">!! The value of the IOMSG specifier returned by a Fortran I/O statement</span>
<a name="ln-1053"></a>
<a name="ln-1054"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span>
<a name="ln-1055"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg2</span>
<a name="ln-1056"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iostat2</span>
<a name="ln-1057"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;log_io_error&#39;</span>
<a name="ln-1058"></a>        <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">suffix</span>
<a name="ln-1059"></a>
<a name="ln-1060"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">io_error_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1061"></a>
<a name="ln-1062"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">iostat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1063"></a><span class="k">            write</span><span class="p">(</span> <span class="n">dummy</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat2</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg2</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1064"></a>                <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s2">&quot;With iostat = &quot;</span><span class="p">,</span> <span class="n">iostat</span>
<a name="ln-1065"></a>        <span class="k">else</span>
<a name="ln-1066"></a><span class="k">            </span><span class="n">dummy</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1067"></a>        <span class="k">end if</span>
<a name="ln-1068"></a>
<a name="ln-1069"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">iomsg</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1070"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">len_trim</span><span class="p">(</span><span class="n">iomsg</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1071"></a><span class="k">                </span><span class="n">suffix</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1072"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;With iomsg = &quot;&#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">iomsg</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;&quot;&#39;</span>
<a name="ln-1073"></a>            <span class="k">else</span>
<a name="ln-1074"></a><span class="k">                </span><span class="n">suffix</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<a name="ln-1075"></a>            <span class="k">end if</span>
<a name="ln-1076"></a><span class="k">        else</span>
<a name="ln-1077"></a><span class="k">            </span><span class="n">suffix</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">dummy</span><span class="p">)</span>
<a name="ln-1078"></a>        <span class="k">end if</span>
<a name="ln-1079"></a>
<a name="ln-1080"></a><span class="k">        call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_message</span><span class="p">(</span> <span class="nb">trim</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">//</span> <span class="n">suffix</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1081"></a>                                 <span class="k">module</span> <span class="o">=</span> <span class="k">module</span><span class="p">,</span>         <span class="p">&amp;</span>
<a name="ln-1082"></a>                                 <span class="k">procedure</span> <span class="o">=</span> <span class="k">procedure</span><span class="p">,</span>   <span class="p">&amp;</span>
<a name="ln-1083"></a>                                 <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;I/O ERROR&#39;</span> <span class="p">)</span>
<a name="ln-1084"></a>
<a name="ln-1085"></a>        <span class="k">return</span>
<a name="ln-1086"></a>
<a name="ln-1087"></a><span class="mi">999</span>     <span class="k">call </span><span class="n">handle_write_failure</span><span class="p">(</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">procedure_name</span><span class="p">,</span> <span class="n">iostat2</span><span class="p">,</span> <span class="n">iomsg2</span> <span class="p">)</span>
<a name="ln-1088"></a>
<a name="ln-1089"></a>    <span class="k">end subroutine </span><span class="n">log_io_error</span>
<a name="ln-1090"></a>
<a name="ln-1091"></a>    <span class="k">subroutine </span><span class="n">log_message</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span><span class="p">,</span> <span class="n">prefix</span> <span class="p">)</span>
<a name="ln-1092"></a><span class="c">!! version: experimental</span>
<a name="ln-1093"></a>
<a name="ln-1094"></a><span class="c">!! Writes the string `message` to the `self % log_units` with optional</span>
<a name="ln-1095"></a><span class="c">!! additional text.</span>
<a name="ln-1096"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_message-write-the-string-message-to-self-log_units))</span>
<a name="ln-1097"></a><span class="c">!!</span>
<a name="ln-1098"></a><span class="c">!!##### Behavior</span>
<a name="ln-1099"></a><span class="c">!!</span>
<a name="ln-1100"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by `module`</span>
<a name="ln-1101"></a><span class="c">!! and `procedure` if present, followed by `prefix // &#39;: &#39;` if present,</span>
<a name="ln-1102"></a><span class="c">!! and then `message`.</span>
<a name="ln-1103"></a><span class="c">!!</span>
<a name="ln-1104"></a><span class="c">!!##### Example</span>
<a name="ln-1105"></a><span class="c">!!</span>
<a name="ln-1106"></a><span class="c">!!    module  example_mod</span>
<a name="ln-1107"></a><span class="c">!!      use stdlib_logger</span>
<a name="ln-1108"></a><span class="c">!!      ...</span>
<a name="ln-1109"></a><span class="c">!!      real, allocatable :: a(:)</span>
<a name="ln-1110"></a><span class="c">!!      ...</span>
<a name="ln-1111"></a><span class="c">!!    contains</span>
<a name="ln-1112"></a><span class="c">!!      ...</span>
<a name="ln-1113"></a><span class="c">!!      subroutine example_sub( selection )</span>
<a name="ln-1114"></a><span class="c">!!        integer, intent(out) :: selection</span>
<a name="ln-1115"></a><span class="c">!!        integer        :: stat</span>
<a name="ln-1116"></a><span class="c">!!        write(*,&#39;(a)&#39;) &quot;Enter an integer to select a widget&quot;</span>
<a name="ln-1117"></a><span class="c">!!        read(*,&#39;(i0)&#39;) selection</span>
<a name="ln-1118"></a><span class="c">!!        write( message, `(a, i0)&#39; )          &amp;</span>
<a name="ln-1119"></a><span class="c">!!              &quot;The user selected &quot;, selection</span>
<a name="ln-1120"></a><span class="c">!!        call global_logger % log_message( message,                   &amp;</span>
<a name="ln-1121"></a><span class="c">!!                                          module = &#39;example_mod&#39;,    &amp;</span>
<a name="ln-1122"></a><span class="c">!!                                          procedure = &#39;example_sub&#39;, &amp;</span>
<a name="ln-1123"></a><span class="c">!!                                          prefix = &#39;info&#39; )</span>
<a name="ln-1124"></a><span class="c">!!      end subroutine example_sub</span>
<a name="ln-1125"></a><span class="c">!!      ...</span>
<a name="ln-1126"></a><span class="c">!!    end module example_mod</span>
<a name="ln-1127"></a><span class="c">!!</span>
<a name="ln-1128"></a>
<a name="ln-1129"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1130"></a><span class="c">!! The logger variable to receive the message</span>
<a name="ln-1131"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-1132"></a><span class="c">!! A string to be written to log_unit</span>
<a name="ln-1133"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-1134"></a><span class="c">!! The name of the module containing the current invocation of `log_message`</span>
<a name="ln-1135"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-1136"></a><span class="c">!! The name of the procedure containing the current invocation of `log_message`</span>
<a name="ln-1137"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="n">prefix</span>
<a name="ln-1138"></a><span class="c">!! To be prepended to message as `prefix // &#39;: &#39; // message`.</span>
<a name="ln-1139"></a>
<a name="ln-1140"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-1141"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-1142"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">len_buffer</span>
<a name="ln-1143"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;log_message&#39;</span>
<a name="ln-1144"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span> <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-1145"></a>        <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">d_and_t</span><span class="p">,</span> <span class="n">m_and_p</span><span class="p">,</span> <span class="n">pref</span>
<a name="ln-1146"></a>        <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-1147"></a>
<a name="ln-1148"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1149"></a><span class="k">            </span><span class="n">pref</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span>
<a name="ln-1150"></a>        <span class="k">else</span>
<a name="ln-1151"></a><span class="k">            </span><span class="n">pref</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1152"></a>        <span class="k">end if</span>
<a name="ln-1153"></a>
<a name="ln-1154"></a><span class="k">        if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">time_stamp</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1155"></a><span class="k">            </span><span class="n">d_and_t</span> <span class="o">=</span> <span class="n">time_stamp</span><span class="p">()</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span>
<a name="ln-1156"></a>        <span class="k">else</span>
<a name="ln-1157"></a><span class="k">            </span><span class="n">d_and_t</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1158"></a>        <span class="k">end if</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="k">module</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1161"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="k">procedure</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1162"></a><span class="k">                </span><span class="n">m_and_p</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="k">module</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="k">procedure</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span>
<a name="ln-1163"></a>            <span class="k">else</span>
<a name="ln-1164"></a><span class="k">                </span><span class="n">m_and_p</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="k">module</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span>
<a name="ln-1165"></a>            <span class="k">end if</span>
<a name="ln-1166"></a><span class="k">        else if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="k">procedure</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1167"></a><span class="k">            </span><span class="n">m_and_p</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="k">procedure</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span>
<a name="ln-1168"></a>        <span class="k">else</span>
<a name="ln-1169"></a><span class="k">            </span><span class="n">m_and_p</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-1170"></a>        <span class="k">end if</span>
<a name="ln-1171"></a>
<a name="ln-1172"></a><span class="k">        call </span><span class="n">format_output_string</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span>                         <span class="p">&amp;</span>
<a name="ln-1173"></a>                                   <span class="n">d_and_t</span> <span class="o">//</span> <span class="n">m_and_p</span> <span class="o">//</span> <span class="n">pref</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1174"></a>                                   <span class="nb">trim</span><span class="p">(</span> <span class="n">message</span> <span class="p">),</span>              <span class="p">&amp;</span>
<a name="ln-1175"></a>                                   <span class="s1">&#39;    &#39;</span><span class="p">,</span>                       <span class="p">&amp;</span>
<a name="ln-1176"></a>                                   <span class="n">len_buffer</span><span class="p">,</span>                   <span class="p">&amp;</span>
<a name="ln-1177"></a>                                   <span class="n">buffer</span><span class="p">)</span>
<a name="ln-1178"></a>
<a name="ln-1179"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1180"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">add_blank_line</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1181"></a><span class="k">                write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1182"></a>                        <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1183"></a>                    <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_buffer</span><span class="p">)</span>
<a name="ln-1184"></a>            <span class="k">else</span>
<a name="ln-1185"></a><span class="k">                write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1186"></a>                        <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1187"></a>                    <span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_buffer</span><span class="p">)</span>
<a name="ln-1188"></a>            <span class="k">end if</span>
<a name="ln-1189"></a><span class="k">        else</span>
<a name="ln-1190"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">add_blank_line</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1191"></a><span class="k">                do </span><span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1192"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1193"></a>                        <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span> <span class="p">)</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1194"></a>                        <span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_buffer</span><span class="p">)</span>
<a name="ln-1195"></a>                <span class="k">end do</span>
<a name="ln-1196"></a><span class="k">            else</span>
<a name="ln-1197"></a><span class="k">                do </span><span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1198"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">unit</span><span class="p">),</span> <span class="s1">&#39;(a)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1199"></a>                        <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1200"></a>                        <span class="n">buffer</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">len_buffer</span><span class="p">)</span>
<a name="ln-1201"></a>                <span class="k">end do</span>
<a name="ln-1202"></a><span class="k">            end if</span>
<a name="ln-1203"></a><span class="k">        end if</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a>
<a name="ln-1206"></a><span class="k">        return</span>
<a name="ln-1207"></a>
<a name="ln-1208"></a><span class="mi">999</span>     <span class="k">call </span><span class="n">handle_write_failure</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">procedure_name</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-1209"></a>
<a name="ln-1210"></a>    <span class="k">end subroutine </span><span class="n">log_message</span>
<a name="ln-1211"></a>
<a name="ln-1212"></a>    <span class="k">subroutine </span><span class="n">log_text_error</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span>  <span class="p">&amp;</span>
<a name="ln-1213"></a>                               <span class="n">line_number</span><span class="p">,</span> <span class="n">caret</span><span class="p">,</span> <span class="nb">stat</span> <span class="p">)</span>
<a name="ln-1214"></a><span class="c">!! version: experimental</span>
<a name="ln-1215"></a>
<a name="ln-1216"></a><span class="c">!! Sends a message to `self % log_units` describing an error found</span>
<a name="ln-1217"></a><span class="c">!! in a line of text.</span>
<a name="ln-1218"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_text_error-send-a-message-to-self-log_units-describing-an-error))</span>
<a name="ln-1219"></a>
<a name="ln-1220"></a><span class="c">!!##### Behavior</span>
<a name="ln-1221"></a><span class="c">!!</span>
<a name="ln-1222"></a><span class="c">!! If time stamps are active first a time stamp is written. Then if</span>
<a name="ln-1223"></a><span class="c">!! `filename` or `line_number` or `column` are present they are written.</span>
<a name="ln-1224"></a><span class="c">!! Then `line` is written. Then the symbol `caret` is written below `line`</span>
<a name="ln-1225"></a><span class="c">!! at the column indicated by `column`. Then `summary` is written.</span>
<a name="ln-1226"></a><span class="c">!</span>
<a name="ln-1227"></a><span class="c">!!##### Example</span>
<a name="ln-1228"></a><span class="c">!!</span>
<a name="ln-1229"></a><span class="c">!!    program example</span>
<a name="ln-1230"></a><span class="c">!!      ...</span>
<a name="ln-1231"></a><span class="c">!!      character(*), parameter :: filename = &#39;dummy.txt&#39;</span>
<a name="ln-1232"></a><span class="c">!!      integer                 :: col_num, line_num, lun</span>
<a name="ln-1233"></a><span class="c">!!      character(128)          :: line</span>
<a name="ln-1234"></a><span class="c">!!      character(*), parameter :: message = &#39;Bad text found.&#39;</span>
<a name="ln-1235"></a><span class="c">!!</span>
<a name="ln-1236"></a><span class="c">!!      open( newunit=lun, file = filename, statu=&#39;old&#39;, form=&#39;formatted&#39; )</span>
<a name="ln-1237"></a><span class="c">!!      line_num = 0</span>
<a name="ln-1238"></a><span class="c">!!      do</span>
<a name="ln-1239"></a><span class="c">!!        read( lun, fmt=&#39;(a)&#39;, end=900 ) line</span>
<a name="ln-1240"></a><span class="c">!!        line_num = line_num + 1</span>
<a name="ln-1241"></a><span class="c">!!        call check_line( line, status, col_num )</span>
<a name="ln-1242"></a><span class="c">!!        if ( status /= 0 )</span>
<a name="ln-1243"></a><span class="c">!!          call global_logger % log_text_error( line, col_num, message, &amp;</span>
<a name="ln-1244"></a><span class="c">!!                                               filename, line_num )</span>
<a name="ln-1245"></a><span class="c">!!          error stop &#39;Error in reading &#39; // filename</span>
<a name="ln-1246"></a><span class="c">!!        end if</span>
<a name="ln-1247"></a><span class="c">!!        ...</span>
<a name="ln-1248"></a><span class="c">!!      end do</span>
<a name="ln-1249"></a><span class="c">!!900   continue</span>
<a name="ln-1250"></a><span class="c">!!      ...</span>
<a name="ln-1251"></a><span class="c">!!    end program example</span>
<a name="ln-1252"></a><span class="c">!!</span>
<a name="ln-1253"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1254"></a><span class="c">!! The logger variable to receive the message</span>
<a name="ln-1255"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">line</span>
<a name="ln-1256"></a><span class="c">!! The line of text in which the error was found.</span>
<a name="ln-1257"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">column</span>
<a name="ln-1258"></a><span class="c">!! The one&#39;s based column in LINE at which the error starts.</span>
<a name="ln-1259"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>              <span class="kd">::</span> <span class="n">summary</span>
<a name="ln-1260"></a><span class="c">!! A brief description of the error.</span>
<a name="ln-1261"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="n">filename</span>
<a name="ln-1262"></a><span class="c">!! The name of the file, if any, in which the error was found.</span>
<a name="ln-1263"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>         <span class="kd">::</span> <span class="n">line_number</span>
<a name="ln-1264"></a><span class="c">!! The one&#39;s based line number in the file where `line` was found.</span>
<a name="ln-1265"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="n">caret</span>
<a name="ln-1266"></a><span class="c">!! The symbol used to mark the column wher the error was first detected</span>
<a name="ln-1267"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>        <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-1268"></a><span class="c">!! Integer flag that an error has occurred. Has the value `success` if no</span>
<a name="ln-1269"></a><span class="c">!! error hass occurred, `index_invalid_error` if `column` is less than zero or</span>
<a name="ln-1270"></a><span class="c">!! greater than `len(line)`, and `write_failure` if any of the `write`</span>
<a name="ln-1271"></a><span class="c">!! statements has failed.</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">acaret</span>
<a name="ln-1274"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">iomsg</span>
<a name="ln-1275"></a>        <span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">iostat</span>
<a name="ln-1276"></a>        <span class="kt">integer</span>                       <span class="kd">::</span> <span class="n">lun</span>
<a name="ln-1277"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span>       <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;LOG_TEXT_ERROR&#39;</span>
<a name="ln-1278"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="p">:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">buffer</span>
<a name="ln-1279"></a>
<a name="ln-1280"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">text_error_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1281"></a>
<a name="ln-1282"></a><span class="k">        </span><span class="n">acaret</span> <span class="o">=</span> <span class="n">optval</span><span class="p">(</span><span class="n">caret</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">)</span>
<a name="ln-1283"></a>
<a name="ln-1284"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">column</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="n">column</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span> <span class="n">line</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1285"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1286"></a><span class="k">                </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">index_invalid_error</span>
<a name="ln-1287"></a>                <span class="k">return</span>
<a name="ln-1288"></a><span class="k">            else</span>
<a name="ln-1289"></a><span class="k">                call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_error</span><span class="p">(</span> <span class="n">invalid_column</span><span class="p">,</span>           <span class="p">&amp;</span>
<a name="ln-1290"></a>                                       <span class="k">module</span> <span class="o">=</span> <span class="n">module_name</span><span class="p">,</span>     <span class="p">&amp;</span>
<a name="ln-1291"></a>                                       <span class="k">procedure</span> <span class="o">=</span> <span class="n">procedure_name</span> <span class="p">)</span>
<a name="ln-1292"></a>                <span class="n">error</span> <span class="k">stop </span><span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39;: &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1293"></a>                    <span class="n">invalid_column</span>
<a name="ln-1294"></a>            <span class="k">end if</span>
<a name="ln-1295"></a><span class="k">        end if</span>
<a name="ln-1296"></a>
<a name="ln-1297"></a><span class="k">        call </span><span class="n">write_log_text_error_buffer</span><span class="p">(</span> <span class="p">)</span>
<a name="ln-1298"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1299"></a><span class="k">            write</span><span class="p">(</span> <span class="n">output_unit</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span> <span class="p">)</span> <span class="n">buffer</span>
<a name="ln-1300"></a>        <span class="k">else</span>
<a name="ln-1301"></a><span class="k">            do </span><span class="n">lun</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1302"></a>                <span class="k">write</span><span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun</span><span class="p">),</span> <span class="s1">&#39;(a)&#39;</span> <span class="p">)</span> <span class="n">buffer</span>
<a name="ln-1303"></a>            <span class="k">end do</span>
<a name="ln-1304"></a><span class="k">        end if</span>
<a name="ln-1305"></a>
<a name="ln-1306"></a><span class="k">    contains</span>
<a name="ln-1307"></a>
<a name="ln-1308"></a><span class="k">        subroutine </span><span class="n">write_log_text_error_buffer</span><span class="p">(</span> <span class="p">)</span>
<a name="ln-1309"></a>            <span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">i</span>
<a name="ln-1310"></a>            <span class="kt">character</span><span class="p">(:),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">location</span><span class="p">,</span> <span class="n">marker</span>
<a name="ln-1311"></a>
<a name="ln-1312"></a>            <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1313"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">line_number</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1314"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span> <span class="kd">::</span> <span class="n">location</span> <span class="p">)</span>
<a name="ln-1315"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">location</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(a, &quot;:&quot;, i0, &quot;:&quot;, i0)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1316"></a>                           <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span> <span class="p">)</span>           <span class="p">&amp;</span>
<a name="ln-1317"></a>                           <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="p">,</span> <span class="n">line_number</span><span class="p">,</span> <span class="n">column</span>
<a name="ln-1318"></a>                <span class="k">else</span>
<a name="ln-1319"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="nb">len_trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="mi">45</span><span class="p">)</span> <span class="kd">::</span> <span class="n">location</span> <span class="p">)</span>
<a name="ln-1320"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">location</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(a, i0)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1321"></a>                           <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1322"></a>                           <span class="s2">&quot;Error found in file: &#39;&quot;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1323"></a>                           <span class="s2">&quot;&#39;, at column: &quot;</span><span class="p">,</span> <span class="n">column</span>
<a name="ln-1324"></a>                <span class="k">end if</span>
<a name="ln-1325"></a>
<a name="ln-1326"></a><span class="k">            else</span>
<a name="ln-1327"></a><span class="k">                if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">line_number</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1328"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span> <span class="kd">::</span> <span class="n">location</span> <span class="p">)</span>
<a name="ln-1329"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">location</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(a, i0, a, i0)&#39;</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1330"></a>                           <span class="n">iomsg</span><span class="o">=</span><span class="n">iomsg</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">iostat</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1331"></a>                        <span class="s1">&#39;Error found at line number: &#39;</span><span class="p">,</span> <span class="n">line_number</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1332"></a>                        <span class="s1">&#39;, and column: &#39;</span><span class="p">,</span> <span class="n">column</span>
<a name="ln-1333"></a>                <span class="k">else</span>
<a name="ln-1334"></a><span class="k">                    allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span> <span class="kd">::</span> <span class="n">location</span> <span class="p">)</span>
<a name="ln-1335"></a>                    <span class="k">write</span><span class="p">(</span> <span class="n">location</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1336"></a>                           <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(&quot;Error found in line at column:&quot;, i0)&#39;</span> <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-1337"></a>                        <span class="n">column</span>
<a name="ln-1338"></a>                <span class="k">end if</span>
<a name="ln-1339"></a><span class="k">            end if</span>
<a name="ln-1340"></a>
<a name="ln-1341"></a><span class="k">            allocate</span><span class="p">(</span> <span class="kt">character</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="kd">::</span> <span class="n">marker</span> <span class="p">)</span>
<a name="ln-1342"></a>            <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1343"></a>                <span class="n">marker</span><span class="p">(</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1344"></a>            <span class="k">end do</span>
<a name="ln-1345"></a><span class="k">            </span><span class="n">marker</span><span class="p">(</span><span class="n">column</span><span class="p">:</span><span class="n">column</span><span class="p">)</span> <span class="o">=</span> <span class="n">acaret</span>
<a name="ln-1346"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">add_blank_line</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1347"></a><span class="k">                if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">time_stamp</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1348"></a><span class="k">                    </span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">time_stamp</span><span class="p">()</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1349"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1350"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1351"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">marker</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1352"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;Error: &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
<a name="ln-1353"></a>                <span class="k">else</span>
<a name="ln-1354"></a><span class="k">                    </span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1355"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1356"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">marker</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1357"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;Error: &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
<a name="ln-1358"></a>                <span class="k">end if</span>
<a name="ln-1359"></a><span class="k">            else</span>
<a name="ln-1360"></a><span class="k">                if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">time_stamp</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1361"></a><span class="k">                    </span><span class="n">buffer</span> <span class="o">=</span> <span class="n">time_stamp</span><span class="p">()</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1362"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1363"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1364"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">marker</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1365"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;Error: &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
<a name="ln-1366"></a>                <span class="k">else</span>
<a name="ln-1367"></a><span class="k">                    </span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">trim</span><span class="p">(</span><span class="n">location</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1368"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1369"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="n">marker</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1370"></a>                        <span class="nb">new_line</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">//</span> <span class="s1">&#39;Error: &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
<a name="ln-1371"></a>                <span class="k">end if</span>
<a name="ln-1372"></a><span class="k">            end if</span>
<a name="ln-1373"></a>
<a name="ln-1374"></a><span class="k">            if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">success</span>
<a name="ln-1375"></a>
<a name="ln-1376"></a>            <span class="k">return</span>
<a name="ln-1377"></a>
<a name="ln-1378"></a><span class="mi">999</span>         <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span> <span class="nb">stat</span> <span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1379"></a><span class="k">                </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">write_failure</span>
<a name="ln-1380"></a>                <span class="k">return</span>
<a name="ln-1381"></a><span class="k">            else</span>
<a name="ln-1382"></a><span class="k">                call </span><span class="n">handle_write_failure</span><span class="p">(</span> <span class="o">-</span><span class="mi">999</span><span class="p">,</span> <span class="n">procedure_name</span><span class="p">,</span> <span class="n">iostat</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1383"></a>                                           <span class="n">iomsg</span> <span class="p">)</span>
<a name="ln-1384"></a>            <span class="k">end if</span>
<a name="ln-1385"></a>
<a name="ln-1386"></a><span class="k">        end subroutine </span><span class="n">write_log_text_error_buffer</span>
<a name="ln-1387"></a>
<a name="ln-1388"></a>    <span class="k">end subroutine </span><span class="n">log_text_error</span>
<a name="ln-1389"></a>
<a name="ln-1390"></a>
<a name="ln-1391"></a>    <span class="k">elemental function </span><span class="n">log_units_assigned</span><span class="p">(</span><span class="n">self</span><span class="p">)</span>
<a name="ln-1392"></a><span class="c">!! version: experimental</span>
<a name="ln-1393"></a>
<a name="ln-1394"></a><span class="c">!! Returns the number of units assigned to `self % log_units`</span>
<a name="ln-1395"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_units_assigned-returns-the-number-of-active-io-units))</span>
<a name="ln-1396"></a>
<a name="ln-1397"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1398"></a><span class="c">!! The logger subject to the inquiry</span>
<a name="ln-1399"></a>        <span class="kt">integer</span>                        <span class="kd">::</span> <span class="n">log_units_assigned</span>
<a name="ln-1400"></a><span class="c">!!##### Example</span>
<a name="ln-1401"></a><span class="c">!!</span>
<a name="ln-1402"></a><span class="c">!!     module  example_mod</span>
<a name="ln-1403"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-1404"></a><span class="c">!!       ...</span>
<a name="ln-1405"></a><span class="c">!!       type(logger_type) :: alogger</span>
<a name="ln-1406"></a><span class="c">!!       ...</span>
<a name="ln-1407"></a><span class="c">!!     contains</span>
<a name="ln-1408"></a><span class="c">!!       ...</span>
<a name="ln-1409"></a><span class="c">!!       subroutine example_sub(unit, ...)</span>
<a name="ln-1410"></a><span class="c">!!         integer, intent(in) :: unit</span>
<a name="ln-1411"></a><span class="c">!!         ...</span>
<a name="ln-1412"></a><span class="c">!!         integer, allocatable :: log_units(:)</span>
<a name="ln-1413"></a><span class="c">!!         ...</span>
<a name="ln-1414"></a><span class="c">!!         if ( alogger % log_units_assigned() == 0 ) then</span>
<a name="ln-1415"></a><span class="c">!!            call alogger % add_log_unit( unit )</span>
<a name="ln-1416"></a><span class="c">!!         end if</span>
<a name="ln-1417"></a><span class="c">!!         ...</span>
<a name="ln-1418"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-1419"></a><span class="c">!!       ...</span>
<a name="ln-1420"></a><span class="c">!!     end module example_mod</span>
<a name="ln-1421"></a>
<a name="ln-1422"></a>        <span class="n">log_units_assigned</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1423"></a>
<a name="ln-1424"></a>    <span class="k">end function </span><span class="n">log_units_assigned</span>
<a name="ln-1425"></a>
<a name="ln-1426"></a>
<a name="ln-1427"></a>    <span class="k">subroutine </span><span class="n">log_warning</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="k">module</span><span class="p">,</span> <span class="k">procedure</span> <span class="p">)</span>
<a name="ln-1428"></a><span class="c">!! version: experimental</span>
<a name="ln-1429"></a>
<a name="ln-1430"></a><span class="c">!! Writes the string `message` to `self % log_units` with optional additional</span>
<a name="ln-1431"></a><span class="c">!! text.</span>
<a name="ln-1432"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#log_warning-write-the-string-message-to-log_units))</span>
<a name="ln-1433"></a>
<a name="ln-1434"></a><span class="c">!!##### Behavior</span>
<a name="ln-1435"></a><span class="c">!!</span>
<a name="ln-1436"></a><span class="c">!! If time stamps are active, a time stamp is written, followed by</span>
<a name="ln-1437"></a><span class="c">!! `module` and `procedure` if present, then `message` is</span>
<a name="ln-1438"></a><span class="c">!! written with the prefix &#39;WARN: &#39;.</span>
<a name="ln-1439"></a><span class="c">!!</span>
<a name="ln-1440"></a><span class="c">!!##### Example</span>
<a name="ln-1441"></a><span class="c">!!</span>
<a name="ln-1442"></a><span class="c">!!     module  example_mod</span>
<a name="ln-1443"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-1444"></a><span class="c">!!       ...</span>
<a name="ln-1445"></a><span class="c">!!       real, allocatable :: a(:)</span>
<a name="ln-1446"></a><span class="c">!!       ...</span>
<a name="ln-1447"></a><span class="c">!!       type(logger_type) :: alogger</span>
<a name="ln-1448"></a><span class="c">!!       ...</span>
<a name="ln-1449"></a><span class="c">!!     contains</span>
<a name="ln-1450"></a><span class="c">!!       ...</span>
<a name="ln-1451"></a><span class="c">!!       subroutine example_sub( size, stat )</span>
<a name="ln-1452"></a><span class="c">!!         integer, intent(in)  :: size</span>
<a name="ln-1453"></a><span class="c">!!         integer, intent(out) :: stat</span>
<a name="ln-1454"></a><span class="c">!!         allocate( a(size) )</span>
<a name="ln-1455"></a><span class="c">!!         if ( stat /= 0 ) then</span>
<a name="ln-1456"></a><span class="c">!!           write( message, `(a, i0)&#39; )                    &amp;</span>
<a name="ln-1457"></a><span class="c">!!               &quot;Allocation of A failed with SIZE = &quot;, size</span>
<a name="ln-1458"></a><span class="c">!!           call alogger % log_warning( message,                   &amp;</span>
<a name="ln-1459"></a><span class="c">!!                                       module = &#39;EXAMPLE_MOD&#39;,    &amp;</span>
<a name="ln-1460"></a><span class="c">!!                                       procedure = &#39;EXAMPLE_SUB&#39; )</span>
<a name="ln-1461"></a><span class="c">!!         end if</span>
<a name="ln-1462"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-1463"></a><span class="c">!!       ...</span>
<a name="ln-1464"></a><span class="c">!!     end module example_mod</span>
<a name="ln-1465"></a><span class="c">!!</span>
<a name="ln-1466"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1467"></a><span class="c">!! The logger to which the message is written</span>
<a name="ln-1468"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">message</span>
<a name="ln-1469"></a><span class="c">!! A string to be written to LOG_UNIT</span>
<a name="ln-1470"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">module</span>
<a name="ln-1471"></a><span class="c">!! The name of the module containing the current invocation of `log_warning`</span>
<a name="ln-1472"></a>        <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>  <span class="kd">::</span> <span class="k">procedure</span>
<a name="ln-1473"></a><span class="c">!! The name of the procedure containing the current invocation of `log_warning`</span>
<a name="ln-1474"></a>
<a name="ln-1475"></a>        <span class="k">if</span> <span class="p">(</span> <span class="n">self</span> <span class="p">%</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="n">warning_level</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1476"></a>
<a name="ln-1477"></a><span class="k">        call </span><span class="n">self</span> <span class="p">%</span> <span class="n">log_message</span><span class="p">(</span> <span class="n">message</span><span class="p">,</span>               <span class="p">&amp;</span>
<a name="ln-1478"></a>                                 <span class="k">module</span> <span class="o">=</span> <span class="k">module</span><span class="p">,</span>       <span class="p">&amp;</span>
<a name="ln-1479"></a>                                 <span class="k">procedure</span> <span class="o">=</span> <span class="k">procedure</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-1480"></a>                                 <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;WARN&#39;</span> <span class="p">)</span>
<a name="ln-1481"></a>
<a name="ln-1482"></a>    <span class="k">end subroutine </span><span class="n">log_warning</span>
<a name="ln-1483"></a>
<a name="ln-1484"></a>
<a name="ln-1485"></a>    <span class="k">subroutine </span><span class="n">remove_log_unit</span><span class="p">(</span> <span class="n">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">close_unit</span><span class="p">,</span> <span class="nb">stat</span> <span class="p">)</span>
<a name="ln-1486"></a><span class="c">!! version: experimental</span>
<a name="ln-1487"></a>
<a name="ln-1488"></a><span class="c">!! Remove the I/O unit from the self % log_units list. If `close_unit` is</span>
<a name="ln-1489"></a><span class="c">!! present and `.true.` then the corresponding file is closed. If `unit` is</span>
<a name="ln-1490"></a><span class="c">!! not in `log_units` then nothing is done. If `stat` is present it, by</span>
<a name="ln-1491"></a><span class="c">!! default, has the value `success`. If closing the `unit` fails, then if</span>
<a name="ln-1492"></a><span class="c">!! `stat` is present it has the value `close_failure`, otherwise processing</span>
<a name="ln-1493"></a><span class="c">!! stops with an informative message.</span>
<a name="ln-1494"></a><span class="c">!!([Specification](../page/specs/stdlib_logger.html#remove_log_unit-remove-unit-from-self-log_units))</span>
<a name="ln-1495"></a>
<a name="ln-1496"></a>        <span class="k">class</span><span class="p">(</span><span class="n">logger_type</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">self</span>
<a name="ln-1497"></a><span class="c">!! The logger variable whose unit is to be removed</span>
<a name="ln-1498"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">unit</span>
<a name="ln-1499"></a><span class="c">!! The I/O unit to be removed from self</span>
<a name="ln-1500"></a>        <span class="kt">logical</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">),</span> <span class="k">optional</span>     <span class="kd">::</span> <span class="n">close_unit</span>
<a name="ln-1501"></a><span class="c">!! A logical flag to close the unit while removing it from the SELF list</span>
<a name="ln-1502"></a>        <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="k">optional</span>    <span class="kd">::</span> <span class="nb">stat</span>
<a name="ln-1503"></a><span class="c">!! An error status with the values</span>
<a name="ln-1504"></a><span class="c">!! * success - no problems found</span>
<a name="ln-1505"></a><span class="c">!! * close_failure - the close statement for unit failed</span>
<a name="ln-1506"></a><span class="c">!!</span>
<a name="ln-1507"></a><span class="c">!!##### Example</span>
<a name="ln-1508"></a><span class="c">!!</span>
<a name="ln-1509"></a><span class="c">!!     module  example_mod</span>
<a name="ln-1510"></a><span class="c">!!       use stdlib_logger</span>
<a name="ln-1511"></a><span class="c">!!       ...</span>
<a name="ln-1512"></a><span class="c">!!       type(logger_type) ::  alogger</span>
<a name="ln-1513"></a><span class="c">!!     contains</span>
<a name="ln-1514"></a><span class="c">!!       ...</span>
<a name="ln-1515"></a><span class="c">!!       subroutine example_sub(unit, ...)</span>
<a name="ln-1516"></a><span class="c">!!         integer, intent(in) :: unit</span>
<a name="ln-1517"></a><span class="c">!!         ...</span>
<a name="ln-1518"></a><span class="c">!!         call alogger % remove_log_unit( unit )</span>
<a name="ln-1519"></a><span class="c">!!         ...</span>
<a name="ln-1520"></a><span class="c">!!       end subroutine example_sub</span>
<a name="ln-1521"></a><span class="c">!!       ...</span>
<a name="ln-1522"></a><span class="c">!!     end module example_mod</span>
<a name="ln-1523"></a>
<a name="ln-1524"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span> <span class="kd">::</span> <span class="n">errmsg</span>
<a name="ln-1525"></a>        <span class="kt">integer</span> <span class="kd">::</span> <span class="n">lun</span><span class="p">,</span> <span class="n">lun_old</span>
<a name="ln-1526"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">procedure_name</span> <span class="o">=</span> <span class="s1">&#39;REMOVE_LOG_UNIT&#39;</span>
<a name="ln-1527"></a>
<a name="ln-1528"></a>        <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="nb">stat</span> <span class="o">=</span> <span class="n">success</span>
<a name="ln-1529"></a>        <span class="k">do </span><span class="n">lun</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1530"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">unit</span> <span class="o">==</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span> <span class="p">)</span> <span class="k">exit</span>
<a name="ln-1531"></a><span class="k">        end do</span>
<a name="ln-1532"></a>
<a name="ln-1533"></a><span class="k">        if</span> <span class="p">(</span> <span class="n">lun</span> <span class="o">==</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="k">return</span>
<a name="ln-1534"></a>
<a name="ln-1535"></a><span class="k">        if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="n">close_unit</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1536"></a><span class="k">            if</span> <span class="p">(</span> <span class="n">close_unit</span> <span class="p">)</span> <span class="k">close</span><span class="p">(</span> <span class="n">unit</span><span class="p">,</span> <span class="n">err</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">iomsg</span><span class="o">=</span><span class="n">errmsg</span> <span class="p">)</span>
<a name="ln-1537"></a>        <span class="k">end if</span>
<a name="ln-1538"></a>
<a name="ln-1539"></a><span class="k">        do </span><span class="n">lun_old</span><span class="o">=</span><span class="n">lun</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span>
<a name="ln-1540"></a>            <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun_old</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">log_units</span><span class="p">(</span><span class="n">lun_old</span><span class="p">)</span>
<a name="ln-1541"></a>        <span class="k">end do</span>
<a name="ln-1542"></a><span class="k">        </span><span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">=</span> <span class="n">self</span> <span class="p">%</span> <span class="n">units</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1543"></a>
<a name="ln-1544"></a>        <span class="k">return</span>
<a name="ln-1545"></a>
<a name="ln-1546"></a><span class="mi">999</span>     <span class="k">if</span> <span class="p">(</span> <span class="nb">present</span><span class="p">(</span><span class="nb">stat</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span>
<a name="ln-1547"></a><span class="k">            </span><span class="nb">stat</span> <span class="o">=</span> <span class="n">close_failure</span>
<a name="ln-1548"></a>            <span class="k">return</span>
<a name="ln-1549"></a><span class="k">        else</span>
<a name="ln-1550"></a><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a, i0)&#39;</span><span class="p">)</span> <span class="s1">&#39;In &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1551"></a>                <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39; close_unit failed for unit = &#39;</span><span class="p">,</span> <span class="n">unit</span>
<a name="ln-1552"></a>            <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a)&#39;</span> <span class="p">)</span> <span class="s1">&#39;With iomsg = &#39;</span> <span class="o">//</span> <span class="nb">trim</span><span class="p">(</span><span class="n">errmsg</span><span class="p">)</span>
<a name="ln-1553"></a>            <span class="n">error</span> <span class="k">stop</span> <span class="s1">&#39;close_unit failed in &#39;</span> <span class="o">//</span> <span class="n">module_name</span> <span class="o">//</span> <span class="s1">&#39; % &#39;</span> <span class="o">//</span> <span class="p">&amp;</span>
<a name="ln-1554"></a>                <span class="n">procedure_name</span> <span class="o">//</span> <span class="s1">&#39;.&#39;</span>
<a name="ln-1555"></a>        <span class="k">end if</span>
<a name="ln-1556"></a>
<a name="ln-1557"></a><span class="k">    end subroutine </span><span class="n">remove_log_unit</span>
<a name="ln-1558"></a>
<a name="ln-1559"></a>
<a name="ln-1560"></a>    <span class="k">function </span><span class="n">time_stamp</span><span class="p">()</span>
<a name="ln-1561"></a><span class="c">!! Creates a time stamp in the format &#39;yyyy-mm-dd hh:mm:ss.sss&#39;</span>
<a name="ln-1562"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="kd">::</span> <span class="n">time_stamp</span>
<a name="ln-1563"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">date</span>
<a name="ln-1564"></a>        <span class="kt">character</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">time</span>
<a name="ln-1565"></a>
<a name="ln-1566"></a><span class="nb">        </span><span class="k">call </span><span class="nb">date_and_time</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span> <span class="p">)</span>
<a name="ln-1567"></a>
<a name="ln-1568"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>   <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1569"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">)</span>   <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
<a name="ln-1570"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">)</span>   <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">)</span>
<a name="ln-1571"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>   <span class="o">=</span> <span class="s1">&#39;-&#39;</span>
<a name="ln-1572"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">9</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>  <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span>
<a name="ln-1573"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">11</span><span class="p">:</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
<a name="ln-1574"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">12</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="nb">time</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-1575"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">14</span><span class="p">:</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
<a name="ln-1576"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">15</span><span class="p">:</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="nb">time</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-1577"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">17</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span> <span class="s1">&#39;:&#39;</span>
<a name="ln-1578"></a>        <span class="n">time_stamp</span><span class="p">(</span><span class="mi">18</span><span class="p">:</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="nb">time</span><span class="p">(</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>
<a name="ln-1579"></a>
<a name="ln-1580"></a>    <span class="k">end function </span><span class="n">time_stamp</span>
<a name="ln-1581"></a>
<a name="ln-1582"></a><span class="k">end module </span><span class="n">stdlib_logger</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
                                          <br /><small>8a5f3d4</small></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
             on 2021-03-21 23:33  
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>