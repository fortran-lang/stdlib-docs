<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_hash_32bit_water.fypp &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>Contributing and specs</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>




          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>stdlib_hash_32bit_water.fypp
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for source files.">131 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/stdlib_hash_32bit_water.fypp"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">stdlib_hash_32bit_water.fypp</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#submods-0">Submodules</a></h3></div>
  <div id="submods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stdlib_hash_32bit_water.html">stdlib_hash_32bit_water</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stdlib_hash_32bit_water.fypp.html#src">stdlib_hash_32bit_water.fypp</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      <p><code>WATER_HASH</code> is a translation to Fortran 2008 of the <code>waterhash</code> algorithm
 of Tommy Ettinger. Tommy Ettinger's original C++ code, <code>waterhash.h</code>, is
 available at the URL: https://github.com/tommyettinger/waterhash under the
 <code>unlicense</code>, https://github.com/tommyettinger/waterhash/blob/master/LICENSE.
 "<code>waterhash</code> is a variant on Wang Yi's <code>wyhash</code>, with 32 bit output,
 using at most 64 bit arithmetic. <code>wyhash</code> is available at the URL:
 <code>https://github.com/wangyi-fudan/wyhash</code> also under the unlicense:
 <code>https://github.com/wangyi-fudan/wyhash/blob/master/LICENSE</code>.
 Original Author: Wang Yi <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#103;&#111;&#100;&#115;&#112;&#101;&#101;&#100;&#95;&#99;&#104;&#105;&#110;&#97;&#64;&#121;&#101;&#97;&#104;&#46;&#110;&#101;&#116;">&#103;&#111;&#100;&#115;&#112;&#101;&#101;&#100;&#95;&#99;&#104;&#105;&#110;&#97;&#64;&#121;&#101;&#97;&#104;&#46;&#110;&#101;&#116;</a>
 Waterhash Variant Author: Tommy Ettinger <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#111;&#109;&#109;&#121;&#46;&#101;&#116;&#116;&#105;&#110;&#103;&#101;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#116;&#111;&#109;&#109;&#121;&#46;&#101;&#116;&#116;&#105;&#110;&#103;&#101;&#114;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></p>
<p>The <code>unlicense</code> reads as follows:
   This is free and unencumbered software released into the public domain.</p>
<p>Anyone is free to copy, modify, publish, use, compile, sell, or
   distribute this software, either in source code form or as a compiled
   binary, for any purpose, commercial or non-commercial, and by any
   means.</p>
<p>In jurisdictions that recognize copyright laws, the author or authors
   of this software dedicate any and all copyright interest in the
   software to the public domain. We make this dedication for the benefit
   of the public at large and to the detriment of our heirs and
   successors. We intend this dedication to be an overt act of
   relinquishment in perpetuity of all present and future rights to this
   software under copyright law.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
   IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
   OTHER DEALINGS IN THE SOFTWARE.</p>
<p>For more information, please refer to <a href="http://unlicense.org">http://unlicense.org</a></p>
<p><code>WATER_HASH</code> is distributed as part of the <code>stdlib_32_bit_hash_functions.f90</code>
 module and its <code>stdlib_hash_32bit_water.f90</code> submodule with the Fortran
 Standard Library at URL: https://github.com/fortran-lang/stdlib.
 The Fortran Standard Library, including this code, is distributed under the
 MIT License as described in the <code>LICENSE</code> file distributed with the library.
 <code>WATER_HASH</code> differs from <code>waterhash.h</code> not only in its use of Fortran,
 but also in its use of signed two's complement arithmetic in contrast to
 the unsigned arithmetic of Ettinger and Wang Yi, and in making some of the
 uses of <code>TRANSFER</code> endian dependent, in an attempt to make the quality of
 the hash endian independent. The use of signed arithmetic may change with
 the planned introduction of the unsigned BITS datatype in what is currently
 known as Fortran 202X.</p>
<p>To be useful this code must be processed by a processor that implements two
 Fortran 2008 extensions to Fortran 2003: submodules, and 64 bit (<code>INT64</code>)
 integers. The processor must also use two's complement integers
 (all Fortran 95+ processors use two's complement arithmetic) with
 wrap around overflow at runtime and for BOZ constants. The latest releases
 of the following processors are known to implement the required Fortran
 2008 extensions and default to runtime wrap around overflow: FLANG,
 gfortran, ifort, and NAG Fortran. Older versions of gfortran will require
 the compiler flag, <code>-fno-range-check</code>, to ensure wrap around semantics
 for BOZ constants, and only versions of the NAG compiler starting with
 version 17, have implemented submodules. The latest releases of Cray
 Fortran and IBM Fortran are known to implement the Fortran 2008 extensions,
 but whether they also implement wrap around overflow is unknown.</p>
<p>This implementation has only been tested on little endian processors. It
 will generate different hashes on big endian processors, but they are
 believed to be of comparable quality to those generated for little endian
 processors.</p>
<h2 id="no-version-of-this-hash-is-suitable-as-a-cryptographic-hash">No version of this hash is suitable as a cryptographic hash.</h2>
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Title: sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph Pages: 1 -->
<svg id="sourcefilestdlib_hash_32bit_waterfyppEfferentGraph" width="441pt" height="32pt"
 viewBox="0.00 0.00 441.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 437,-28 437,4 -4,4"/>
<!-- sourcefile~stdlib_hash_32bit_water.fypp -->
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_node1" class="node">
<title>sourcefile~stdlib_hash_32bit_water.fypp</title>
<polygon fill="none" stroke="black" points="433,-24 282,-24 282,0 433,0 433,-24"/>
<text text-anchor="middle" x="357.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">stdlib_hash_32bit_water.fypp</text>
</g>
<!-- sourcefile~stdlib_hash_32bit.fypp -->
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_node2" class="node">
<title>sourcefile~stdlib_hash_32bit.fypp</title>
<g id="a_sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_node2"><a xlink:href=".././sourcefile/stdlib_hash_32bit.fypp.html" xlink:title="stdlib_hash_32bit.fypp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="246,-24 127,-24 127,0 246,0 246,-24"/>
<text text-anchor="middle" x="186.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stdlib_hash_32bit.fypp</text>
</a>
</g>
</g>
<!-- sourcefile~stdlib_hash_32bit_water.fypp&#45;&gt;sourcefile~stdlib_hash_32bit.fypp -->
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_edge1" class="edge">
<title>sourcefile~stdlib_hash_32bit_water.fypp&#45;&gt;sourcefile~stdlib_hash_32bit.fypp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.88,-12C273.4,-12 264.77,-12 256.37,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="256.24,-8.5 246.24,-12 256.24,-15.5 256.24,-8.5"/>
</g>
<!-- sourcefile~stdlib_kinds.fypp -->
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_node3" class="node">
<title>sourcefile~stdlib_kinds.fypp</title>
<g id="a_sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_node3"><a xlink:href=".././sourcefile/stdlib_kinds.fypp.html" xlink:title="stdlib_kinds.fypp">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="91,-24 0,-24 0,0 91,0 91,-24"/>
<text text-anchor="middle" x="45.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stdlib_kinds.fypp</text>
</a>
</g>
</g>
<!-- sourcefile~stdlib_hash_32bit.fypp&#45;&gt;sourcefile~stdlib_kinds.fypp -->
<g id="sourcefile~~stdlib_hash_32bit_water.fypp~~EfferentGraph_edge2" class="edge">
<title>sourcefile~stdlib_hash_32bit.fypp&#45;&gt;sourcefile~stdlib_kinds.fypp</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M126.95,-12C118.41,-12 109.64,-12 101.17,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="101.04,-8.5 91.04,-12 101.04,-15.5 101.04,-8.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (20211204.2007)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="190pt" height="32pt"
 viewBox="0.00 0.00 190.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 186,-28 186,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="67,-24 0,-24 0,0 67,0 67,-24"/>
<text text-anchor="middle" x="33.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="182,-24 85,-24 85,0 182,0 182,-24"/>
<text text-anchor="middle" x="133.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 








<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#submods-1">Submodules</a></h3></div>
  <div id="submods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/stdlib_hash_32bit_water.html">stdlib_hash_32bit_water</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/stdlib_hash_32bit_water.fypp.html#src">stdlib_hash_32bit_water.fypp</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1"></a><span class="c">!!------------------------------------------------------------------------------</span>
<a id="ln-2" name="ln-2"></a><span class="c">!! `WATER_HASH` is a translation to Fortran 2008 of the `waterhash` algorithm</span>
<a id="ln-3" name="ln-3"></a><span class="c">!! of Tommy Ettinger. Tommy Ettinger&#39;s original C++ code, `waterhash.h`, is</span>
<a id="ln-4" name="ln-4"></a><span class="c">!! available at the URL: https://github.com/tommyettinger/waterhash under the</span>
<a id="ln-5" name="ln-5"></a><span class="c">!! `unlicense`, https://github.com/tommyettinger/waterhash/blob/master/LICENSE.</span>
<a id="ln-6" name="ln-6"></a><span class="c">!! &quot;`waterhash` is a variant on Wang Yi&#39;s `wyhash`, with 32 bit output,</span>
<a id="ln-7" name="ln-7"></a><span class="c">!! using at most 64 bit arithmetic. `wyhash` is available at the URL:</span>
<a id="ln-8" name="ln-8"></a><span class="c">!! `https://github.com/wangyi-fudan/wyhash` also under the unlicense:</span>
<a id="ln-9" name="ln-9"></a><span class="c">!! `https://github.com/wangyi-fudan/wyhash/blob/master/LICENSE`.</span>
<a id="ln-10" name="ln-10"></a><span class="c">!! Original Author: Wang Yi &lt;godspeed_china@yeah.net&gt;</span>
<a id="ln-11" name="ln-11"></a><span class="c">!! Waterhash Variant Author: Tommy Ettinger &lt;tommy.ettinger@gmail.com&gt;</span>
<a id="ln-12" name="ln-12"></a><span class="c">!!</span>
<a id="ln-13" name="ln-13"></a><span class="c">!! The `unlicense` reads as follows:</span>
<a id="ln-14" name="ln-14"></a><span class="c">!!   This is free and unencumbered software released into the public domain.</span>
<a id="ln-15" name="ln-15"></a><span class="c">!!</span>
<a id="ln-16" name="ln-16"></a><span class="c">!!   Anyone is free to copy, modify, publish, use, compile, sell, or</span>
<a id="ln-17" name="ln-17"></a><span class="c">!!   distribute this software, either in source code form or as a compiled</span>
<a id="ln-18" name="ln-18"></a><span class="c">!!   binary, for any purpose, commercial or non-commercial, and by any</span>
<a id="ln-19" name="ln-19"></a><span class="c">!!   means.</span>
<a id="ln-20" name="ln-20"></a><span class="c">!!</span>
<a id="ln-21" name="ln-21"></a><span class="c">!!   In jurisdictions that recognize copyright laws, the author or authors</span>
<a id="ln-22" name="ln-22"></a><span class="c">!!   of this software dedicate any and all copyright interest in the</span>
<a id="ln-23" name="ln-23"></a><span class="c">!!   software to the public domain. We make this dedication for the benefit</span>
<a id="ln-24" name="ln-24"></a><span class="c">!!   of the public at large and to the detriment of our heirs and</span>
<a id="ln-25" name="ln-25"></a><span class="c">!!   successors. We intend this dedication to be an overt act of</span>
<a id="ln-26" name="ln-26"></a><span class="c">!!   relinquishment in perpetuity of all present and future rights to this</span>
<a id="ln-27" name="ln-27"></a><span class="c">!!   software under copyright law.</span>
<a id="ln-28" name="ln-28"></a><span class="c">!!</span>
<a id="ln-29" name="ln-29"></a><span class="c">!!   THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<a id="ln-30" name="ln-30"></a><span class="c">!!   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<a id="ln-31" name="ln-31"></a><span class="c">!!   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</span>
<a id="ln-32" name="ln-32"></a><span class="c">!!   IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span>
<a id="ln-33" name="ln-33"></a><span class="c">!!   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span>
<a id="ln-34" name="ln-34"></a><span class="c">!!   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span>
<a id="ln-35" name="ln-35"></a><span class="c">!!   OTHER DEALINGS IN THE SOFTWARE.</span>
<a id="ln-36" name="ln-36"></a><span class="c">!!</span>
<a id="ln-37" name="ln-37"></a><span class="c">!!   For more information, please refer to &lt;http://unlicense.org&gt;</span>
<a id="ln-38" name="ln-38"></a><span class="c">!!</span>
<a id="ln-39" name="ln-39"></a><span class="c">!! `WATER_HASH` is distributed as part of the `stdlib_32_bit_hash_functions.f90`</span>
<a id="ln-40" name="ln-40"></a><span class="c">!! module and its `stdlib_hash_32bit_water.f90` submodule with the Fortran</span>
<a id="ln-41" name="ln-41"></a><span class="c">!! Standard Library at URL: https://github.com/fortran-lang/stdlib.</span>
<a id="ln-42" name="ln-42"></a><span class="c">!! The Fortran Standard Library, including this code, is distributed under the</span>
<a id="ln-43" name="ln-43"></a><span class="c">!! MIT License as described in the `LICENSE` file distributed with the library.</span>
<a id="ln-44" name="ln-44"></a><span class="c">!! `WATER_HASH` differs from `waterhash.h` not only in its use of Fortran,</span>
<a id="ln-45" name="ln-45"></a><span class="c">!! but also in its use of signed two&#39;s complement arithmetic in contrast to</span>
<a id="ln-46" name="ln-46"></a><span class="c">!! the unsigned arithmetic of Ettinger and Wang Yi, and in making some of the</span>
<a id="ln-47" name="ln-47"></a><span class="c">!! uses of `TRANSFER` endian dependent, in an attempt to make the quality of</span>
<a id="ln-48" name="ln-48"></a><span class="c">!! the hash endian independent. The use of signed arithmetic may change with</span>
<a id="ln-49" name="ln-49"></a><span class="c">!! the planned introduction of the unsigned BITS datatype in what is currently</span>
<a id="ln-50" name="ln-50"></a><span class="c">!! known as Fortran 202X.</span>
<a id="ln-51" name="ln-51"></a><span class="c">!!</span>
<a id="ln-52" name="ln-52"></a><span class="c">!! To be useful this code must be processed by a processor that implements two</span>
<a id="ln-53" name="ln-53"></a><span class="c">!! Fortran 2008 extensions to Fortran 2003: submodules, and 64 bit (`INT64`)</span>
<a id="ln-54" name="ln-54"></a><span class="c">!! integers. The processor must also use two&#39;s complement integers</span>
<a id="ln-55" name="ln-55"></a><span class="c">!! (all Fortran 95+ processors use two&#39;s complement arithmetic) with</span>
<a id="ln-56" name="ln-56"></a><span class="c">!! wrap around overflow at runtime and for BOZ constants. The latest releases</span>
<a id="ln-57" name="ln-57"></a><span class="c">!! of the following processors are known to implement the required Fortran</span>
<a id="ln-58" name="ln-58"></a><span class="c">!! 2008 extensions and default to runtime wrap around overflow: FLANG,</span>
<a id="ln-59" name="ln-59"></a><span class="c">!! gfortran, ifort, and NAG Fortran. Older versions of gfortran will require</span>
<a id="ln-60" name="ln-60"></a><span class="c">!! the compiler flag, `-fno-range-check`, to ensure wrap around semantics</span>
<a id="ln-61" name="ln-61"></a><span class="c">!! for BOZ constants, and only versions of the NAG compiler starting with</span>
<a id="ln-62" name="ln-62"></a><span class="c">!! version 17, have implemented submodules. The latest releases of Cray</span>
<a id="ln-63" name="ln-63"></a><span class="c">!! Fortran and IBM Fortran are known to implement the Fortran 2008 extensions,</span>
<a id="ln-64" name="ln-64"></a><span class="c">!! but whether they also implement wrap around overflow is unknown.</span>
<a id="ln-65" name="ln-65"></a><span class="c">!!</span>
<a id="ln-66" name="ln-66"></a><span class="c">!! This implementation has only been tested on little endian processors. It</span>
<a id="ln-67" name="ln-67"></a><span class="c">!! will generate different hashes on big endian processors, but they are</span>
<a id="ln-68" name="ln-68"></a><span class="c">!! believed to be of comparable quality to those generated for little endian</span>
<a id="ln-69" name="ln-69"></a><span class="c">!! processors.</span>
<a id="ln-70" name="ln-70"></a><span class="c">!!</span>
<a id="ln-71" name="ln-71"></a><span class="c">!! No version of this hash is suitable as a cryptographic hash.</span>
<a id="ln-72" name="ln-72"></a><span class="c">!!------------------------------------------------------------------------------</span>
<a id="ln-73" name="ln-73"></a>
<a id="ln-74" name="ln-74"></a><span class="cp">#! Integer kinds to be considered during templating</span>
<a id="ln-75" name="ln-75"></a><span class="cp">#:set INT_KINDS = [&quot;int16&quot;, &quot;int32&quot;, &quot;int64&quot;]</span>
<a id="ln-76" name="ln-76"></a>
<a id="ln-77" name="ln-77"></a><span class="k">submodule</span><span class="p">(</span><span class="n">stdlib_hash_32bit</span><span class="p">)</span> <span class="n">stdlib_hash_32bit_water</span>
<a id="ln-78" name="ln-78"></a>    <span class="k">implicit none</span>
<a id="ln-79" name="ln-79"></a>
<a id="ln-80" name="ln-80"></a><span class="k">contains</span>
<a id="ln-81" name="ln-81"></a>
<a id="ln-82" name="ln-82"></a><span class="k">    pure module function </span><span class="n">int8_water_hash</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="n">seed</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">hash_code</span><span class="p">)</span>
<a id="ln-83" name="ln-83"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">hash_code</span>
<a id="ln-84" name="ln-84"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">key</span><span class="p">(</span><span class="mi">0</span><span class="p">:)</span>
<a id="ln-85" name="ln-85"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">seed</span>
<a id="ln-86" name="ln-86"></a>
<a id="ln-87" name="ln-87"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">dummy</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-88" name="ln-88"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">h</span>
<a id="ln-89" name="ln-89"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">i</span>
<a id="ln-90" name="ln-90"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="nb">len</span>
<a id="ln-91" name="ln-91"></a><span class="nb">        </span><span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">parameter</span> <span class="kd">::</span>                <span class="p">&amp;</span>
<a id="ln-92" name="ln-92"></a>            <span class="n">waterp0</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;a0761d65&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-93" name="ln-93"></a>            <span class="n">waterp1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;e7037ed1&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-94" name="ln-94"></a>            <span class="n">waterp2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;8ebc6af1&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-95" name="ln-95"></a>            <span class="n">waterp3</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;589965cd&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-96" name="ln-96"></a>            <span class="n">waterp4</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;1d8e4e27&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-97" name="ln-97"></a>            <span class="n">waterp5</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="s1">&#39;eb44accb&#39;</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a id="ln-98" name="ln-98"></a>
<a id="ln-99" name="ln-99"></a>        <span class="nb">len</span> <span class="o">=</span> <span class="n">size</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
<a id="ln-100" name="ln-100"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">seed</span>
<a id="ln-101" name="ln-101"></a>        <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="mi">0_int64</span><span class="p">,</span> <span class="nb">len</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span>
<a id="ln-102" name="ln-102"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span><span class="n">waterp1</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-103" name="ln-103"></a>                                  <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span><span class="n">waterp2</span><span class="p">))</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="p">&amp;</span>
<a id="ln-104" name="ln-104"></a>                         <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:)),</span><span class="n">waterp3</span><span class="p">),</span>      <span class="p">&amp;</span>
<a id="ln-105" name="ln-105"></a>                                  <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">12</span><span class="p">:)),</span><span class="n">waterp4</span><span class="p">)))</span>
<a id="ln-106" name="ln-106"></a>        <span class="k">end do</span>
<a id="ln-107" name="ln-107"></a><span class="k">        </span><span class="n">h</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">waterp5</span>
<a id="ln-108" name="ln-108"></a>
<a id="ln-109" name="ln-109"></a>        <span class="k">select case</span><span class="p">(</span> <span class="nb">iand</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="mi">15_int64</span><span class="p">)</span> <span class="p">)</span>
<a id="ln-110" name="ln-110"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-111" name="ln-111"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterp2</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span>               <span class="p">&amp;</span>
<a id="ln-112" name="ln-112"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">waterp1</span><span class="p">))</span>
<a id="ln-113" name="ln-113"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-114" name="ln-114"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterp3</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span>               <span class="p">&amp;</span>
<a id="ln-115" name="ln-115"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">waterp4</span><span class="p">))</span>
<a id="ln-116" name="ln-116"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<a id="ln-117" name="ln-117"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-118" name="ln-118"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">))</span>
<a id="ln-119" name="ln-119"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="ln-120" name="ln-120"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-121" name="ln-121"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:)),</span> <span class="n">waterp3</span><span class="p">))</span>
<a id="ln-122" name="ln-122"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<a id="ln-123" name="ln-123"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-124" name="ln-124"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp1</span><span class="p">))</span>
<a id="ln-125" name="ln-125"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<a id="ln-126" name="ln-126"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-127" name="ln-127"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp1</span><span class="p">))</span>
<a id="ln-128" name="ln-128"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<a id="ln-129" name="ln-129"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>             <span class="p">&amp;</span>
<a id="ln-130" name="ln-130"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="nb">ior</span><span class="p">(</span><span class="nb">ishft</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="mi">8</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-131" name="ln-131"></a>                                  <span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">:))),</span> <span class="n">waterp1</span><span class="p">))</span>
<a id="ln-132" name="ln-132"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<a id="ln-133" name="ln-133"></a>            <span class="n">h</span> <span class="o">=</span> <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>        <span class="p">&amp;</span>
<a id="ln-134" name="ln-134"></a>                         <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp0</span><span class="p">))</span>
<a id="ln-135" name="ln-135"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<a id="ln-136" name="ln-136"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>          <span class="p">&amp;</span>
<a id="ln-137" name="ln-137"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a id="ln-138" name="ln-138"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">waterp4</span><span class="p">),</span>                    <span class="p">&amp;</span>
<a id="ln-139" name="ln-139"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:)),</span> <span class="n">waterp3</span><span class="p">)))</span>
<a id="ln-140" name="ln-140"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<a id="ln-141" name="ln-141"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>            <span class="p">&amp;</span>
<a id="ln-142" name="ln-142"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a id="ln-143" name="ln-143"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:)),</span> <span class="n">waterp3</span><span class="p">)))</span>
<a id="ln-144" name="ln-144"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<a id="ln-145" name="ln-145"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>            <span class="p">&amp;</span>
<a id="ln-146" name="ln-146"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a id="ln-147" name="ln-147"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="n">h</span><span class="p">,</span>                                     <span class="p">&amp;</span>
<a id="ln-148" name="ln-148"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="nb">ior</span><span class="p">(</span><span class="nb">ishft</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:)),</span><span class="mi">8</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-149" name="ln-149"></a>                                       <span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">10</span><span class="p">:))),</span>        <span class="p">&amp;</span>
<a id="ln-150" name="ln-150"></a>                                   <span class="n">waterp3</span><span class="p">)))</span>
<a id="ln-151" name="ln-151"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<a id="ln-152" name="ln-152"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>          <span class="p">&amp;</span>
<a id="ln-153" name="ln-153"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span> <span class="p">&amp;</span>
<a id="ln-154" name="ln-154"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:))),</span>        <span class="p">&amp;</span>
<a id="ln-155" name="ln-155"></a>                                      <span class="n">waterp4</span><span class="p">))</span>
<a id="ln-156" name="ln-156"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<a id="ln-157" name="ln-157"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>            <span class="p">&amp;</span>
<a id="ln-158" name="ln-158"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a id="ln-159" name="ln-159"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:))),</span>          <span class="p">&amp;</span>
<a id="ln-160" name="ln-160"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">12</span><span class="p">:)),</span> <span class="n">waterp4</span><span class="p">)))</span>
<a id="ln-161" name="ln-161"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<a id="ln-162" name="ln-162"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>            <span class="p">&amp;</span>
<a id="ln-163" name="ln-163"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span>   <span class="p">&amp;</span>
<a id="ln-164" name="ln-164"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:))),</span>          <span class="p">&amp;</span>
<a id="ln-165" name="ln-165"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">12</span><span class="p">:)),</span> <span class="n">waterp4</span><span class="p">)))</span>
<a id="ln-166" name="ln-166"></a>        <span class="k">case</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<a id="ln-167" name="ln-167"></a>            <span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span><span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="p">:)),</span> <span class="n">h</span><span class="p">),</span>             <span class="p">&amp;</span>
<a id="ln-168" name="ln-168"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:)),</span> <span class="n">waterp2</span><span class="p">)),</span>    <span class="p">&amp;</span>
<a id="ln-169" name="ln-169"></a>                     <span class="n">watermum</span><span class="p">(</span><span class="nb">ieor</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">waterr32</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">:))),</span>           <span class="p">&amp;</span>
<a id="ln-170" name="ln-170"></a>                              <span class="nb">ieor</span><span class="p">(</span><span class="nb">ior</span><span class="p">(</span><span class="nb">ishft</span><span class="p">(</span><span class="n">waterr16</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">12</span><span class="p">:)),</span><span class="mi">8</span><span class="p">),</span> <span class="p">&amp;</span>
<a id="ln-171" name="ln-171"></a>                                       <span class="n">waterr08</span><span class="p">(</span><span class="n">key</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">14</span><span class="p">:))),</span>         <span class="p">&amp;</span>
<a id="ln-172" name="ln-172"></a>                                   <span class="n">waterp4</span><span class="p">)))</span>
<a id="ln-173" name="ln-173"></a>        <span class="k">end select</span>
<a id="ln-174" name="ln-174"></a>
<a id="ln-175" name="ln-175"></a><span class="k">        </span><span class="n">h</span> <span class="o">=</span> <span class="nb">ieor</span><span class="p">(</span> <span class="n">h</span><span class="p">,</span> <span class="nb">ishft</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="nb">ieor</span><span class="p">(</span> <span class="nb">len</span><span class="p">,</span> <span class="n">waterp0</span> <span class="p">)</span>
<a id="ln-176" name="ln-176"></a>        <span class="n">h</span> <span class="o">=</span> <span class="n">h</span> <span class="o">-</span> <span class="nb">ishft</span><span class="p">(</span> <span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span> <span class="p">)</span>
<a id="ln-177" name="ln-177"></a>        <span class="n">dummy</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<a id="ln-178" name="ln-178"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">little_endian</span><span class="p">)</span> <span class="k">then</span>
<a id="ln-179" name="ln-179"></a><span class="k">            </span><span class="n">hash_code</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="ln-180" name="ln-180"></a>        <span class="k">else</span>
<a id="ln-181" name="ln-181"></a><span class="k">            </span><span class="n">hash_code</span> <span class="o">=</span> <span class="n">dummy</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-182" name="ln-182"></a>        <span class="k">end if</span>
<a id="ln-183" name="ln-183"></a>
<a id="ln-184" name="ln-184"></a><span class="k">    contains</span>
<a id="ln-185" name="ln-185"></a>
<a id="ln-186" name="ln-186"></a><span class="k">        pure function </span><span class="n">watermum</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<a id="ln-187" name="ln-187"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>             <span class="kd">::</span> <span class="n">r</span>
<a id="ln-188" name="ln-188"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<a id="ln-189" name="ln-189"></a>
<a id="ln-190" name="ln-190"></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
<a id="ln-191" name="ln-191"></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="nb">ishft</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">)</span>
<a id="ln-192" name="ln-192"></a>
<a id="ln-193" name="ln-193"></a>        <span class="k">end function </span><span class="n">watermum</span>
<a id="ln-194" name="ln-194"></a>
<a id="ln-195" name="ln-195"></a>        <span class="k">pure function </span><span class="n">waterr08</span><span class="p">(</span> <span class="n">p</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="ln-196" name="ln-196"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">v</span>
<a id="ln-197" name="ln-197"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span>
<a id="ln-198" name="ln-198"></a>
<a id="ln-199" name="ln-199"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">little_endian</span><span class="p">)</span> <span class="k">then</span>
<a id="ln-200" name="ln-200"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span>       <span class="p">&amp;</span>
<a id="ln-201" name="ln-201"></a>                                <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-202" name="ln-202"></a>            <span class="k">else</span>
<a id="ln-203" name="ln-203"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span>   <span class="p">&amp;</span>
<a id="ln-204" name="ln-204"></a>                                <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-205" name="ln-205"></a>            <span class="k">end if</span>
<a id="ln-206" name="ln-206"></a>
<a id="ln-207" name="ln-207"></a><span class="k">        end function </span><span class="n">waterr08</span>
<a id="ln-208" name="ln-208"></a>
<a id="ln-209" name="ln-209"></a>        <span class="k">pure function </span><span class="n">waterr16</span><span class="p">(</span> <span class="n">p</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="ln-210" name="ln-210"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">v</span>
<a id="ln-211" name="ln-211"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span>
<a id="ln-212" name="ln-212"></a>
<a id="ln-213" name="ln-213"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">little_endian</span><span class="p">)</span> <span class="k">then</span>
<a id="ln-214" name="ln-214"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span>         <span class="p">&amp;</span>
<a id="ln-215" name="ln-215"></a>                                <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-216" name="ln-216"></a>            <span class="k">else</span>
<a id="ln-217" name="ln-217"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span>  <span class="p">&amp;</span>
<a id="ln-218" name="ln-218"></a>                                <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-219" name="ln-219"></a>            <span class="k">end if</span>
<a id="ln-220" name="ln-220"></a>
<a id="ln-221" name="ln-221"></a><span class="k">        end function </span><span class="n">waterr16</span>
<a id="ln-222" name="ln-222"></a>
<a id="ln-223" name="ln-223"></a>        <span class="k">pure function </span><span class="n">waterr32</span><span class="p">(</span> <span class="n">p</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<a id="ln-224" name="ln-224"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">v</span>
<a id="ln-225" name="ln-225"></a>            <span class="kt">integer</span><span class="p">(</span><span class="n">int8</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">p</span><span class="p">(:)</span>
<a id="ln-226" name="ln-226"></a>
<a id="ln-227" name="ln-227"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">little_endian</span><span class="p">)</span> <span class="k">then</span>
<a id="ln-228" name="ln-228"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>             <span class="p">&amp;</span>
<a id="ln-229" name="ln-229"></a>                                <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-230" name="ln-230"></a>            <span class="k">else</span>
<a id="ln-231" name="ln-231"></a><span class="k">                </span><span class="n">v</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="p">[</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="p">&amp;</span>
<a id="ln-232" name="ln-232"></a>                                <span class="n">p</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">p</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">],</span> <span class="n">v</span> <span class="p">)</span>
<a id="ln-233" name="ln-233"></a>            <span class="k">end if</span>
<a id="ln-234" name="ln-234"></a>
<a id="ln-235" name="ln-235"></a><span class="k">        end function </span><span class="n">waterr32</span>
<a id="ln-236" name="ln-236"></a>
<a id="ln-237" name="ln-237"></a>    <span class="k">end function </span><span class="n">int8_water_hash</span>
<a id="ln-238" name="ln-238"></a>
<a id="ln-239" name="ln-239"></a>
<a id="ln-240" name="ln-240"></a><span class="cp">#:for k1 in INT_KINDS</span>
<a id="ln-241" name="ln-241"></a>    <span class="k">pure module function</span> <span class="err">${</span><span class="n">k1</span><span class="err">}$_</span><span class="n">water_hash</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="n">seed</span> <span class="p">)</span> <span class="k">result</span><span class="p">(</span><span class="n">hash_code</span><span class="p">)</span>
<a id="ln-242" name="ln-242"></a>        <span class="kt">integer</span><span class="p">(</span><span class="err">${</span><span class="n">k1</span><span class="err">}$</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">key</span><span class="p">(:)</span>
<a id="ln-243" name="ln-243"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">seed</span>
<a id="ln-244" name="ln-244"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int_hash</span><span class="p">)</span>           <span class="kd">::</span> <span class="n">hash_code</span>
<a id="ln-245" name="ln-245"></a>
<a id="ln-246" name="ln-246"></a>        <span class="n">hash_code</span> <span class="o">=</span> <span class="n">int8_water_hash</span><span class="p">(</span> <span class="nb">transfer</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="p">&amp;</span>
<a id="ln-247" name="ln-247"></a>                     <span class="n">bytes_$</span><span class="err">{</span><span class="n">k1</span><span class="err">}$</span><span class="o">*</span><span class="n">size</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span> <span class="p">),</span> <span class="n">seed</span><span class="p">)</span>
<a id="ln-248" name="ln-248"></a>
<a id="ln-249" name="ln-249"></a>    <span class="k">end function</span> <span class="err">${</span><span class="n">k1</span><span class="err">}$_</span><span class="n">water_hash</span>
<a id="ln-250" name="ln-250"></a>
<a id="ln-251" name="ln-251"></a><span class="cp">#:endfor</span>
<a id="ln-252" name="ln-252"></a>
<a id="ln-253" name="ln-253"></a>    <span class="k">elemental module function </span><span class="n">character_water_hash</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="n">seed</span> <span class="p">)</span> <span class="p">&amp;</span>
<a id="ln-254" name="ln-254"></a>        <span class="k">result</span><span class="p">(</span><span class="n">hash_code</span><span class="p">)</span>
<a id="ln-255" name="ln-255"></a>        <span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">key</span>
<a id="ln-256" name="ln-256"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">seed</span>
<a id="ln-257" name="ln-257"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int_hash</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">hash_code</span>
<a id="ln-258" name="ln-258"></a>
<a id="ln-259" name="ln-259"></a>        <span class="n">hash_code</span> <span class="o">=</span> <span class="n">int8_water_hash</span><span class="p">(</span> <span class="nb">transfer</span><span class="p">(</span> <span class="n">key</span><span class="p">,</span> <span class="mi">0_int8</span><span class="p">,</span> <span class="p">&amp;</span>
<a id="ln-260" name="ln-260"></a>                     <span class="n">bytes_char</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">kind</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span> <span class="p">),</span> <span class="n">seed</span><span class="p">)</span>
<a id="ln-261" name="ln-261"></a>
<a id="ln-262" name="ln-262"></a>    <span class="k">end function </span><span class="n">character_water_hash</span>
<a id="ln-263" name="ln-263"></a>
<a id="ln-264" name="ln-264"></a>    <span class="k">module subroutine </span><span class="n">new_water_hash_seed</span><span class="p">(</span> <span class="n">seed</span> <span class="p">)</span>
<a id="ln-265" name="ln-265"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">seed</span>
<a id="ln-266" name="ln-266"></a>
<a id="ln-267" name="ln-267"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span> <span class="kd">::</span> <span class="n">old_seed</span>
<a id="ln-268" name="ln-268"></a>
<a id="ln-269" name="ln-269"></a>        <span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span> <span class="kd">::</span> <span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-270" name="ln-270"></a>        <span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span> <span class="kd">::</span> <span class="n">part</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="ln-271" name="ln-271"></a>
<a id="ln-272" name="ln-272"></a>        <span class="n">old_seed</span> <span class="o">=</span> <span class="n">seed</span>
<a id="ln-273" name="ln-273"></a>        <span class="n">find_seed</span><span class="p">:</span><span class="k">do</span>
<a id="ln-274" name="ln-274"></a><span class="k">            call </span><span class="nb">random_number</span><span class="p">(</span> <span class="n">sample</span> <span class="p">)</span>
<a id="ln-275" name="ln-275"></a>            <span class="n">part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="nb">floor</span><span class="p">(</span> <span class="n">sample</span> <span class="o">*</span> <span class="mi">2_int64</span><span class="o">**</span><span class="mi">32</span><span class="p">,</span> <span class="n">int64</span> <span class="p">)</span> <span class="o">-</span> <span class="mi">2_int64</span><span class="o">**</span><span class="mi">31</span><span class="p">,</span> <span class="p">&amp;</span>
<a id="ln-276" name="ln-276"></a>                <span class="n">int32</span> <span class="p">)</span>
<a id="ln-277" name="ln-277"></a>            <span class="n">seed</span> <span class="o">=</span> <span class="nb">transfer</span><span class="p">(</span> <span class="n">part</span><span class="p">,</span> <span class="n">seed</span> <span class="p">)</span>
<a id="ln-278" name="ln-278"></a>            <span class="k">if</span> <span class="p">(</span> <span class="n">seed</span> <span class="o">/=</span> <span class="n">old_seed</span> <span class="p">)</span> <span class="k">return</span>
<a id="ln-279" name="ln-279"></a><span class="k">        end do </span><span class="n">find_seed</span>
<a id="ln-280" name="ln-280"></a>
<a id="ln-281" name="ln-281"></a>    <span class="k">end subroutine </span><span class="n">new_water_hash_seed</span>
<a id="ln-282" name="ln-282"></a>
<a id="ln-283" name="ln-283"></a><span class="k">end submodule </span><span class="n">stdlib_hash_32bit_water</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2022 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
                                          <br /><small>15f3270</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2022-01-02 10:07  
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>