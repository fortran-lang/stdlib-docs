<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_dlasd1 &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_dlasd1
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.0% of total for procedures.">58 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_d.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_d.fypp.html'>stdlib_linalg_lapack_d.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_d.html'>stdlib_linalg_lapack_d</a></li>
     <li class="active">stdlib_dlasd1</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_dlasd1.html#src">stdlib_dlasd1</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine stdlib_dlasd1(nl, nr, sqre, d, alpha, beta, u, ldu, vt, ldvt, idxq, iwork, work, info)</h2>
    

    <p>DLASD1 computes the SVD of an upper bidiagonal N-by-M matrix B,
where N = NL + NR + 1 and M = N + SQRE. DLASD1 is called from DLASD0.
A related subroutine DLASD7 handles the case in which the singular
values (and the singular vectors in factored form) are desired.
DLASD1 computes the SVD as follows:
( D1(in)    0    0       0 )
B = U(in) * (   Z1<strong>T   a   Z2</strong>T    b ) * VT(in)
(   0       0   D2(in)   0 )
= U(out) * ( D(out) 0) * VT(out)
where Z<strong>T = (Z1</strong>T a Z2<strong>T b) = u</strong>T VT**T, and u is a vector of dimension M
with ALPHA and BETA in the NL+1 and NL+2 th entries and zeros
elsewhere; and the entry b is empty if SQRE = 0.
The left singular vectors of the original matrix are stored in U, and
the transpose of the right singular vectors are stored in VT, and the
singular values are in D.  The algorithm consists of three stages:
The first stage consists of deflating the size of the problem
when there are multiple singular values or when there are zeros in
the Z vector.  For each such occurrence the dimension of the
secular equation problem is reduced by one.  This stage is
performed by the routine DLASD2.
The second stage consists of calculating the updated
singular values. This is done by finding the square roots of the
roots of the secular equation via the routine DLASD4 (as called
by DLASD3). This routine also calculates the singular vectors of
the current problem.
The final stage consists of computing the updated singular vectors
directly using the updated singular values.  The singular vectors
for the current problem are multiplied with the singular vectors
from the overall problem.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-nl~8"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nl</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nr~8"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nr</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sqre~12"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sqre</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-d~148"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>d</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-alpha~25"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>alpha</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-beta~41"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>beta</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-u~26"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>u</strong>(ldu,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldu~25"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vt~18"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>vt</strong>(ldvt,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldvt~16"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldvt</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-idxq~5"></span>integer(kind=ilp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>idxq</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iwork~123"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~386"></span>real(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~500"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_dlasd1.html#src">stdlib_dlasd1</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">pure subroutine </span><span class="n">stdlib_dlasd1</span><span class="p">(</span><span class="w"> </span><span class="n">nl</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">sqre</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">vt</span><span class="p">,</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="n">idxq</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="c">!! DLASD1 computes the SVD of an upper bidiagonal N-by-M matrix B,</span>
<span class="w">     </span><span class="c">!! where N = NL + NR + 1 and M = N + SQRE. DLASD1 is called from DLASD0.</span>
<span class="w">     </span><span class="c">!! A related subroutine DLASD7 handles the case in which the singular</span>
<span class="w">     </span><span class="c">!! values (and the singular vectors in factored form) are desired.</span>
<span class="w">     </span><span class="c">!! DLASD1 computes the SVD as follows:</span>
<span class="w">     </span><span class="c">!! ( D1(in)    0    0       0 )</span>
<span class="w">     </span><span class="c">!! B = U(in) * (   Z1**T   a   Z2**T    b ) * VT(in)</span>
<span class="w">     </span><span class="c">!! (   0       0   D2(in)   0 )</span>
<span class="w">     </span><span class="c">!! = U(out) * ( D(out) 0) * VT(out)</span>
<span class="w">     </span><span class="c">!! where Z**T = (Z1**T a Z2**T b) = u**T VT**T, and u is a vector of dimension M</span>
<span class="w">     </span><span class="c">!! with ALPHA and BETA in the NL+1 and NL+2 th entries and zeros</span>
<span class="w">     </span><span class="c">!! elsewhere; and the entry b is empty if SQRE = 0.</span>
<span class="w">     </span><span class="c">!! The left singular vectors of the original matrix are stored in U, and</span>
<span class="w">     </span><span class="c">!! the transpose of the right singular vectors are stored in VT, and the</span>
<span class="w">     </span><span class="c">!! singular values are in D.  The algorithm consists of three stages:</span>
<span class="w">     </span><span class="c">!! The first stage consists of deflating the size of the problem</span>
<span class="w">     </span><span class="c">!! when there are multiple singular values or when there are zeros in</span>
<span class="w">     </span><span class="c">!! the Z vector.  For each such occurrence the dimension of the</span>
<span class="w">     </span><span class="c">!! secular equation problem is reduced by one.  This stage is</span>
<span class="w">     </span><span class="c">!! performed by the routine DLASD2.</span>
<span class="w">     </span><span class="c">!! The second stage consists of calculating the updated</span>
<span class="w">     </span><span class="c">!! singular values. This is done by finding the square roots of the</span>
<span class="w">     </span><span class="c">!! roots of the secular equation via the routine DLASD4 (as called</span>
<span class="w">     </span><span class="c">!! by DLASD3). This routine also calculates the singular vectors of</span>
<span class="w">     </span><span class="c">!! the current problem.</span>
<span class="w">     </span><span class="c">!! The final stage consists of computing the updated singular vectors</span>
<span class="w">     </span><span class="c">!! directly using the updated singular values.  The singular vectors</span>
<span class="w">     </span><span class="c">!! for the current problem are multiplied with the singular vectors</span>
<span class="w">     </span><span class="c">!! from the overall problem.</span>
<span class="w">               </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! -- lapack auxiliary routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"> </span><span class="n">nl</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">sqre</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idxq</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">ldu</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">vt</span><span class="p">(</span><span class="n">ldvt</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">coltyp</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">idx</span><span class="p">,</span><span class="w"> </span><span class="n">idxc</span><span class="p">,</span><span class="w"> </span><span class="n">idxp</span><span class="p">,</span><span class="w"> </span><span class="n">iq</span><span class="p">,</span><span class="w"> </span><span class="n">isigma</span><span class="p">,</span><span class="w"> </span><span class="n">iu2</span><span class="p">,</span><span class="w"> </span><span class="n">ivt2</span><span class="p">,</span><span class="w"> </span><span class="n">iz</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">ldq</span><span class="p">,</span><span class="w"> </span><span class="n">ldu2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">ldvt2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">orgnrm</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span><span class="p">,</span><span class="nb">max</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="c">! test the input parameters.</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">nl</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sqre</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sqre</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;DLASD1&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="k">           </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sqre</span>
<span class="w">           </span><span class="c">! the following values are for bookkeeping purposes only.  they are</span>
<span class="w">           </span><span class="c">! integer pointers which indicate the portion of the workspace</span>
<span class="w">           </span><span class="c">! used by a particular array in stdlib_dlasd2 and stdlib_dlasd3.</span>
<span class="w">           </span><span class="n">ldu2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">ldvt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">           </span><span class="n">iz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">isigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span>
<span class="w">           </span><span class="n">iu2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isigma</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">ivt2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iu2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldu2</span><span class="o">*</span><span class="n">n</span>
<span class="w">           </span><span class="n">iq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivt2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ldvt2</span><span class="o">*</span><span class="n">m</span>
<span class="w">           </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">idxc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">coltyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idxc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">idxp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coltyp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! scale.</span>
<span class="w">           </span><span class="n">orgnrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">nl</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="n">orgnrm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">orgnrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end do</span>
<span class="k">           call </span><span class="n">stdlib_dlascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">orgnrm</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">orgnrm</span>
<span class="w">           </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">orgnrm</span>
<span class="w">           </span><span class="c">! deflate singular values.</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_dlasd2</span><span class="p">(</span><span class="w"> </span><span class="n">nl</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">sqre</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">vt</span><span class="p">,</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(&amp;</span>
<span class="w">            </span><span class="n">isigma</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">iu2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldu2</span><span class="p">,</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">ivt2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldvt2</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">idxp</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="p">),</span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                      </span><span class="n">idxc</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">idxq</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">coltyp</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! solve secular equation and update singular vectors.</span>
<span class="w">           </span><span class="n">ldq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_dlasd3</span><span class="p">(</span><span class="w"> </span><span class="n">nl</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">sqre</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">iq</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldq</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">isigma</span><span class="w"> </span><span class="p">),</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">iu2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldu2</span><span class="p">,</span><span class="w"> </span><span class="n">vt</span><span class="p">,</span><span class="w"> </span><span class="n">ldvt</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">ivt2</span><span class="w"> </span><span class="p">),</span><span class="n">ldvt2</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">idxc</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">coltyp</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">iz</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                     </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! report the convergence failure.</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! unscale.</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_dlascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">orgnrm</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! prepare the idxq sorting permutation.</span>
<span class="w">           </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span>
<span class="w">           </span><span class="n">n2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_dlamrg</span><span class="p">(</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n2</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">idxq</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_dlasd1</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>f53ad6b</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-04 11:23            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>