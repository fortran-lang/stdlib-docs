<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_zhgeqz &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_zhgeqz
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">360 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_z.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_z.fypp.html'>stdlib_linalg_lapack_z.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_z.html'>stdlib_linalg_lapack_z</a></li>
     <li class="active">stdlib_zhgeqz</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_zhgeqz.html#src">stdlib_zhgeqz</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine stdlib_zhgeqz(job, compq, compz, n, ilo, ihi, h, ldh, t, ldt, alpha, beta, q, ldq, z, ldz, work, lwork, rwork, info)</h2>
    

    <p>ZHGEQZ computes the eigenvalues of a complex matrix pair (H,T),
where H is an upper Hessenberg matrix and T is upper triangular,
using the single-shift QZ method.
Matrix pairs of this type are produced by the reduction to
generalized upper Hessenberg form of a complex matrix pair (A,B):
A = Q1<em>H</em>Z1<strong>H,  B = Q1<em>T</em>Z1</strong>H,
as computed by ZGGHRD.
If JOB='S', then the Hessenberg-triangular pair (H,T) is
also reduced to generalized Schur form,
H = Q<em>S</em>Z<strong>H,  T = Q<em>P</em>Z</strong>H,
where Q and Z are unitary matrices and S and P are upper triangular.
Optionally, the unitary matrix Q from the generalized Schur
factorization may be postmultiplied into an input matrix Q1, and the
unitary matrix Z may be postmultiplied into an input matrix Z1.
If Q1 and Z1 are the unitary matrices from ZGGHRD that reduced
the matrix pair (A,B) to generalized Hessenberg form, then the output
matrices Q1<em>Q and Z1</em>Z are the unitary factors from the generalized
Schur factorization of (A,B):
A = (Q1<em>Q)</em>S<em>(Z1</em>Z)<strong>H,  B = (Q1<em>Q)</em>P<em>(Z1</em>Z)</strong>H.
To avoid overflow, eigenvalues of the matrix pair (H,T)
(equivalently, of (A,B)) are computed as a pair of complex values
(alpha,beta).  If beta is nonzero, lambda = alpha / beta is an
eigenvalue of the generalized nonsymmetric eigenvalue problem (GNEP)
A<em>x = lambda</em>B<em>x
and if alpha is nonzero, mu = beta / alpha is an eigenvalue of the
alternate form of the GNEP
mu</em>A<em>y = B</em>y.
The values of alpha and beta for the i-th eigenvalue can be read
directly from the generalized Schur form:  alpha = S(i,i),
beta = P(i,i).
Ref: C.B. Moler
Eigenvalue Problems", SIAM J. Numer. Anal., 10(1973),
pp. 241--256.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-job~39"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>job</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-compq~20"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>compq</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-compz~24"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>compz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n~1504"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ilo~72"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ilo</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ihi~75"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ihi</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h~42"></span>complex(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>h</strong>(ldh,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldh~38"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldh</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-t~139"></span>complex(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>t</strong>(ldt,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldt~121"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldt</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-alpha~102"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>alpha</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-beta~98"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>beta</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-q~118"></span>complex(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>q</strong>(ldq,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldq~85"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldq</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-z~193"></span>complex(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(ldz,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldz~140"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~907"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lwork~427"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rwork~156"></span>real(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>rwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~1208"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_zhgeqz.html#src">stdlib_zhgeqz</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">subroutine </span><span class="n">stdlib_zhgeqz</span><span class="p">(</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="n">compq</span><span class="p">,</span><span class="w"> </span><span class="n">compz</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="p">,</span><span class="w"> </span><span class="n">ihi</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">beta</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">ldq</span><span class="p">,&amp;</span>
<span class="w">     </span><span class="c">!! ZHGEQZ computes the eigenvalues of a complex matrix pair (H,T),</span>
<span class="w">     </span><span class="c">!! where H is an upper Hessenberg matrix and T is upper triangular,</span>
<span class="w">     </span><span class="c">!! using the single-shift QZ method.</span>
<span class="w">     </span><span class="c">!! Matrix pairs of this type are produced by the reduction to</span>
<span class="w">     </span><span class="c">!! generalized upper Hessenberg form of a complex matrix pair (A,B):</span>
<span class="w">     </span><span class="c">!! A = Q1*H*Z1**H,  B = Q1*T*Z1**H,</span>
<span class="w">     </span><span class="c">!! as computed by ZGGHRD.</span>
<span class="w">     </span><span class="c">!! If JOB=&#39;S&#39;, then the Hessenberg-triangular pair (H,T) is</span>
<span class="w">     </span><span class="c">!! also reduced to generalized Schur form,</span>
<span class="w">     </span><span class="c">!! H = Q*S*Z**H,  T = Q*P*Z**H,</span>
<span class="w">     </span><span class="c">!! where Q and Z are unitary matrices and S and P are upper triangular.</span>
<span class="w">     </span><span class="c">!! Optionally, the unitary matrix Q from the generalized Schur</span>
<span class="w">     </span><span class="c">!! factorization may be postmultiplied into an input matrix Q1, and the</span>
<span class="w">     </span><span class="c">!! unitary matrix Z may be postmultiplied into an input matrix Z1.</span>
<span class="w">     </span><span class="c">!! If Q1 and Z1 are the unitary matrices from ZGGHRD that reduced</span>
<span class="w">     </span><span class="c">!! the matrix pair (A,B) to generalized Hessenberg form, then the output</span>
<span class="w">     </span><span class="c">!! matrices Q1*Q and Z1*Z are the unitary factors from the generalized</span>
<span class="w">     </span><span class="c">!! Schur factorization of (A,B):</span>
<span class="w">     </span><span class="c">!! A = (Q1*Q)*S*(Z1*Z)**H,  B = (Q1*Q)*P*(Z1*Z)**H.</span>
<span class="w">     </span><span class="c">!! To avoid overflow, eigenvalues of the matrix pair (H,T)</span>
<span class="w">     </span><span class="c">!! (equivalently, of (A,B)) are computed as a pair of complex values</span>
<span class="w">     </span><span class="c">!! (alpha,beta).  If beta is nonzero, lambda = alpha / beta is an</span>
<span class="w">     </span><span class="c">!! eigenvalue of the generalized nonsymmetric eigenvalue problem (GNEP)</span>
<span class="w">     </span><span class="c">!! A*x = lambda*B*x</span>
<span class="w">     </span><span class="c">!! and if alpha is nonzero, mu = beta / alpha is an eigenvalue of the</span>
<span class="w">     </span><span class="c">!! alternate form of the GNEP</span>
<span class="w">     </span><span class="c">!! mu*A*y = B*y.</span>
<span class="w">     </span><span class="c">!! The values of alpha and beta for the i-th eigenvalue can be read</span>
<span class="w">     </span><span class="c">!! directly from the generalized Schur form:  alpha = S(i,i),</span>
<span class="w">     </span><span class="c">!! beta = P(i,i).</span>
<span class="w">     </span><span class="c">!! Ref: C.B. Moler</span>
<span class="w">     </span><span class="c">!! Eigenvalue Problems&quot;, SIAM J. Numer. Anal., 10(1973),</span>
<span class="w">     </span><span class="c">!! pp. 241--256.</span>
<span class="w">                </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! -- lapack computational routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">compq</span><span class="p">,</span><span class="w"> </span><span class="n">compz</span><span class="p">,</span><span class="w"> </span><span class="n">job</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ihi</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="p">,</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">ldq</span><span class="p">,</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alpha</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">beta</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">ldh</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="n">ldq</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="n">ldt</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="n">ldz</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">logical</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ilazr2</span><span class="p">,</span><span class="w"> </span><span class="n">ilazro</span><span class="p">,</span><span class="w"> </span><span class="n">ilq</span><span class="p">,</span><span class="w"> </span><span class="n">ilschr</span><span class="p">,</span><span class="w"> </span><span class="n">ilz</span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icompq</span><span class="p">,</span><span class="w"> </span><span class="n">icompz</span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="p">,</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">iiter</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilastm</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">ischur</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jiter</span><span class="p">,</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">maxit</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">absb</span><span class="p">,</span><span class="w"> </span><span class="n">anorm</span><span class="p">,</span><span class="w"> </span><span class="n">ascale</span><span class="p">,</span><span class="w"> </span><span class="n">atol</span><span class="p">,</span><span class="w"> </span><span class="n">bnorm</span><span class="p">,</span><span class="w"> </span><span class="n">bscale</span><span class="p">,</span><span class="w"> </span><span class="n">btol</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">tempr</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abi22</span><span class="p">,</span><span class="w"> </span><span class="n">ad11</span><span class="p">,</span><span class="w"> </span><span class="n">ad12</span><span class="p">,</span><span class="w"> </span><span class="n">ad21</span><span class="p">,</span><span class="w"> </span><span class="n">ad22</span><span class="p">,</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">ctemp2</span><span class="p">,</span><span class="w"> </span><span class="n">ctemp3</span><span class="p">,</span><span class="w"> </span><span class="n">eshift</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">shift</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">u12</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">abi12</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span><span class="nb">cmplx</span><span class="p">,</span><span class="nb">conjg</span><span class="p">,</span><span class="nb">aimag</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="nb">min</span><span class="p">,</span><span class="nb">sqrt</span>
<span class="w">           </span><span class="c">! Statement Functions </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abs1</span>
<span class="w">           </span><span class="c">! Statement Function Definitions </span>
<span class="w">           </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="nb">aimag</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="c">! decode job, compq, compz</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">              </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">job</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">ilschr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">ischur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compq</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compq</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compq</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">ilq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">compz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">ilz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="n">icompz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! check argument values</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lwork</span><span class="o">==-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ischur</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">icompq</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">icompz</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ilo</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ihi</span><span class="o">&gt;</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">ihi</span><span class="o">&lt;</span><span class="n">ilo</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ldh</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ldt</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ldq</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldq</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">14</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">ldz</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldz</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">16</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">lwork</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">18</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;ZHGEQZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           else if</span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! quick return if possible</span>
<span class="w">           </span><span class="c">! work( 1 ) = cmplx( 1,KIND=dp)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cmplx</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! initialize q and z</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">icompq</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;FULL&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">ldq</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">icompz</span><span class="o">==</span><span class="mi">3</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;FULL&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! machine constants</span>
<span class="w">           </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ihi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ilo</span>
<span class="w">           </span><span class="n">safmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">ulp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">anorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_zlanhs</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilo</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">bnorm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_zlanhs</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilo</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">atol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="o">*</span><span class="n">anorm</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">btol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="o">*</span><span class="n">bnorm</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">ascale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">anorm</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">bscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">bnorm</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! set eigenvalues ihi+1:n</span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ihi</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">              </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">absb</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              </span><span class="n">alpha</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">beta</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end do</span>
<span class="w">           </span><span class="c">! if ihi &lt; ilo, skip qz steps</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ihi</span><span class="o">&lt;</span><span class="n">ilo</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">190</span>
<span class="w">           </span><span class="c">! main qz iteration loop</span>
<span class="w">           </span><span class="c">! initialize dynamic indices</span>
<span class="w">           </span><span class="c">! eigenvalues ilast+1:n have been found.</span>
<span class="w">              </span><span class="c">! column operations modify rows ifrstm:whatever</span>
<span class="w">              </span><span class="c">! row operations modify columns whatever:ilastm</span>
<span class="w">           </span><span class="c">! if only eigenvalues are being computed, then</span>
<span class="w">              </span><span class="c">! ifrstm is the row of the last splitting row above row ilast;</span>
<span class="w">              </span><span class="c">! this is always at least ilo.</span>
<span class="w">           </span><span class="c">! iiter counts iterations since the last eigenvalue was found,</span>
<span class="w">              </span><span class="c">! to tell when to use an extraordinary shift.</span>
<span class="w">           </span><span class="c">! maxit is the maximum number of qz sweeps allowed.</span>
<span class="w">           </span><span class="n">ilast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ihi</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilo</span>
<span class="w">              </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ihi</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">           </span><span class="n">maxit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">ihi</span><span class="o">-</span><span class="n">ilo</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">loop_170</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">maxit</span>
<span class="w">              </span><span class="c">! check for too many iterations.</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">jiter</span><span class="o">&gt;</span><span class="n">maxit</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">180</span>
<span class="w">              </span><span class="c">! split the matrix if possible.</span>
<span class="w">              </span><span class="c">! two tests:</span>
<span class="w">                 </span><span class="c">! 1: h(j,j-1)=0  or  j=ilo</span>
<span class="w">                 </span><span class="c">! 2: t(j,j)=0</span>
<span class="w">              </span><span class="c">! special case: j=ilast</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">==</span><span class="n">ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">60</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                    </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">60</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                 </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">50</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! general case: j&lt;ilast</span>
<span class="w">              </span><span class="n">loop_40</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                 </span><span class="c">! test 1: for h(j,j-1)=0 or j=ilo</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">==</span><span class="n">ilo</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    if</span><span class="p">(</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">ulp</span><span class="o">*</span><span class="p">(</span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                       </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">ilazro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 end if</span>
<span class="w">                 </span><span class="c">! test 2: for t(j,j)=0</span>
<span class="w">                 </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ilo</span><span class="w"> </span><span class="p">)</span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">abs</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="n">ulp</span><span class="o">*</span><span class="n">temp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                    </span><span class="c">! test 1a: check for 2 consecutive small subdiagonals in a</span>
<span class="w">                    </span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">ilazro</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       if</span><span class="p">(</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">ascale</span><span class="o">*</span><span class="n">atol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="w">                    </span><span class="c">! if both tests pass (1</span>
<span class="w">                    </span><span class="c">! element of b in the block is zero, split a 1x1 block off</span>
<span class="w">                    </span><span class="c">! at the top. (i.e., at the j-th row/column) the leading</span>
<span class="w">                    </span><span class="c">! diagonal element of the remainder can also be zero, so</span>
<span class="w">                    </span><span class="c">! this may have to be done repeatedly.</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilazro</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">ilazr2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       do </span><span class="n">jch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                          </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="n">ldt</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(&amp;</span>
<span class="w">                                     </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilazr2</span><span class="w"> </span><span class="p">)</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">c</span>
<span class="w">                          </span><span class="n">ilazr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;=</span><span class="n">btol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                             if</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">60</span>
<span class="w">                             </span><span class="k">else</span>
<span class="k">                                </span><span class="n">ifirst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">70</span>
<span class="w">                             </span><span class="k">end if</span>
<span class="k">                          end if</span>
<span class="k">                          </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                       </span><span class="k">end do</span>
<span class="k">                       go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">50</span>
<span class="w">                    </span><span class="k">else</span>
<span class="w">                       </span><span class="c">! only test 2 passed -- chase the zero to t(ilast,ilast)</span>
<span class="w">                       </span><span class="c">! then process as in the case t(ilast,ilast)=0</span>
<span class="w">                       </span><span class="k">do </span><span class="n">jch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                          </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                          </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">&lt;</span><span class="n">ilastm</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldt</span><span class="p">,&amp;</span>
<span class="w">                                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldt</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilastm</span><span class="o">-</span><span class="n">jch</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(&amp;</span>
<span class="w">                                     </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                          </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,&amp;</span>
<span class="w">                                     </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jch</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                       </span><span class="k">end do</span>
<span class="k">                       go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">50</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 else if</span><span class="p">(</span><span class="w"> </span><span class="n">ilazro</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! only test 1 passed -- work on j:ilast</span>
<span class="w">                    </span><span class="n">ifirst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">70</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="w">                 </span><span class="c">! neither test passed -- try next j</span>
<span class="w">              </span><span class="k">end do </span><span class="n">loop_40</span>
<span class="w">              </span><span class="c">! (drop-through is &quot;impossible&quot;)</span>
<span class="w">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">210</span>
<span class="w">              </span><span class="c">! t(ilast,ilast)=0 -- clear h(ilast,ilast-1) to split off a</span>
<span class="w">              </span><span class="c">! 1x1 block.</span>
<span class="w">              </span><span class="mi">50</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zrot</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="c">! h(ilast,ilast-1)=0 -- standardize b, set alpha and beta</span>
<span class="w">              </span><span class="mi">60</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">absb</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              </span><span class="n">alpha</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">beta</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="c">! go to next block -- exit if finished.</span>
<span class="w">              </span><span class="n">ilast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">&lt;</span><span class="n">ilo</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">190</span>
<span class="w">              </span><span class="c">! reset counters</span>
<span class="w">              </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">ilastm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ifrstm</span><span class="o">&gt;</span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilo</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">160</span>
<span class="w">              </span><span class="c">! qz step</span>
<span class="w">              </span><span class="c">! this iteration only involves rows/columns ifirst:ilast.  we</span>
<span class="w">              </span><span class="c">! assume ifirst &lt; ilast, and that the diagonal of b is non-zero.</span>
<span class="w">              </span><span class="mi">70</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              </span><span class="n">iiter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iiter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">ifrstm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifirst</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! compute the shift.</span>
<span class="w">              </span><span class="c">! at this point, ifirst &lt; ilast, and the diagonal elements of</span>
<span class="w">              </span><span class="c">! t(ifirst:ilast,ifirst,ilast) are larger than btol (in</span>
<span class="w">              </span><span class="c">! magnitude)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iiter</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="o">/=</span><span class="n">iiter</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! the wilkinson shift (aep p.512_dp), i.e., the eigenvalue of</span>
<span class="w">                 </span><span class="c">! the bottom-right 2x2 block of a inv(b) which is nearest to</span>
<span class="w">                 </span><span class="c">! the bottom-right element.</span>
<span class="w">                 </span><span class="c">! we factor b as u*d, where u has unit diagonals, and</span>
<span class="w">                 </span><span class="c">! compute (a*inv(d))*inv(u).</span>
<span class="w">                 </span><span class="n">u12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">ad11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">ad21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">ad12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">ad22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">abi22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ad22</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u12</span><span class="o">*</span><span class="n">ad21</span>
<span class="w">                 </span><span class="n">abi12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ad12</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u12</span><span class="o">*</span><span class="n">ad11</span>
<span class="w">                 </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abi22</span>
<span class="w">                 </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">abi12</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">ad21</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="o">/=</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">half</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">ad11</span><span class="o">-</span><span class="n">shift</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">temp2</span><span class="o">&gt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       if</span><span class="p">(</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp2</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="o">*</span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span><span class="o">+</span><span class="nb">aimag</span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">temp2</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="nb">aimag</span><span class="p">(</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="p">)&amp;</span>
<span class="w">                                 </span><span class="o">&lt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">y</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shift</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ctemp</span><span class="o">*</span><span class="n">stdlib_zladiv</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              else</span>
<span class="w">                 </span><span class="c">! exceptional shift.  chosen for no particularly good reason.</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iiter</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="mi">20</span><span class="o">==</span><span class="n">iiter</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="n">bscale</span><span class="o">*</span><span class="n">abs1</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">))</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="k">then</span>
<span class="k">                    </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                              </span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    </span><span class="n">eshift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="p">,</span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)&amp;</span>
<span class="w">                               </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 </span><span class="n">shift</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eshift</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! now check for two consecutive small subdiagonals.</span>
<span class="w">              </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                 </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span>
<span class="w">                 </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">shift</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">tempr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">tempr</span><span class="o">&lt;</span><span class="n">one</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">tempr</span><span class="o">/=</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tempr</span>
<span class="w">                    </span><span class="n">temp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tempr</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">abs1</span><span class="p">(</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">temp2</span><span class="o">&lt;=</span><span class="n">temp</span><span class="o">*</span><span class="n">atol</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">90</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">              </span><span class="n">istart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifirst</span>
<span class="w">              </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">ifirst</span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="n">shift</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">bscale</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">ifirst</span><span class="p">,</span><span class="w"> </span><span class="n">ifirst</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="mi">90</span><span class="w"> </span><span class="k">continue</span>
<span class="w">              </span><span class="c">! do an implicit-shift qz sweep.</span>
<span class="w">              </span><span class="c">! initial q</span>
<span class="w">              </span><span class="n">ctemp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ascale</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">istart</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">istart</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">ctemp2</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">ctemp3</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="c">! sweep</span>
<span class="w">              </span><span class="n">loop_150</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">istart</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">istart</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 do </span><span class="n">jc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ilastm</span>
<span class="w">                    </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span>
<span class="w">                    </span><span class="n">ctemp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jc</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp2</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">ilq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    do </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">q</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end if</span>
<span class="k">                 </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_zlartg</span><span class="p">(</span><span class="w"> </span><span class="n">ctemp</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                 </span><span class="k">do </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">ilast</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 do </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifrstm</span><span class="p">,</span><span class="w"> </span><span class="n">j</span>
<span class="w">                    </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    do </span><span class="n">jr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">ctemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="n">jr</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctemp</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end if</span>
<span class="k">              end do </span><span class="n">loop_150</span>
<span class="w">              </span><span class="mi">160</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           end do </span><span class="n">loop_170</span>
<span class="w">           </span><span class="c">! drop-through = non-convergence</span>
<span class="w">           </span><span class="mi">180</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ilast</span>
<span class="w">           </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">210</span>
<span class="w">           </span><span class="c">! successful completion of all qz steps</span>
<span class="w">           </span><span class="mi">190</span><span class="w"> </span><span class="k">continue</span>
<span class="w">           </span><span class="c">! set eigenvalues 1:ilo-1</span>
<span class="w">           </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ilo</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">absb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">absb</span><span class="o">&gt;</span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">signbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">absb</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absb</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">ilschr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">ilz</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zscal</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">signbc</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              </span><span class="n">alpha</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">beta</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end do</span>
<span class="w">           </span><span class="c">! normal termination</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="c">! exit (other than argument error) -- return optimal workspace size</span>
<span class="w">           </span><span class="mi">210</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cmplx</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_zhgeqz</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>f53ad6b</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-04 11:23            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>