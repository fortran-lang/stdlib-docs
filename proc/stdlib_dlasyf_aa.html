<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_dlasyf_aa &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_dlasyf_aa
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">136 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_d.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_d.fypp.html'>stdlib_linalg_lapack_d.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_d.html'>stdlib_linalg_lapack_d</a></li>
     <li class="active">stdlib_dlasyf_aa</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_dlasyf_aa.html#src">stdlib_dlasyf_aa</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine stdlib_dlasyf_aa(uplo, j1, m, nb, a, lda, ipiv, h, ldh, work)</h2>
    

    <p>DLATRF_AA factorizes a panel of a real symmetric matrix A using
the Aasen's algorithm. The panel consists of a set of NB rows of A
when UPLO is U, or a set of NB columns when UPLO is L.
In order to factorize the panel, the Aasen's algorithm requires the
last row, or column, of the previous panel. The first row, or column,
of A is set to be the first row, or column, of an identity matrix,
which is used to factorize the first panel.
The resulting J-th row of U, or J-th column of L, is stored in the
(J-1)-th row, or column, of A (without the unit diagonals), while
the diagonal and subdiagonal of A are overwritten by those of T.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-uplo~177"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>uplo</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-j1~5"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>j1</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-m~251"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nb~30"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nb</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~365"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong>(lda,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lda~338"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lda</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ipiv~95"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ipiv</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h~28"></span>real(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>h</strong>(ldh,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldh~24"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldh</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~395"></span>real(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(*)</td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_dlasyf_aa.html#src">stdlib_dlasyf_aa</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">pure subroutine </span><span class="n">stdlib_dlasyf_aa</span><span class="p">(</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ipiv</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="p">)</span>
<span class="w">     </span><span class="c">!! DLATRF_AA factorizes a panel of a real symmetric matrix A using</span>
<span class="w">     </span><span class="c">!! the Aasen&#39;s algorithm. The panel consists of a set of NB rows of A</span>
<span class="w">     </span><span class="c">!! when UPLO is U, or a set of NB columns when UPLO is L.</span>
<span class="w">     </span><span class="c">!! In order to factorize the panel, the Aasen&#39;s algorithm requires the</span>
<span class="w">     </span><span class="c">!! last row, or column, of the previous panel. The first row, or column,</span>
<span class="w">     </span><span class="c">!! of A is set to be the first row, or column, of an identity matrix,</span>
<span class="w">     </span><span class="c">!! which is used to factorize the first panel.</span>
<span class="w">     </span><span class="c">!! The resulting J-th row of U, or J-th column of L, is stored in the</span>
<span class="w">     </span><span class="c">!! (J-1)-th row, or column, of A (without the unit diagonals), while</span>
<span class="w">     </span><span class="c">!! the diagonal and subdiagonal of A are overwritten by those of T.</span>
<span class="w">        </span><span class="c">! -- lapack computational routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">uplo</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ldh</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ipiv</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">ldh</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">mj</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">piv</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">max</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! k1 is the first column of the panel to be factorized</span>
<span class="w">           </span><span class="c">! i.e.,  k1 is 2 for the first block column, and 1 for the rest of the blocks</span>
<span class="w">           </span><span class="n">k1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">j1</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! .....................................................</span>
<span class="w">              </span><span class="c">! factorize a as u**t*d*u using the upper triangle of a</span>
<span class="w">              </span><span class="c">! .....................................................</span>
<span class="w">              </span><span class="mi">10</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">20</span>
<span class="w">              </span><span class="c">! k is the column to be factorized</span>
<span class="w">               </span><span class="c">! when being called from stdlib_dsytrf_aa,</span>
<span class="w">               </span><span class="c">! &gt; for the first block column, j1 is 1, hence j1+j-1 is j,</span>
<span class="w">               </span><span class="c">! &gt; for the rest of the columns, j1 is 2, and j1+j-1 is j+1,</span>
<span class="w">              </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">==</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! only need to compute t(j, j)</span>
<span class="w">                  </span><span class="n">mj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                  </span><span class="n">mj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! h(j:m, j) := a(j, j:m) - h(j:m, 1:(j-1)) * l(j1:(j-1), j),</span>
<span class="w">               </span><span class="c">! where h(j:m, j) has been initialized to be a(j, j:m)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! k is the column to be factorized</span>
<span class="w">               </span><span class="c">! &gt; for the first block column, k is j, skipping the first two</span>
<span class="w">                 </span><span class="c">! columns</span>
<span class="w">               </span><span class="c">! &gt; for the rest of the columns, k is j+1, skipping only the</span>
<span class="w">                 </span><span class="c">! first column</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_dgemv</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;NO TRANSPOSE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="n">k1</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,&amp;</span>
<span class="w">                           </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! copy h(i:m, i) into work</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">k1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! compute work := work - l(j-1, j:m) * t(j-1,j),</span>
<span class="w">                  </span><span class="c">! where a(j-1, j) stores t(j-1, j) and a(j-2, j:m) stores u(j-1, j:m)</span>
<span class="w">                 </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_daxpy</span><span class="p">(</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! set a(j, j) = t(j, j)</span>
<span class="w">              </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! compute work(2:m) = t(j, j) l(j, (j+1):m)</span>
<span class="w">                  </span><span class="c">! where a(j, j) stores t(j, j) and a(j-1, (j+1):m) stores u(j, (j+1):m)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_daxpy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="w">                 </span><span class="c">! find max(|work(2:m)|)</span>
<span class="w">                 </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_idamax</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">piv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="c">! apply symmetric pivot</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">i2</span><span class="o">/=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">piv</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! swap work(i1) and work(i2)</span>
<span class="w">                    </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piv</span>
<span class="w">                    </span><span class="c">! swap a(i1, i1+1:m) with a(i1+1:m, i2)</span>
<span class="w">                    </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">-</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                              </span>
<span class="w">                    </span><span class="c">! swap a(i1, i2+1:m) with a(i2, i2+1:m)</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                               </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="c">! swap a(i1, i1) with a(i2,i2)</span>
<span class="w">                    </span><span class="n">piv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piv</span>
<span class="w">                    </span><span class="c">! swap h(i1, 1:j1) with h(i2, 1:j1)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">ipiv</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i2</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                       </span><span class="c">! swap l(1:i1-1, i1) with l(1:i1-1, i2),</span>
<span class="w">                        </span><span class="c">! skipping the first column</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">-</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 else</span>
<span class="k">                    </span><span class="n">ipiv</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="w">                 </span><span class="c">! set a(j, j+1) = t(j, j+1)</span>
<span class="w">                 </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">nb</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! copy a(j+1:m, j+1) into h(j:m, j),</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="w">                 </span><span class="c">! compute l(j+2, j+1) = work( 3:m ) / t(j, j+1),</span>
<span class="w">                  </span><span class="c">! where a(j, j+1) = t(j, j+1) and a(j+2:m, j) = l(j+2:m, j+1)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">/=</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dscal</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       call </span><span class="n">stdlib_dlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;FULL&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 end if</span>
<span class="k">              end if</span>
<span class="k">              </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">10</span>
<span class="w">              </span><span class="mi">20</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           else</span>
<span class="w">              </span><span class="c">! .....................................................</span>
<span class="w">              </span><span class="c">! factorize a as l*d*l**t using the lower triangle of a</span>
<span class="w">              </span><span class="c">! .....................................................</span>
<span class="w">              </span><span class="mi">30</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">40</span>
<span class="w">              </span><span class="c">! k is the column to be factorized</span>
<span class="w">               </span><span class="c">! when being called from stdlib_dsytrf_aa,</span>
<span class="w">               </span><span class="c">! &gt; for the first block column, j1 is 1, hence j1+j-1 is j,</span>
<span class="w">               </span><span class="c">! &gt; for the rest of the columns, j1 is 2, and j1+j-1 is j+1,</span>
<span class="w">              </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">==</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! only need to compute t(j, j)</span>
<span class="w">                  </span><span class="n">mj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                  </span><span class="n">mj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! h(j:m, j) := a(j:m, j) - h(j:m, 1:(j-1)) * l(j, j1:(j-1))^t,</span>
<span class="w">               </span><span class="c">! where h(j:m, j) has been initialized to be a(j:m, j)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! k is the column to be factorized</span>
<span class="w">               </span><span class="c">! &gt; for the first block column, k is j, skipping the first two</span>
<span class="w">                 </span><span class="c">! columns</span>
<span class="w">               </span><span class="c">! &gt; for the rest of the columns, k is j+1, skipping only the</span>
<span class="w">                 </span><span class="c">! first column</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_dgemv</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;NO TRANSPOSE&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">-</span><span class="n">k1</span><span class="p">,</span><span class="o">-</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,&amp;</span>
<span class="w">                           </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! copy h(j:m, j) into work</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&gt;</span><span class="n">k1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! compute work := work - l(j:m, j-1) * t(j-1,j),</span>
<span class="w">                  </span><span class="c">! where a(j-1, j) = t(j-1, j) and a(j, j-2) = l(j, j-1)</span>
<span class="w">                 </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_daxpy</span><span class="p">(</span><span class="w"> </span><span class="n">mj</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! set a(j, j) = t(j, j)</span>
<span class="w">              </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! compute work(2:m) = t(j, j) l((j+1):m, j)</span>
<span class="w">                  </span><span class="c">! where a(j, j) = t(j, j) and a((j+1):m, j-1) = l((j+1):m, j)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_daxpy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="w">                 </span><span class="c">! find max(|work(2:m)|)</span>
<span class="w">                 </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_idamax</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">piv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="c">! apply symmetric pivot</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">i2</span><span class="o">/=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">piv</span><span class="o">/=</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! swap work(i1) and work(i2)</span>
<span class="w">                    </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piv</span>
<span class="w">                    </span><span class="c">! swap a(i1+1:m, i1) with a(i2, i1+1:m)</span>
<span class="w">                    </span><span class="n">i1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i1</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">i2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">-</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                              </span>
<span class="w">                    </span><span class="c">! swap a(i2+1:m, i1) with a(i2+1:m, i2)</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="c">! swap a(i1, i1) with a(i2, i2)</span>
<span class="w">                    </span><span class="n">piv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="n">j1</span><span class="o">+</span><span class="n">i2</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piv</span>
<span class="w">                    </span><span class="c">! swap h(i1, i1:j1) with h(i2, i2:j1)</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">ldh</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">ipiv</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i2</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">&gt;</span><span class="p">(</span><span class="n">k1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                       </span><span class="c">! swap l(1:i1-1, i1) with l(1:i1-1, i2),</span>
<span class="w">                        </span><span class="c">! skipping the first column</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dswap</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="o">-</span><span class="n">k1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">i2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 else</span>
<span class="k">                    </span><span class="n">ipiv</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="w">                 </span><span class="c">! set a(j+1, j) = t(j+1, j)</span>
<span class="w">                 </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="n">nb</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! copy a(j+1:m, j+1) into h(j+1:m, j),</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">h</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="w">                 </span><span class="c">! compute l(j+2, j+1) = work( 3:m ) / t(j, j+1),</span>
<span class="w">                  </span><span class="c">! where a(j, j+1) = t(j, j+1) and a(j+2:m, j) = l(j+2:m, j+1)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    if</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">)</span><span class="o">/=</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dcopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_dscal</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       call </span><span class="n">stdlib_dlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;FULL&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 end if</span>
<span class="k">              end if</span>
<span class="k">              </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">30</span>
<span class="w">              </span><span class="mi">40</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           end if</span>
<span class="k">           return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_dlasyf_aa</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>693986a</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-03 09:57            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>