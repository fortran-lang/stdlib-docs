<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_cheevr &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_cheevr
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">223 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_c.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_c.fypp.html'>stdlib_linalg_lapack_c.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_c.html'>stdlib_linalg_lapack_c</a></li>
     <li class="active">stdlib_cheevr</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_cheevr.html#src">stdlib_cheevr</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine stdlib_cheevr(jobz, range, uplo, n, a, lda, vl, vu, il, iu, abstol, m, w, z, ldz, isuppz, work, lwork, rwork, lrwork, iwork, liwork, info)</h2>
    

    <p>CHEEVR computes selected eigenvalues and, optionally, eigenvectors
of a complex Hermitian matrix A.  Eigenvalues and eigenvectors can
be selected by specifying either a range of values or a range of
indices for the desired eigenvalues.
CHEEVR first reduces the matrix A to tridiagonal form T with a call
to CHETRD.  Then, whenever possible, CHEEVR calls CSTEMR to compute
the eigenspectrum using Relatively Robust Representations.  CSTEMR
computes eigenvalues by the dqds algorithm, while orthogonal
eigenvectors are computed from various "good" L D L^T representations
(also known as Relatively Robust Representations). Gram-Schmidt
orthogonalization is avoided as far as possible. More specifically,
the various steps of the algorithm are as follows.
For each unreduced block (submatrix) of T,
(a) Compute T - sigma I  = L D L^T, so that L and D
define all the wanted eigenvalues to high relative accuracy.
This means that small relative changes in the entries of D and L
cause only small relative changes in the eigenvalues and
eigenvectors. The standard (unfactored) representation of the
tridiagonal matrix T does not have this property in general.
(b) Compute the eigenvalues to suitable accuracy.
If the eigenvectors are desired, the algorithm attains full
accuracy of the computed eigenvalues only right before
the corresponding vectors have to be computed, see steps c) and d).
(c) For each cluster of close eigenvalues, select a new
shift close to the cluster, find a new factorization, and refine
the shifted eigenvalues to suitable accuracy.
(d) For each eigenvalue with a large enough relative separation compute
the corresponding eigenvector by forming a rank revealing twisted
factorization. Go back to (c) for any clusters that remain.
The desired accuracy of the output can be specified by the input
parameter ABSTOL.
For more details, see CSTEMR's documentation and:
- Inderjit S. Dhillon and Beresford N. Parlett: "Multiple representations
to compute orthogonal eigenvectors of symmetric tridiagonal matrices,"
Linear Algebra and its Applications, 387(1), pp. 1-28, August 2004.
- Inderjit Dhillon and Beresford Parlett: "Orthogonal Eigenvectors and
Relative Gaps," SIAM Journal on Matrix Analysis and Applications, Vol. 25,
2004.  Also LAPACK Working Note 154.
- Inderjit Dhillon: "A new O(n^2) algorithm for the symmetric
tridiagonal eigenvalue/eigenvector problem",
Computer Science Division Technical Report No. UCB/CSD-97-971,
UC Berkeley, May 1997.
Note 1 : CHEEVR calls CSTEMR when the full spectrum is requested
on machines which conform to the ieee-754 floating point standard.
CHEEVR calls SSTEBZ and CSTEIN on non-ieee machines and
when partial spectrum requests are made.
Normal execution of CSTEMR may create NaNs and infinities and
hence may abort due to a floating point exception in environments
which do not handle NaNs and infinities in the ieee standard default
manner.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-jobz~62"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-range~31"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>range</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-uplo~339"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>uplo</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n~972"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~576"></span>complex(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong>(lda,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lda~543"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lda</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vl~68"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>vl</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vu~35"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>vu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-il~31"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>il</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iu~31"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-abstol~27"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>abstol</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-m~379"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-w~99"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>w</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-z~145"></span>complex(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(ldz,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldz~97"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldz</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-isuppz~13"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>isuppz</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~628"></span>complex(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lwork~286"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rwork~47"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>rwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lrwork~10"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lrwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iwork~188"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-liwork~40"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>liwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~827"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_cheevr.html#src">stdlib_cheevr</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">subroutine </span><span class="n">stdlib_cheevr</span><span class="p">(</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="n">abstol</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="c">!! CHEEVR computes selected eigenvalues and, optionally, eigenvectors</span>
<span class="w">     </span><span class="c">!! of a complex Hermitian matrix A.  Eigenvalues and eigenvectors can</span>
<span class="w">     </span><span class="c">!! be selected by specifying either a range of values or a range of</span>
<span class="w">     </span><span class="c">!! indices for the desired eigenvalues.</span>
<span class="w">     </span><span class="c">!! CHEEVR first reduces the matrix A to tridiagonal form T with a call</span>
<span class="w">     </span><span class="c">!! to CHETRD.  Then, whenever possible, CHEEVR calls CSTEMR to compute</span>
<span class="w">     </span><span class="c">!! the eigenspectrum using Relatively Robust Representations.  CSTEMR</span>
<span class="w">     </span><span class="c">!! computes eigenvalues by the dqds algorithm, while orthogonal</span>
<span class="w">     </span><span class="c">!! eigenvectors are computed from various &quot;good&quot; L D L^T representations</span>
<span class="w">     </span><span class="c">!! (also known as Relatively Robust Representations). Gram-Schmidt</span>
<span class="w">     </span><span class="c">!! orthogonalization is avoided as far as possible. More specifically,</span>
<span class="w">     </span><span class="c">!! the various steps of the algorithm are as follows.</span>
<span class="w">     </span><span class="c">!! For each unreduced block (submatrix) of T,</span>
<span class="w">     </span><span class="c">!! (a) Compute T - sigma I  = L D L^T, so that L and D</span>
<span class="w">     </span><span class="c">!! define all the wanted eigenvalues to high relative accuracy.</span>
<span class="w">     </span><span class="c">!! This means that small relative changes in the entries of D and L</span>
<span class="w">     </span><span class="c">!! cause only small relative changes in the eigenvalues and</span>
<span class="w">     </span><span class="c">!! eigenvectors. The standard (unfactored) representation of the</span>
<span class="w">     </span><span class="c">!! tridiagonal matrix T does not have this property in general.</span>
<span class="w">     </span><span class="c">!! (b) Compute the eigenvalues to suitable accuracy.</span>
<span class="w">     </span><span class="c">!! If the eigenvectors are desired, the algorithm attains full</span>
<span class="w">     </span><span class="c">!! accuracy of the computed eigenvalues only right before</span>
<span class="w">     </span><span class="c">!! the corresponding vectors have to be computed, see steps c) and d).</span>
<span class="w">     </span><span class="c">!! (c) For each cluster of close eigenvalues, select a new</span>
<span class="w">     </span><span class="c">!! shift close to the cluster, find a new factorization, and refine</span>
<span class="w">     </span><span class="c">!! the shifted eigenvalues to suitable accuracy.</span>
<span class="w">     </span><span class="c">!! (d) For each eigenvalue with a large enough relative separation compute</span>
<span class="w">     </span><span class="c">!! the corresponding eigenvector by forming a rank revealing twisted</span>
<span class="w">     </span><span class="c">!! factorization. Go back to (c) for any clusters that remain.</span>
<span class="w">     </span><span class="c">!! The desired accuracy of the output can be specified by the input</span>
<span class="w">     </span><span class="c">!! parameter ABSTOL.</span>
<span class="w">     </span><span class="c">!! For more details, see CSTEMR&#39;s documentation and:</span>
<span class="w">     </span><span class="c">!! - Inderjit S. Dhillon and Beresford N. Parlett: &quot;Multiple representations</span>
<span class="w">     </span><span class="c">!! to compute orthogonal eigenvectors of symmetric tridiagonal matrices,&quot;</span>
<span class="w">     </span><span class="c">!! Linear Algebra and its Applications, 387(1), pp. 1-28, August 2004.</span>
<span class="w">     </span><span class="c">!! - Inderjit Dhillon and Beresford Parlett: &quot;Orthogonal Eigenvectors and</span>
<span class="w">     </span><span class="c">!! Relative Gaps,&quot; SIAM Journal on Matrix Analysis and Applications, Vol. 25,</span>
<span class="w">     </span><span class="c">!! 2004.  Also LAPACK Working Note 154.</span>
<span class="w">     </span><span class="c">!! - Inderjit Dhillon: &quot;A new O(n^2) algorithm for the symmetric</span>
<span class="w">     </span><span class="c">!! tridiagonal eigenvalue/eigenvector problem&quot;,</span>
<span class="w">     </span><span class="c">!! Computer Science Division Technical Report No. UCB/CSD-97-971,</span>
<span class="w">     </span><span class="c">!! UC Berkeley, May 1997.</span>
<span class="w">     </span><span class="c">!! Note 1 : CHEEVR calls CSTEMR when the full spectrum is requested</span>
<span class="w">     </span><span class="c">!! on machines which conform to the ieee-754 floating point standard.</span>
<span class="w">     </span><span class="c">!! CHEEVR calls SSTEBZ and CSTEIN on non-ieee machines and</span>
<span class="w">     </span><span class="c">!! when partial spectrum requests are made.</span>
<span class="w">     </span><span class="c">!! Normal execution of CSTEMR may create NaNs and infinities and</span>
<span class="w">     </span><span class="c">!! hence may abort due to a floating point exception in environments</span>
<span class="w">     </span><span class="c">!! which do not handle NaNs and infinities in the ieee standard default</span>
<span class="w">     </span><span class="c">!! manner.</span>
<span class="w">               </span><span class="n">isuppz</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">lrwork</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">liwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! -- lapack driver routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">liwork</span><span class="p">,</span><span class="w"> </span><span class="n">lrwork</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abstol</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isuppz</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="n">ldz</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">       </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">logical</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">alleig</span><span class="p">,</span><span class="w"> </span><span class="n">indeig</span><span class="p">,</span><span class="w"> </span><span class="n">lower</span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="p">,</span><span class="w"> </span><span class="n">valeig</span><span class="p">,</span><span class="w"> </span><span class="n">wantz</span><span class="p">,</span><span class="w"> </span><span class="n">tryrac</span>
<span class="w">           </span><span class="kt">character</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">order</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ieeeok</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="p">,</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">indibl</span><span class="p">,</span><span class="w"> </span><span class="n">indifl</span><span class="p">,</span><span class="w"> </span><span class="n">indisp</span><span class="p">,</span><span class="w"> </span><span class="n">indiwo</span><span class="p">,</span><span class="w"> </span><span class="n">indrd</span><span class="p">,</span><span class="w"> </span><span class="n">indrdd</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">indre</span><span class="p">,</span><span class="w"> </span><span class="n">indree</span><span class="p">,</span><span class="w"> </span><span class="n">indrwk</span><span class="p">,</span><span class="w"> </span><span class="n">indtau</span><span class="p">,</span><span class="w"> </span><span class="n">indwk</span><span class="p">,</span><span class="w"> </span><span class="n">indwkn</span><span class="p">,</span><span class="w"> </span><span class="n">iscale</span><span class="p">,</span><span class="w"> </span><span class="n">itmp1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jj</span><span class="p">,</span><span class="w"> </span><span class="n">liwmin</span><span class="p">,</span><span class="w"> </span><span class="n">llwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">llrwork</span><span class="p">,</span><span class="w"> </span><span class="n">llwrkn</span><span class="p">,</span><span class="w"> </span><span class="n">lrwmin</span><span class="p">,</span><span class="w"> </span><span class="n">lwkopt</span><span class="p">,</span><span class="w"> </span><span class="n">lwmin</span><span class="p">,</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">nsplit</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">abstll</span><span class="p">,</span><span class="w"> </span><span class="n">anrm</span><span class="p">,</span><span class="w"> </span><span class="n">bignum</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">rmax</span><span class="p">,</span><span class="w"> </span><span class="n">rmin</span><span class="p">,</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">smlnum</span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span><span class="p">,</span><span class="w"> </span><span class="n">vll</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">vuu</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">max</span><span class="p">,</span><span class="nb">min</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span><span class="nb">sqrt</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="c">! test the input parameters.</span>
<span class="w">           </span><span class="n">ieeeok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_ilaenv</span><span class="p">(</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CHEEVR&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wantz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">alleig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">valeig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">indeig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lwork</span><span class="o">==-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lrwork</span><span class="o">==-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="n">liwork</span><span class="o">==-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lrwmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">liwmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lwmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">alleig</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">valeig</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">indeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">lda</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">valeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">vu</span><span class="o">&lt;=</span><span class="n">vl</span><span class="w"> </span><span class="p">)</span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span>
<span class="w">              </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">indeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">il</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">il</span><span class="o">&gt;</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span>
<span class="w">                 </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">iu</span><span class="o">&lt;</span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">iu</span><span class="o">&gt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">10</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">ldz</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldz</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">15</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_ilaenv</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CHETRD&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">nb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">nb</span><span class="p">,</span><span class="w"> </span><span class="n">stdlib_ilaenv</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CUNMTR&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">lwkopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nb</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">lwmin</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwkopt</span>
<span class="w">              </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrwmin</span>
<span class="w">              </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">liwmin</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">lwork</span><span class="o">&lt;</span><span class="n">lwmin</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">18</span>
<span class="w">              </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">lrwork</span><span class="o">&lt;</span><span class="n">lrwmin</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">20</span>
<span class="w">              </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">liwork</span><span class="o">&lt;</span><span class="n">liwmin</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">22</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;CHEEVR&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           else if</span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! quick return if possible</span>
<span class="w">           </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">alleig</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">indeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">vl</span><span class="o">&lt;</span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">vu</span><span class="o">&gt;=</span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">                    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                 </span><span class="n">isuppz</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">isuppz</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! get machine constants.</span>
<span class="w">           </span><span class="n">safmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_slamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;SAFE MINIMUM&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_slamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;PRECISION&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">smlnum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safmin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">eps</span>
<span class="w">           </span><span class="n">bignum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">smlnum</span>
<span class="w">           </span><span class="n">rmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">smlnum</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">rmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">bignum</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">safmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! scale matrix to allowable range, if necessary.</span>
<span class="w">           </span><span class="n">iscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="n">abstll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abstol</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valeig</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">vll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vl</span>
<span class="w">              </span><span class="n">vuu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vu</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">anrm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_clansy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">zero</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">anrm</span><span class="o">&lt;</span><span class="n">rmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">iscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rmin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">anrm</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">anrm</span><span class="o">&gt;</span><span class="n">rmax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">iscale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rmax</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">anrm</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">iscale</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_csscal</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">              else</span>
<span class="k">                 do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_csscal</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">              end if</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">abstol</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="n">abstll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abstol</span><span class="o">*</span><span class="n">sigma</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">valeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">vll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vl</span><span class="o">*</span><span class="n">sigma</span>
<span class="w">                 </span><span class="n">vuu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vu</span><span class="o">*</span><span class="n">sigma</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! initialize indices into workspaces.  note: the iwork indices are</span>
<span class="w">           </span><span class="c">! used only if stdlib_ssterf or stdlib_cstemr fail.</span>
<span class="w">           </span><span class="c">! work(indtau:indtau+n-1) stores the complex scalar factors of the</span>
<span class="w">           </span><span class="c">! elementary reflectors used in stdlib_chetrd.</span>
<span class="w">           </span><span class="n">indtau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! indwk is the starting offset of the remaining complex workspace,</span>
<span class="w">           </span><span class="c">! and llwork is the remaining complex workspace size.</span>
<span class="w">           </span><span class="n">indwk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtau</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">llwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">indwk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! rwork(indrd:indrd+n-1) stores the real tridiagonal&#39;s diagonal</span>
<span class="w">           </span><span class="c">! entries.</span>
<span class="w">           </span><span class="n">indrd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! rwork(indre:indre+n-1) stores the off-diagonal entries of the</span>
<span class="w">           </span><span class="c">! tridiagonal matrix from stdlib_chetrd.</span>
<span class="w">           </span><span class="n">indre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! rwork(indrdd:indrdd+n-1) is a copy of the diagonal entries over</span>
<span class="w">           </span><span class="c">! -written by stdlib_cstemr (the stdlib_ssterf path copies the diagonal to w).</span>
<span class="w">           </span><span class="n">indrdd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indre</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! rwork(indree:indree+n-1) is a copy of the off-diagonal entries over</span>
<span class="w">           </span><span class="c">! -written while computing the eigenvalues in stdlib_ssterf and stdlib_cstemr.</span>
<span class="w">           </span><span class="n">indree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indrdd</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! indrwk is the starting offset of the left-over real workspace, and</span>
<span class="w">           </span><span class="c">! llrwork is the remaining workspace size.</span>
<span class="w">           </span><span class="n">indrwk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indree</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="n">llrwork</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">indrwk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! iwork(indibl:indibl+m-1) corresponds to iblock in stdlib_sstebz and</span>
<span class="w">           </span><span class="c">! stores the block indices of each of the m&lt;=n eigenvalues.</span>
<span class="w">           </span><span class="n">indibl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! iwork(indisp:indisp+nsplit-1) corresponds to isplit in stdlib_sstebz and</span>
<span class="w">           </span><span class="c">! stores the starting and finishing indices of each block.</span>
<span class="w">           </span><span class="n">indisp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indibl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! iwork(indifl:indifl+n-1) stores the indices of eigenvectors</span>
<span class="w">           </span><span class="c">! that corresponding to eigenvectors that fail to converge in</span>
<span class="w">           </span><span class="c">! stdlib_sstein.  this information is discarded; if any fail, the driver</span>
<span class="w">           </span><span class="c">! returns info &gt; 0.</span>
<span class="w">           </span><span class="n">indifl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indisp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! indiwo is the offset of the remaining integer workspace.</span>
<span class="w">           </span><span class="n">indiwo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indifl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="c">! call stdlib_chetrd to reduce hermitian matrix to tridiagonal form.</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_chetrd</span><span class="p">(</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indre</span><span class="w"> </span><span class="p">),</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">indtau</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">indwk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">llwork</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! if all eigenvalues are desired</span>
<span class="w">           </span><span class="c">! then call stdlib_ssterf or stdlib_cstemr and stdlib_cunmtr.</span>
<span class="w">           </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">indeig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">il</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iu</span><span class="o">==</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">alleig</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">test</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ieeeok</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indre</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indree</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_ssterf</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indree</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indre</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indree</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrdd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">abstol</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">two</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">eps</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">tryrac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    </span><span class="n">tryrac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 call </span><span class="n">stdlib_cstemr</span><span class="p">(</span><span class="w"> </span><span class="n">jobz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrdd</span><span class="w"> </span><span class="p">),</span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indree</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                 </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">isuppz</span><span class="p">,</span><span class="w"> </span><span class="n">tryrac</span><span class="p">,</span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrwk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">llrwork</span><span class="p">,</span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">liwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span>
<span class="w">                 </span><span class="c">! apply unitary matrix used in reduction to tridiagonal</span>
<span class="w">                 </span><span class="c">! form to eigenvectors returned by stdlib_cstemr.</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">indwkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indwk</span>
<span class="w">                    </span><span class="n">llwrkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">indwkn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_cunmtr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">indtau</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(&amp;</span>
<span class="w">                               </span><span class="n">indwkn</span><span class="w"> </span><span class="p">),</span><span class="n">llwrkn</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">                 </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">30</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! otherwise, call stdlib_sstebz and, if eigenvectors are desired, stdlib_cstein.</span>
<span class="w">           </span><span class="c">! also call stdlib_sstebz and stdlib_cstein if stdlib_cstemr fails.</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;B&#39;</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;E&#39;</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           call </span><span class="n">stdlib_sstebz</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">vll</span><span class="p">,</span><span class="w"> </span><span class="n">vuu</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">abstll</span><span class="p">,</span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">indre</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nsplit</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indisp</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrwk</span><span class="w"> </span><span class="p">),</span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indiwo</span><span class="w"> </span><span class="p">)&amp;</span>
<span class="w">                     </span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_cstein</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrd</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indre</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">indisp</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">ldz</span><span class="p">,</span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="n">indrwk</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indiwo</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indifl</span><span class="w"> </span><span class="p">),</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="c">! apply unitary matrix used in reduction to tridiagonal</span>
<span class="w">              </span><span class="c">! form to eigenvectors returned by stdlib_cstein.</span>
<span class="w">              </span><span class="n">indwkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indwk</span>
<span class="w">              </span><span class="n">llwrkn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwork</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">indwkn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_cunmtr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">uplo</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">indtau</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">z</span><span class="p">,</span><span class="n">ldz</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">indwkn</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">llwrkn</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! if matrix was scaled, then rescale eigenvalues appropriately.</span>
<span class="w">           </span><span class="mi">30</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">iscale</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">imax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 </span><span class="n">imax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              call </span><span class="n">stdlib_sscal</span><span class="p">(</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! if eigenvalues are not in order, then sort them, along with</span>
<span class="w">           </span><span class="c">! eigenvectors.</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">wantz</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                 </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">do </span><span class="n">jj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;</span><span class="n">tmp1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jj</span>
<span class="w">                       </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">jj</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 end do</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">itmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp1</span>
<span class="w">                    </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="n">indibl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itmp1</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_cswap</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end do</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! set work(1) to optimal workspace size.</span>
<span class="w">           </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lwkopt</span>
<span class="w">           </span><span class="n">rwork</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lrwmin</span>
<span class="w">           </span><span class="n">iwork</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">liwmin</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_cheevr</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>693986a</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-03 09:57            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>