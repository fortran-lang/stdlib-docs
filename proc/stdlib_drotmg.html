<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_drotmg &ndash; Fortran-lang/stdlib</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Contributing and specs</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>stdlib_drotmg
      <small>Subroutine</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-license"><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip"
                 data-bs-placement="bottom" data-html="true"
                 title=" 0.6% of total for procedures.">133 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/stdlib_linalg_blas_d.fypp"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/stdlib_linalg_blas_d.fypp.html'>stdlib_linalg_blas_d.fypp</a></li>
                <li class="breadcrumb-item"><a href='../module/stdlib_linalg_blas_d.html'>stdlib_linalg_blas_d</a></li>
            <li class="breadcrumb-item active" aria-current="page">stdlib_drotmg</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-bs-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/stdlib_drotmg.html#src">stdlib_drotmg</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine stdlib_drotmg(dd1, dd2, dx1, dy1, dparam)  
</h2>
    

    <p>DROTMG Constructs the modified Givens transformation matrix <script type="math/tex">H</script> which zeros the 
second component of the 2-vector 
<script type="math/tex; mode=display"> \left[ {\sqrt{DD_1}\cdot DX_1,\sqrt{DD_2}\cdot DY_2} \right]^T. </script>
With DPARAM(1)=DFLAG, <script type="math/tex">H</script> has one of the following forms:        <br>
<script type="math/tex; mode=display"> H=\underbrace{\begin{bmatrix}DH_{11} & DH_{12}\\DH_{21} & DH_{22}\end{bmatrix}}_{DFLAG=-1},
     \underbrace{\begin{bmatrix}1 & DH_{12}\\DH_{21} & 1\end{bmatrix}}_{DFLAG=0}, 
     \underbrace{\begin{bmatrix}DH_{11} & 1\\-1 & DH_{22}\end{bmatrix}}_{DFLAG=1},  
     \underbrace{\begin{bmatrix}1 & 0\\0 & 1\end{bmatrix}}_{DFLAG=-2}. </script>
Locations 2-4 of DPARAM contain DH11, DH21, DH12 and DH22 respectively.
(Values of 1.0, -1.0, or 0.0 implied by the value of DPARAM(1) are not stored in DPARAM.)
The values of parameters GAMSQ and RGAMSQ may be inexact. This is OK as they are only 
used for testing the size of DD1 and DD2. All actual scaling of data is done using GAM.          </p>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-dd1"></span>
              real(kind=dp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dd1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dd2"></span>
              real(kind=dp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dd2</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dx1"></span>
              real(kind=dp),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dx1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dy1"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dy1</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-dparam~2"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>dparam</strong>(5)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="w">     </span><span class="k">pure subroutine </span><span class="n">stdlib_drotmg</span><span class="p">(</span><span class="n">dd1</span><span class="p">,</span><span class="n">dd2</span><span class="p">,</span><span class="n">dx1</span><span class="p">,</span><span class="n">dy1</span><span class="p">,</span><span class="n">dparam</span><span class="p">)</span>
<span class="w">     </span><span class="c">!! DROTMG Constructs the modified Givens transformation matrix \(H\) which zeros the </span>
<span class="w">     </span><span class="c">!! second component of the 2-vector </span>
<span class="w">     </span><span class="c">!! $$ \left[ {\sqrt{DD_1}\cdot DX_1,\sqrt{DD_2}\cdot DY_2} \right]^T. $$</span>
<span class="w">     </span><span class="c">!! With DPARAM(1)=DFLAG, \(H\) has one of the following forms:          </span>
<span class="w">     </span><span class="c">!! $$ H=\underbrace{\begin{bmatrix}DH_{11} &amp; DH_{12}\\DH_{21} &amp; DH_{22}\end{bmatrix}}_{DFLAG=-1},</span>
<span class="w">     </span><span class="c">!!      \underbrace{\begin{bmatrix}1 &amp; DH_{12}\\DH_{21} &amp; 1\end{bmatrix}}_{DFLAG=0}, </span>
<span class="w">     </span><span class="c">!!      \underbrace{\begin{bmatrix}DH_{11} &amp; 1\\-1 &amp; DH_{22}\end{bmatrix}}_{DFLAG=1},  </span>
<span class="w">     </span><span class="c">!!      \underbrace{\begin{bmatrix}1 &amp; 0\\0 &amp; 1\end{bmatrix}}_{DFLAG=-2}. $$</span>
<span class="w">     </span><span class="c">!! Locations 2-4 of DPARAM contain DH11, DH21, DH12 and DH22 respectively.</span>
<span class="w">     </span><span class="c">!! (Values of 1.0, -1.0, or 0.0 implied by the value of DPARAM(1) are not stored in DPARAM.)</span>
<span class="w">     </span><span class="c">!! The values of parameters GAMSQ and RGAMSQ may be inexact. This is OK as they are only </span>
<span class="w">     </span><span class="c">!! used for testing the size of DD1 and DD2. All actual scaling of data is done using GAM.          </span>
<span class="w">        </span><span class="c">! -- reference blas level1 routine --</span>
<span class="w">        </span><span class="c">! -- reference blas is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dd1</span><span class="p">,</span><span class="w"> </span><span class="n">dd2</span><span class="p">,</span><span class="w"> </span><span class="n">dx1</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dy1</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dparam</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dflag</span><span class="p">,</span><span class="w"> </span><span class="n">dh11</span><span class="p">,</span><span class="w"> </span><span class="n">dh12</span><span class="p">,</span><span class="w"> </span><span class="n">dh21</span><span class="p">,</span><span class="w"> </span><span class="n">dh22</span><span class="p">,</span><span class="w"> </span><span class="n">dp1</span><span class="p">,</span><span class="w"> </span><span class="n">dp2</span><span class="p">,</span><span class="w"> </span><span class="n">dq1</span><span class="p">,</span><span class="w"> </span><span class="n">dq2</span><span class="p">,</span><span class="w"> </span><span class="n">dtemp</span><span class="p">,</span><span class="w"> </span><span class="n">du</span><span class="p">,</span><span class="w"> </span><span class="n">gam</span><span class="p">,</span><span class="w"> </span><span class="n">gamsq</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">rgamsq</span><span class="p">,</span><span class="w"> </span><span class="n">two</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span>
<span class="w">           </span><span class="c">! Data Statements </span>
<span class="w">           </span><span class="n">zero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>
<span class="w">           </span><span class="n">one</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span>
<span class="w">           </span><span class="n">two</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0_dp</span>
<span class="w">           </span><span class="n">gam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">409</span><span class="mf">6.0_dp</span>
<span class="w">           </span><span class="n">gamsq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1677721</span><span class="mf">6.0_dp</span>
<span class="w">           </span><span class="n">rgamsq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.9604645e-8_dp</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dd1</span><span class="o">&lt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! go zero-h-d-and-dx1..</span>
<span class="w">              </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">              </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="k">else</span>
<span class="w">              </span><span class="c">! case-dd1-nonnegative</span>
<span class="w">              </span><span class="n">dp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd2</span><span class="o">*</span><span class="n">dy1</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dp2</span><span class="o">==</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">two</span>
<span class="w">                 </span><span class="n">dparam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dflag</span>
<span class="w">                 </span><span class="k">return</span>
<span class="k">              end if</span>
<span class="w">              </span><span class="c">! regular-case..</span>
<span class="w">              </span><span class="n">dp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd1</span><span class="o">*</span><span class="n">dx1</span>
<span class="w">              </span><span class="n">dq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp2</span><span class="o">*</span><span class="n">dy1</span>
<span class="w">              </span><span class="n">dq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp1</span><span class="o">*</span><span class="n">dx1</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dq1</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">abs</span><span class="p">(</span><span class="n">dq2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">dy1</span><span class="o">/</span><span class="n">dx1</span>
<span class="w">                 </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp2</span><span class="o">/</span><span class="n">dp1</span>
<span class="w">                 </span><span class="n">du</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dh12</span><span class="o">*</span><span class="n">dh21</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">du</span><span class="o">&gt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd1</span><span class="o">/</span><span class="n">du</span>
<span class="w">                  </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd2</span><span class="o">/</span><span class="n">du</span>
<span class="w">                  </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx1</span><span class="o">*</span><span class="n">du</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                  </span><span class="c">! this code path if here for safety. we do not expect this</span>
<span class="w">                  </span><span class="c">! condition to ever hold except in edge cases with rounding</span>
<span class="w">                  </span><span class="c">! errors. see doi: 10.1145/355841.355847</span>
<span class="w">                  </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                  </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                  </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                </span><span class="k">end if</span>
<span class="k">              else</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="n">dq2</span><span class="o">&lt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! go zero-h-d-and-dx1..</span>
<span class="w">                    </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                    </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                    </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp1</span><span class="o">/</span><span class="n">dp2</span>
<span class="w">                    </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx1</span><span class="o">/</span><span class="n">dy1</span>
<span class="w">                    </span><span class="n">du</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dh11</span><span class="o">*</span><span class="n">dh22</span>
<span class="w">                    </span><span class="n">dtemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd2</span><span class="o">/</span><span class="n">du</span>
<span class="w">                    </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd1</span><span class="o">/</span><span class="n">du</span>
<span class="w">                    </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dtemp</span>
<span class="w">                    </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dy1</span><span class="o">*</span><span class="n">du</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="w">           </span><span class="c">! procedure..scale-check</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dd1</span><span class="o">/=</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 do while</span><span class="w"> </span><span class="p">((</span><span class="n">dd1</span><span class="o">&lt;=</span><span class="n">rgamsq</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">dd1</span><span class="o">&gt;=</span><span class="n">gamsq</span><span class="p">))</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dflag</span><span class="o">==</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                       </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">dd1</span><span class="o">&lt;=</span><span class="n">rgamsq</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd1</span><span class="o">*</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
<span class="w">                       </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx1</span><span class="o">/</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh11</span><span class="o">/</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh12</span><span class="o">/</span><span class="n">gam</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">dd1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd1</span><span class="o">/</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
<span class="w">                       </span><span class="n">dx1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx1</span><span class="o">*</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh11</span><span class="o">*</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh12</span><span class="o">*</span><span class="n">gam</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 enddo</span>
<span class="k">              end if</span>
<span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">dd2</span><span class="o">/=</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 do while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dd2</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">rgamsq</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dd2</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">gamsq</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dflag</span><span class="o">==</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">dh11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                       </span><span class="n">dh12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                       </span><span class="n">dflag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">dd2</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">rgamsq</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd2</span><span class="o">*</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
<span class="w">                       </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh21</span><span class="o">/</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh22</span><span class="o">/</span><span class="n">gam</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">dd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd2</span><span class="o">/</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
<span class="w">                       </span><span class="n">dh21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh21</span><span class="o">*</span><span class="n">gam</span>
<span class="w">                       </span><span class="n">dh22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh22</span><span class="o">*</span><span class="n">gam</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 end do</span>
<span class="k">              end if</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="w"> </span><span class="p">(</span><span class="n">dflag</span><span class="o">&lt;</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh11</span>
<span class="w">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh21</span>
<span class="w">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh12</span>
<span class="w">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh22</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">dflag</span><span class="o">==</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh21</span>
<span class="w">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh12</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh11</span>
<span class="w">              </span><span class="n">dparam</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dh22</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">dparam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dflag</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_drotmg</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>f44133b</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-25 16:47              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>    

    <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>