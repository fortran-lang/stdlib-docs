<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_slarre &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_slarre
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">353 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_s.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_s.fypp.html'>stdlib_linalg_lapack_s.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_s.html'>stdlib_linalg_lapack_s</a></li>
     <li class="active">stdlib_slarre</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_slarre.html#src">stdlib_slarre</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine stdlib_slarre(range, n, vl, vu, il, iu, d, e, e2, rtol1, rtol2, spltol, nsplit, isplit, m, w, werr, wgap, iblock, indexw, gers, pivmin, work, iwork, info)</h2>
    

    <p>To find the desired eigenvalues of a given real symmetric
tridiagonal matrix T, SLARRE: sets any "small" off-diagonal
elements to zero, and for each unreduced block T_i, it finds
(a) a suitable shift at one end of the block's spectrum,
(b) the base representation, T_i - sigma_i I = L_i D_i L_i^T, and
(c) eigenvalues of each L_i D_i L_i^T.
The representations and eigenvalues found are then used by
SSTEMR to compute the eigenvectors of T.
The accuracy varies depending on whether bisection is used to
find a few eigenvalues or the dqds algorithm (subroutine SLASQ2) to
conpute all and then discard any unwanted one.
As an added benefit, SLARRE also outputs the n
Gerschgorin intervals for the matrices L_i D_i L_i^T.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-range~2"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>range</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n~186"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vl~9"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>vl</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-vu~3"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>vu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-il~2"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>il</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iu~2"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-d~48"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>d</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-e~14"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>e</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-e2~4"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>e2</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rtol1~2"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>rtol1</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rtol2~2"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>rtol2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-spltol~2"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>spltol</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nsplit~3"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nsplit</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-isplit~3"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>isplit</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-m~79"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-w~10"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>w</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-werr~3"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>werr</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-wgap~2"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>wgap</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iblock~2"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iblock</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-indexw~2"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>indexw</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-gers~2"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>gers</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pivmin~7"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>pivmin</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~114"></span>real(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iwork~31"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~135"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_slarre.html#src">stdlib_slarre</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">pure subroutine </span><span class="n">stdlib_slarre</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="n">rtol1</span><span class="p">,</span><span class="w"> </span><span class="n">rtol2</span><span class="p">,</span><span class="w"> </span><span class="n">spltol</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="c">!! To find the desired eigenvalues of a given real symmetric</span>
<span class="w">     </span><span class="c">!! tridiagonal matrix T, SLARRE: sets any &quot;small&quot; off-diagonal</span>
<span class="w">     </span><span class="c">!! elements to zero, and for each unreduced block T_i, it finds</span>
<span class="w">     </span><span class="c">!! (a) a suitable shift at one end of the block&#39;s spectrum,</span>
<span class="w">     </span><span class="c">!! (b) the base representation, T_i - sigma_i I = L_i D_i L_i^T, and</span>
<span class="w">     </span><span class="c">!! (c) eigenvalues of each L_i D_i L_i^T.</span>
<span class="w">     </span><span class="c">!! The representations and eigenvalues found are then used by</span>
<span class="w">     </span><span class="c">!! SSTEMR to compute the eigenvectors of T.</span>
<span class="w">     </span><span class="c">!! The accuracy varies depending on whether bisection is used to</span>
<span class="w">     </span><span class="c">!! find a few eigenvalues or the dqds algorithm (subroutine SLASQ2) to</span>
<span class="w">     </span><span class="c">!! conpute all and then discard any unwanted one.</span>
<span class="w">     </span><span class="c">!! As an added benefit, SLARRE also outputs the n</span>
<span class="w">     </span><span class="c">!! Gerschgorin intervals for the matrices L_i D_i L_i^T.</span>
<span class="w">               </span><span class="n">nsplit</span><span class="p">,</span><span class="w"> </span><span class="n">isplit</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">werr</span><span class="p">,</span><span class="w"> </span><span class="n">wgap</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">indexw</span><span class="p">,</span><span class="w"> </span><span class="n">gers</span><span class="p">,</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! -- lapack auxiliary routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">range</span>
<span class="nb">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">nsplit</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pivmin</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rtol1</span><span class="p">,</span><span class="w"> </span><span class="n">rtol2</span><span class="p">,</span><span class="w"> </span><span class="n">spltol</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iblock</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">isplit</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">indexw</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">e2</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gers</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">wgap</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span><span class="c">! Parameters </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">hndrd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="mf">0.0_sp</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.0_sp</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">four</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">half</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxgrowth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="mf">4.0_sp</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.0_sp</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">allrng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">indrng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">valrng</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">           </span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">logical</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">forceb</span><span class="p">,</span><span class="w"> </span><span class="n">norep</span><span class="p">,</span><span class="w"> </span><span class="n">usedqd</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cnt</span><span class="p">,</span><span class="w"> </span><span class="n">cnt1</span><span class="p">,</span><span class="w"> </span><span class="n">cnt2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ibegin</span><span class="p">,</span><span class="w"> </span><span class="n">idum</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">indl</span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="p">,</span><span class="w"> </span><span class="n">irange</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">jblk</span><span class="p">,</span><span class="w"> </span><span class="n">mb</span><span class="p">,</span><span class="w"> </span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">wbegin</span><span class="p">,</span><span class="w"> </span><span class="n">wend</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">avgap</span><span class="p">,</span><span class="w"> </span><span class="n">bsrtol</span><span class="p">,</span><span class="w"> </span><span class="n">clwdth</span><span class="p">,</span><span class="w"> </span><span class="nb">dmax</span><span class="p">,</span><span class="w"> </span><span class="n">dpivot</span><span class="p">,</span><span class="w"> </span><span class="n">eabs</span><span class="p">,</span><span class="w"> </span><span class="n">emax</span><span class="p">,</span><span class="w"> </span><span class="n">eold</span><span class="p">,</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="p">,</span><span class="w"> </span><span class="n">isleft</span><span class="p">,&amp;</span>
<span class="w">                      </span><span class="n">isrght</span><span class="p">,</span><span class="w"> </span><span class="n">rtl</span><span class="p">,</span><span class="w"> </span><span class="n">rtol</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">safmin</span><span class="p">,</span><span class="w"> </span><span class="n">sgndef</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">spdiam</span><span class="p">,</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span>
<span class="w">           </span><span class="c">! Local Arrays </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iseed</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="nb">min</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="c">! quick return if possible</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! decode range</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">allrng</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valrng</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;I&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">irange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indrng</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="c">! get machine constants</span>
<span class="w">           </span><span class="n">safmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_slamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">eps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_slamch</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;P&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! set parameters</span>
<span class="w">           </span><span class="n">rtl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">hndrd</span><span class="o">*</span><span class="n">eps</span>
<span class="w">           </span><span class="c">! if one were ever to ask for less initial precision in bsrtol,</span>
<span class="w">           </span><span class="c">! one should keep in mind that for the subset case, the extremal</span>
<span class="w">           </span><span class="c">! eigenvalues must be at least as accurate as the current setting</span>
<span class="w">           </span><span class="c">! (eigenvalues in the middle need not as much accuracy)</span>
<span class="w">           </span><span class="n">bsrtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5e-3_sp</span><span class="p">)</span>
<span class="w">           </span><span class="c">! treat case of 1x1 matrix for quick return</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="p">).</span><span class="nb">or</span><span class="p">.((</span><span class="n">irange</span><span class="o">==</span><span class="n">valrng</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="n">vl</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;=</span><span class="n">vu</span><span class="p">)).</span><span class="nb">or</span><span class="p">.((&amp;</span>
<span class="w">                        </span><span class="n">irange</span><span class="o">==</span><span class="n">indrng</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">il</span><span class="o">==</span><span class="mi">1</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">iu</span><span class="o">==</span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">w</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                 </span><span class="c">! the computation error of the eigenvalue is zero</span>
<span class="w">                 </span><span class="n">werr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">wgap</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">iblock</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">gers</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">gers</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">endif</span>
<span class="w">              </span><span class="c">! store the shift for the initial rrr, which is zero in this case</span>
<span class="w">              </span><span class="n">e</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! general case: tridiagonal matrix of order &gt; 1</span>
<span class="w">           </span><span class="c">! init werr, wgap. compute gerschgorin intervals and spectral diameter.</span>
<span class="w">           </span><span class="c">! compute maximum off-diagonal entry and pivmin.</span>
<span class="w">           </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="n">eold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="n">emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="n">e</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">           </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<span class="w">              </span><span class="n">werr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">wgap</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">eabs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">eabs</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">emax</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">emax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              </span><span class="n">tmp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eold</span>
<span class="w">              </span><span class="n">gers</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp1</span>
<span class="w">              </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">gers</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">              </span><span class="n">gers</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tmp1</span>
<span class="w">              </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">gu</span><span class="p">,</span><span class="w"> </span><span class="n">gers</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">eold</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">eabs</span>
<span class="w">           </span><span class="k">end do</span>
<span class="w">           </span><span class="c">! the minimum pivot allowed in the sturm sequence for t</span>
<span class="w">           </span><span class="n">pivmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">safmin</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">emax</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! compute spectral diameter. the gerschgorin bounds give an</span>
<span class="w">           </span><span class="c">! estimate that is wrong by at most a factor of sqrt(2)</span>
<span class="w">           </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gl</span>
<span class="w">           </span><span class="c">! compute splitting points</span>
<span class="w">           </span><span class="k">call </span><span class="n">stdlib_slarra</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">spltol</span><span class="p">,</span><span class="w"> </span><span class="n">spdiam</span><span class="p">,</span><span class="n">nsplit</span><span class="p">,</span><span class="w"> </span><span class="n">isplit</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! can force use of bisection instead of faster dqds.</span>
<span class="w">           </span><span class="c">! option left in the code for future multisection work.</span>
<span class="w">           </span><span class="n">forceb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">           </span><span class="c">! initialize usedqd, dqds should be used for allrng unless someone</span>
<span class="w">           </span><span class="c">! explicitly wants bisection.</span>
<span class="w">           </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! set interval [vl,vu] that contains all eigenvalues</span>
<span class="w">              </span><span class="n">vl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span>
<span class="w">              </span><span class="n">vu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span>
<span class="w">           </span><span class="k">else</span>
<span class="w">              </span><span class="c">! we call stdlib_slarrd to find crude approximations to the eigenvalues</span>
<span class="w">              </span><span class="c">! in the desired range. in case irange = indrng, we also obtain the</span>
<span class="w">              </span><span class="c">! interval (vl,vu] that contains all the wanted eigenvalues.</span>
<span class="w">              </span><span class="c">! an interval [left,right] has converged if</span>
<span class="w">              </span><span class="c">! right-left&lt;rtol*max(abs(left),abs(right))</span>
<span class="w">              </span><span class="c">! stdlib_slarrd needs a work of size 4*n, iwork of size 3*n</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_slarrd</span><span class="p">(</span><span class="w"> </span><span class="nb">range</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">iu</span><span class="p">,</span><span class="w"> </span><span class="n">gers</span><span class="p">,</span><span class="n">bsrtol</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">e2</span><span class="p">,</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">nsplit</span><span class="p">,</span><span class="w"> </span><span class="n">isplit</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="n">werr</span><span class="p">,</span><span class="w"> </span><span class="n">vl</span><span class="p">,</span><span class="w"> </span><span class="n">vu</span><span class="p">,</span><span class="w"> </span><span class="n">iblock</span><span class="p">,</span><span class="w"> </span><span class="n">indexw</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                 </span><span class="k">return</span>
<span class="k">              endif</span>
<span class="w">              </span><span class="c">! make sure that the entries m+1 to n in w, werr, iblock, indexw are 0</span>
<span class="w">              </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mm</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span>
<span class="w">                 </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">werr</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">iblock</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                 </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">           end if</span>
<span class="w">      </span><span class="c">! **</span>
<span class="w">           </span><span class="c">! loop over unreduced blocks</span>
<span class="w">           </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">loop_170</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jblk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nsplit</span>
<span class="w">              </span><span class="n">iend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isplit</span><span class="p">(</span><span class="w"> </span><span class="n">jblk</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="c">! 1 x 1 block</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">==</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="p">).</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">valrng</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="n">vl</span><span class="w"> </span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">ibegin</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="n">vu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">indrng</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">iblock</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">==</span><span class="n">jblk</span><span class="p">)))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">werr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="c">! the gap for a single block doesn&#39;t matter for the later</span>
<span class="w">                    </span><span class="c">! algorithm and is assigned an arbitrary large value</span>
<span class="w">                    </span><span class="n">wgap</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">iblock</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span>
<span class="w">                    </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="w">                 </span><span class="c">! e( iend ) holds the shift for the initial rrr</span>
<span class="w">                 </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">cycle </span><span class="n">loop_170</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! blocks of size larger than 1x1</span>
<span class="w">              </span><span class="c">! e( iend ) will hold the shift for the initial rrr, for now set it =0</span>
<span class="w">              </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="c">! find local outer bounds gl,gu for the block</span>
<span class="w">              </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span>
<span class="w">              </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">)</span>
<span class="w">              </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">iend</span>
<span class="w">                 </span><span class="n">gl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">gers</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">gl</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">gu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">gers</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">              </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">gl</span>
<span class="w">              </span><span class="k">if</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">((</span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="p">).</span><span class="nb">and</span><span class="p">.(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! count the number of eigenvalues in the current block.</span>
<span class="w">                 </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="p">,</span><span class="n">mm</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iblock</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="n">jblk</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mb</span><span class="o">+</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       goto</span><span class="w"> </span><span class="mi">21</span>
<span class="w">                    </span><span class="k">endif</span>
<span class="k">                 end do</span>
<span class="k">                 </span><span class="mi">21</span><span class="w"> </span><span class="k">continue</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">mb</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! no eigenvalue in the current block lies in the desired range</span>
<span class="w">                    </span><span class="c">! e( iend ) holds the shift for the initial rrr</span>
<span class="w">                    </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="k">cycle </span><span class="n">loop_170</span>
<span class="w">                 </span><span class="k">else</span>
<span class="w">                    </span><span class="c">! decide whether dqds or bisection is more efficient</span>
<span class="w">                    </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">mb</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">fac</span><span class="o">*</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="c">! calculate gaps for the current block</span>
<span class="w">                    </span><span class="c">! in later stages, when representations for individual</span>
<span class="w">                    </span><span class="c">! eigenvalues are different, we use sigma = e( iend ).</span>
<span class="w">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="p">,</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                       </span><span class="n">wgap</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">werr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">werr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    </span><span class="n">wgap</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">vu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="o">+</span><span class="n">werr</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)))</span>
<span class="w">                    </span><span class="c">! find local index of the first and last desired evalue.</span>
<span class="w">                    </span><span class="n">indl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indexw</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span>
<span class="w">                    </span><span class="n">indu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">              endif</span>
<span class="k">              if</span><span class="p">((</span><span class="w"> </span><span class="p">(</span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">).</span><span class="nb">or</span><span class="p">.</span><span class="n">usedqd</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! case of dqds</span>
<span class="w">                 </span><span class="c">! find approximations to the extremal eigenvalues of the block</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_slarrk</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">e2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="w"> </span><span class="n">rtl</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                 endif</span>
<span class="k">                 </span><span class="n">isleft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp1</span><span class="o">-</span><span class="w"> </span><span class="n">hndrd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp1</span><span class="p">))</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_slarrk</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">gu</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">e2</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="w"> </span><span class="n">rtl</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">tmp1</span><span class="p">,&amp;</span>
<span class="w">                            </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                 endif</span>
<span class="k">                 </span><span class="n">isrght</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tmp1</span><span class="o">+</span><span class="w"> </span><span class="n">hndrd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">tmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">tmp1</span><span class="p">))</span>
<span class="w">                 </span><span class="c">! improve the estimate of the spectral diameter</span>
<span class="w">                 </span><span class="n">spdiam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isleft</span>
<span class="w">              </span><span class="k">else</span>
<span class="w">                 </span><span class="c">! case of bisection</span>
<span class="w">                 </span><span class="c">! find approximations to the wanted extremal eigenvalues</span>
<span class="w">                 </span><span class="n">isleft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="w"> </span><span class="n">hndrd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="o">-</span><span class="w"> </span><span class="n">werr</span><span class="p">(&amp;</span>
<span class="w">                           </span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="p">))</span>
<span class="w">                 </span><span class="n">isrght</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">gu</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">hndrd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)))</span>
<span class="w">                           </span>
<span class="w">              </span><span class="k">endif</span>
<span class="w">              </span><span class="c">! decide whether the base representation for the current block</span>
<span class="w">              </span><span class="c">! l_jblk d_jblk l_jblk^t = t_jblk - sigma_jblk i</span>
<span class="w">              </span><span class="c">! should be on the left or the right end of the current block.</span>
<span class="w">              </span><span class="c">! the strategy is to shift to the end which is &quot;more populated&quot;</span>
<span class="w">              </span><span class="c">! furthermore, decide whether to use dqds for the computation of</span>
<span class="w">              </span><span class="c">! dqds is chosen if all eigenvalues are desired or the number of</span>
<span class="w">              </span><span class="c">! eigenvalues to be computed is large compared to the blocksize.</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! if all the eigenvalues have to be computed, we use dqd</span>
<span class="w">                 </span><span class="n">usedqd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                 </span><span class="c">! indl is the local index of the first eigenvalue to compute</span>
<span class="w">                 </span><span class="n">indl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">indu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span>
<span class="w">                 </span><span class="c">! mb =  number of eigenvalues to compute</span>
<span class="w">                 </span><span class="n">mb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">in</span>
<span class="w">                 </span><span class="n">wend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wbegin</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="c">! define 1/4 and 3/4 points of the spectrum</span>
<span class="w">                 </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spdiam</span>
<span class="w">                 </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spdiam</span>
<span class="w">              </span><span class="k">else</span>
<span class="w">                 </span><span class="c">! stdlib_slarrd has computed iblock and indexw for each eigenvalue</span>
<span class="w">                 </span><span class="c">! approximation.</span>
<span class="w">                 </span><span class="c">! choose sigma</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spdiam</span>
<span class="w">                    </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spdiam</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">vu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="nb">max</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">vl</span><span class="p">)</span>
<span class="w">                    </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nb">max</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">vl</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tmp</span>
<span class="w">                    </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nb">min</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">vu</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fourth</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tmp</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">              endif</span>
<span class="w">              </span><span class="c">! compute the negcount at the 1/4 and 3/4 points</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 call </span><span class="n">stdlib_slarrc</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">s1</span><span class="p">,</span><span class="w"> </span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">e</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="w"> </span><span class="n">cnt</span><span class="p">,</span><span class="w"> </span><span class="n">cnt1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">cnt2</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="p">)</span>
<span class="w">              </span><span class="k">endif</span>
<span class="k">              if</span><span class="p">(</span><span class="n">mb</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gl</span>
<span class="w">                 </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">              </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">cnt1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">indl</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">indu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cnt2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">gl</span><span class="p">)</span>
<span class="w">                 </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! use gerschgorin bound as shift to get pos def matrix</span>
<span class="w">                    </span><span class="c">! for dqds</span>
<span class="w">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isleft</span>
<span class="w">                 </span><span class="k">else</span>
<span class="w">                    </span><span class="c">! use approximation of the first desired eigenvalue of the</span>
<span class="w">                    </span><span class="c">! block as shift</span>
<span class="w">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">isleft</span><span class="p">,</span><span class="n">vl</span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">                 </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">irange</span><span class="o">==</span><span class="n">allrng</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">forceb</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">gu</span><span class="p">)</span>
<span class="w">                 </span><span class="k">elseif</span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! use gerschgorin bound as shift to get neg def matrix</span>
<span class="w">                    </span><span class="c">! for dqds</span>
<span class="w">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isrght</span>
<span class="w">                 </span><span class="k">else</span>
<span class="w">                    </span><span class="c">! use approximation of the first desired eigenvalue of the</span>
<span class="w">                    </span><span class="c">! block as shift</span>
<span class="w">                    </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">isrght</span><span class="p">,</span><span class="n">vu</span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">                 </span><span class="n">sgndef</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">one</span>
<span class="w">              </span><span class="k">endif</span>
<span class="w">              </span><span class="c">! an initial sigma has been chosen that will be used for computing</span>
<span class="w">              </span><span class="c">! t - sigma i = l d l^t</span>
<span class="w">              </span><span class="c">! define the increment tau of the shift in case the initial shift</span>
<span class="w">              </span><span class="c">! needs to be refined to obtain a factorization with not too much</span>
<span class="w">              </span><span class="c">! element growth.</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! the initial sigma was to the outer end of the spectrum</span>
<span class="w">                 </span><span class="c">! the matrix is definite and we need not retreat.</span>
<span class="w">                 </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">two</span><span class="o">*</span><span class="n">pivmin</span>
<span class="w">                 </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">tau</span><span class="p">,</span><span class="n">two</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 if</span><span class="p">(</span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">clwdth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wend</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span>
<span class="w">                    </span><span class="n">avgap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">clwdth</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">wend</span><span class="o">-</span><span class="n">wbegin</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">))</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">==</span><span class="n">one</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">half</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">avgap</span><span class="p">)</span>
<span class="w">                       </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">))</span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                       </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">half</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">wgap</span><span class="p">(</span><span class="n">wend</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">avgap</span><span class="p">)</span>
<span class="w">                       </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span><span class="n">werr</span><span class="p">(</span><span class="n">wend</span><span class="p">))</span>
<span class="w">                    </span><span class="k">endif</span>
<span class="k">                 else</span>
<span class="k">                    </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">)</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">              endif</span>
<span class="k">              </span><span class="n">loop_80</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">idum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">maxtry</span>
<span class="w">                 </span><span class="c">! compute l d l^t factorization of tridiagonal matrix t - sigma i.</span>
<span class="w">                 </span><span class="c">! store d in work(1:in), l in work(in+1:2*in), and reciprocals of</span>
<span class="w">                 </span><span class="c">! pivots in work(2*in+1:3*in)</span>
<span class="w">                 </span><span class="n">dpivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sigma</span>
<span class="w">                 </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dpivot</span>
<span class="w">                 </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tmp</span>
<span class="w">                    </span><span class="n">dpivot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">-</span><span class="n">sigma</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tmp</span><span class="o">*</span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dpivot</span>
<span class="w">                    </span><span class="nb">dmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="nb">dmax</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">dpivot</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="w">                 </span><span class="c">! check for element growth</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">dmax</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">maxgrowth</span><span class="o">*</span><span class="n">spdiam</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                 </span><span class="k">else</span>
<span class="k">                    </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">                 </span><span class="k">endif</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">usedqd</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">norep</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! ensure the definiteness of the representation</span>
<span class="w">                    </span><span class="c">! all entries of d (of l d l^t) must have the same sign</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">in</span>
<span class="w">                       </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sgndef</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">tmp</span><span class="o">&lt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">norep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 endif</span>
<span class="k">                 if</span><span class="p">(</span><span class="n">norep</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! note that in the case of irange=allrng, we use the gerschgorin</span>
<span class="w">                    </span><span class="c">! shift which makes the matrix definite. so we should end up</span>
<span class="w">                    </span><span class="c">! here really only in the case of irange = valrng or indrng.</span>
<span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">idum</span><span class="o">==</span><span class="n">maxtry</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       if</span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">==</span><span class="n">one</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                          </span><span class="c">! the fudged gerschgorin shift should succeed</span>
<span class="w">                          </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="n">gl</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fudge</span><span class="o">*</span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fudge</span><span class="o">*</span><span class="n">two</span><span class="o">*</span><span class="n">pivmin</span>
<span class="w">                       </span><span class="k">else</span>
<span class="k">                          </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="n">gu</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fudge</span><span class="o">*</span><span class="n">spdiam</span><span class="o">*</span><span class="n">eps</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fudge</span><span class="o">*</span><span class="n">two</span><span class="o">*</span><span class="n">pivmin</span>
<span class="w">                       </span><span class="k">end if</span>
<span class="k">                    else</span>
<span class="k">                       </span><span class="n">sigma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sgndef</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau</span>
<span class="w">                       </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tau</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                 else</span>
<span class="w">                    </span><span class="c">! an initial rrr is found</span>
<span class="w">                    </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">83</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">              end do </span><span class="n">loop_80</span>
<span class="w">              </span><span class="c">! if the program reaches this point, no base representation could be</span>
<span class="w">              </span><span class="c">! found in maxtry iterations.</span>
<span class="w">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">              </span><span class="mi">83</span><span class="w"> </span><span class="k">continue</span>
<span class="w">              </span><span class="c">! at this point, we have found an initial base representation</span>
<span class="w">              </span><span class="c">! t - sigma i = l d l^t with not too much element growth.</span>
<span class="w">              </span><span class="c">! store the shift.</span>
<span class="w">              </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma</span>
<span class="w">              </span><span class="c">! store d and l.</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">stdlib_scopy</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">ibegin</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="n">mb</span><span class="o">&gt;</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! perturb each entry of the base representation by a small</span>
<span class="w">                 </span><span class="c">! (but random) relative amount to overcome difficulties with</span>
<span class="w">                 </span><span class="c">! glued matrices.</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span>
<span class="w">                    </span><span class="n">iseed</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 call </span><span class="n">stdlib_slarnv</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">iseed</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">one</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">pert</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">                    </span><span class="n">e</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="n">ibegin</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">one</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">pert</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="n">in</span><span class="o">+</span><span class="n">i</span><span class="p">))</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 </span><span class="n">d</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">one</span><span class="o">+</span><span class="n">eps</span><span class="o">*</span><span class="n">four</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="n">in</span><span class="p">))</span>
<span class="w">              </span><span class="k">endif</span>
<span class="w">              </span><span class="c">! don&#39;t update the gerschgorin intervals because keeping track</span>
<span class="w">              </span><span class="c">! of the updates would be too much work in stdlib_slarrv.</span>
<span class="w">              </span><span class="c">! we update w instead and use it to locate the proper gerschgorin</span>
<span class="w">              </span><span class="c">! intervals.</span>
<span class="w">              </span><span class="c">! compute the required eigenvalues of l d l&#39; by bisection or dqds</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">usedqd</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! if stdlib_slarrd has been used, shift the eigenvalue approximations</span>
<span class="w">                 </span><span class="c">! according to their representation. this is necessary for</span>
<span class="w">                 </span><span class="c">! a uniform stdlib_slarrv since dqds computes eigenvalues of the</span>
<span class="w">                 </span><span class="c">! shifted representation. in stdlib_slarrv, w will always hold the</span>
<span class="w">                 </span><span class="c">! unshifted eigenvalue approximation.</span>
<span class="w">                 </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="n">wbegin</span><span class="p">,</span><span class="n">wend</span>
<span class="w">                    </span><span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sigma</span>
<span class="w">                    </span><span class="n">werr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="w">                 </span><span class="c">! call stdlib_slarrb to reduce eigenvalue error of the approximations</span>
<span class="w">                 </span><span class="c">! from stdlib_slarrd</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span><span class="p">,</span><span class="w"> </span><span class="n">iend</span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="w">                 </span><span class="c">! use bisection to find ev from indl to indu</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_slarrb</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="n">ibegin</span><span class="p">),</span><span class="n">indl</span><span class="p">,</span><span class="w"> </span><span class="n">indu</span><span class="p">,</span><span class="w"> </span><span class="n">rtol1</span><span class="p">,</span><span class="w"> </span><span class="n">rtol2</span><span class="p">,</span><span class="w"> </span><span class="n">indl</span><span class="o">-</span><span class="mi">1</span><span class="p">,&amp;</span>
<span class="w">                 </span><span class="n">w</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w"> </span><span class="n">wgap</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="n">wbegin</span><span class="p">),</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">pivmin</span><span class="p">,</span><span class="w"> </span><span class="n">spdiam</span><span class="p">,</span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                 end if</span>
<span class="w">                 </span><span class="c">! stdlib_slarrb computes all gaps correctly except for the last one</span>
<span class="w">                 </span><span class="c">! record distance to vu/gu</span>
<span class="w">                 </span><span class="n">wgap</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,(</span><span class="w"> </span><span class="n">vu</span><span class="o">-</span><span class="n">sigma</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="p">,</span><span class="w"> </span><span class="n">indu</span>
<span class="w">                    </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">iblock</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span>
<span class="w">                    </span><span class="n">indexw</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">              else</span>
<span class="w">                 </span><span class="c">! call dqds to get all eigs (and then possibly delete unwanted</span>
<span class="w">                 </span><span class="c">! eigenvalues).</span>
<span class="w">                 </span><span class="c">! note that dqds finds the eigenvalues of the l d l^t representation</span>
<span class="w">                 </span><span class="c">! of t to high relative accuracy. high relative accuracy</span>
<span class="w">                 </span><span class="c">! might be lost when the shift of the rrr is subtracted to obtain</span>
<span class="w">                 </span><span class="c">! the eigenvalues of t. however, t is not guaranteed to define its</span>
<span class="w">                 </span><span class="c">! eigenvalues to high relative accuracy anyway.</span>
<span class="w">                 </span><span class="c">! set rtol to the order of the tolerance used in stdlib_slasq2</span>
<span class="w">                 </span><span class="c">! this is an estimated error, the worst case bound is 4*n*eps</span>
<span class="w">                 </span><span class="c">! which is usually too large and requires unnecessary work to be</span>
<span class="w">                 </span><span class="c">! done by bisection when computing the eigenvectors</span>
<span class="w">                 </span><span class="n">rtol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">in</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">four</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">eps</span>
<span class="w">                 </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ibegin</span>
<span class="w">                 </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="p">(</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">in</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_slasq2</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">iinfo</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! if iinfo = -5 then an index is part of a tight cluster</span>
<span class="w">                    </span><span class="c">! and should be changed. the index is in iwork(1) and the</span>
<span class="w">                    </span><span class="c">! gap is in work(n+1)</span>
<span class="w">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                 else</span>
<span class="w">                    </span><span class="c">! test that all eigenvalues are positive as expected</span>
<span class="w">                    </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">in</span>
<span class="w">                       </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span>
<span class="w">                          </span><span class="k">return</span>
<span class="k">                       endif</span>
<span class="k">                    end do</span>
<span class="k">                 end if</span>
<span class="k">                 if</span><span class="p">(</span><span class="w"> </span><span class="n">sgndef</span><span class="o">&gt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="p">,</span><span class="w"> </span><span class="n">indu</span>
<span class="w">                       </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                       </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">in</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">iblock</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span>
<span class="w">                       </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 else</span>
<span class="k">                    do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indl</span><span class="p">,</span><span class="w"> </span><span class="n">indu</span>
<span class="w">                       </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                       </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">work</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">iblock</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jblk</span>
<span class="w">                       </span><span class="n">indexw</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end if</span>
<span class="k">                 do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                    </span><span class="c">! the value of rtol below should be the tolerance in stdlib_slasq2</span>
<span class="w">                    </span><span class="n">werr</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtol</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                    </span><span class="c">! compute the right gap between the intervals</span>
<span class="w">                    </span><span class="n">wgap</span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">werr</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">werr</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="k">                 </span><span class="n">wgap</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,(</span><span class="w"> </span><span class="n">vu</span><span class="o">-</span><span class="n">sigma</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">w</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">werr</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! proceed with next block</span>
<span class="w">              </span><span class="n">ibegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">wbegin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wend</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">end do </span><span class="n">loop_170</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_slarre</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>693986a</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-03 09:57            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>