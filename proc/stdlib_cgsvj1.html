<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_cgsvj1 &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_cgsvj1
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.1% of total for procedures.">257 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_c.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_c.fypp.html'>stdlib_linalg_lapack_c.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_c.html'>stdlib_linalg_lapack_c</a></li>
     <li class="active">stdlib_cgsvj1</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_cgsvj1.html#src">stdlib_cgsvj1</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public pure subroutine stdlib_cgsvj1(jobv, m, n, n1, a, lda, d, sva, mv, v, ldv, eps, sfmin, tol, nsweep, work, lwork, info)</h2>
    

    <p>CGSVJ1 is called from CGESVJ as a pre-processor and that is its main
purpose. It applies Jacobi rotations in the same way as CGESVJ does, but
it targets only particular pivots and it does not check convergence
(stopping criterion). Few tuning parameters (marked by [TP]) are
available for the implementer.
Further Details
~~~~~~~~~~~~~~~
CGSVJ1 applies few sweeps of Jacobi rotations in the column space of
the input M-by-N matrix A. The pivot pairs are taken from the (1,2)
off-diagonal block in the corresponding N-by-N Gram matrix A^T * A. The
block-entries (tiles) of the (1,2) off-diagonal block are marked by the
[x]'s in the following scheme:
| *  *  * [x] [x] [x]|
| *  *  * [x] [x] [x]|    Row-cycling in the nblr-by-nblc [x] blocks.
| *  *  * [x] [x] [x]|    Row-cyclic pivoting inside each [x] block.
|[x] [x] [x] *  *  * |
|[x] [x] [x] *  *  * |
|[x] [x] [x] *  *  * |
In terms of the columns of A, the first N1 columns are rotated 'against'
the remaining N-N1 columns, trying to increase the angle between the
corresponding subspaces. The off-diagonal block is N1-by(N-N1) and it is
tiled using quadratic tiles of side KBL. Here, KBL is a tuning parameter.
The number of sweeps is given in NSWEEP and the orthogonality threshold
is given in TOL.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-jobv~11"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobv</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-m~234"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n~618"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n1~5"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n1</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~397"></span>complex(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong>(lda,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lda~386"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lda</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-d~58"></span>complex(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>d</strong>(n)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sva~8"></span>real(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sva</strong>(n)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mv~6"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mv</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-v~38"></span>complex(kind=sp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>v</strong>(ldv,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldv~29"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldv</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-eps~4"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>eps</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sfmin~4"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sfmin</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-tol~6"></span>real(kind=sp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>tol</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nsweep~4"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nsweep</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-work~335"></span>complex(kind=sp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>work</strong>(lwork)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lwork~166"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~441"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_cgsvj1.html#src">stdlib_cgsvj1</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">pure subroutine </span><span class="n">stdlib_cgsvj1</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">sva</span><span class="p">,</span><span class="w"> </span><span class="n">mv</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">sfmin</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="c">!! CGSVJ1 is called from CGESVJ as a pre-processor and that is its main</span>
<span class="w">     </span><span class="c">!! purpose. It applies Jacobi rotations in the same way as CGESVJ does, but</span>
<span class="w">     </span><span class="c">!! it targets only particular pivots and it does not check convergence</span>
<span class="w">     </span><span class="c">!! (stopping criterion). Few tuning parameters (marked by [TP]) are</span>
<span class="w">     </span><span class="c">!! available for the implementer.</span>
<span class="w">     </span><span class="c">!! Further Details</span>
<span class="w">     </span><span class="c">!! ~~~~~~~~~~~~~~~</span>
<span class="w">     </span><span class="c">!! CGSVJ1 applies few sweeps of Jacobi rotations in the column space of</span>
<span class="w">     </span><span class="c">!! the input M-by-N matrix A. The pivot pairs are taken from the (1,2)</span>
<span class="w">     </span><span class="c">!! off-diagonal block in the corresponding N-by-N Gram matrix A^T * A. The</span>
<span class="w">     </span><span class="c">!! block-entries (tiles) of the (1,2) off-diagonal block are marked by the</span>
<span class="w">     </span><span class="c">!! [x]&#39;s in the following scheme:</span>
<span class="w">     </span><span class="c">!! | *  *  * [x] [x] [x]|</span>
<span class="w">     </span><span class="c">!! | *  *  * [x] [x] [x]|    Row-cycling in the nblr-by-nblc [x] blocks.</span>
<span class="w">     </span><span class="c">!! | *  *  * [x] [x] [x]|    Row-cyclic pivoting inside each [x] block.</span>
<span class="w">     </span><span class="c">!! |[x] [x] [x] *  *  * |</span>
<span class="w">     </span><span class="c">!! |[x] [x] [x] *  *  * |</span>
<span class="w">     </span><span class="c">!! |[x] [x] [x] *  *  * |</span>
<span class="w">     </span><span class="c">!! In terms of the columns of A, the first N1 columns are rotated &#39;against&#39;</span>
<span class="w">     </span><span class="c">!! the remaining N-N1 columns, trying to increase the angle between the</span>
<span class="w">     </span><span class="c">!! corresponding subspaces. The off-diagonal block is N1-by(N-N1) and it is</span>
<span class="w">     </span><span class="c">!! tiled using quadratic tiles of side KBL. Here, KBL is a tuning parameter.</span>
<span class="w">     </span><span class="c">!! The number of sweeps is given in NSWEEP and the orthogonality threshold</span>
<span class="w">     </span><span class="c">!! is given in TOL.</span>
<span class="w">               </span><span class="n">nsweep</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">        </span><span class="c">! -- lapack computational routine --</span>
<span class="w">        </span><span class="c">! -- lapack is a software package provided by univ. of tennessee,    --</span>
<span class="w">        </span><span class="c">! -- univ. of california berkeley, univ. of colorado denver and nag ltd..--</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eps</span><span class="p">,</span><span class="w"> </span><span class="n">sfmin</span><span class="p">,</span><span class="w"> </span><span class="n">tol</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">info</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">lwork</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">mv</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">nsweep</span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jobv</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">ldv</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="n">lwork</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">aapq</span><span class="p">,</span><span class="w"> </span><span class="n">ompq</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">aapp</span><span class="p">,</span><span class="w"> </span><span class="n">aapp0</span><span class="p">,</span><span class="w"> </span><span class="n">aapq1</span><span class="p">,</span><span class="w"> </span><span class="n">aaqq</span><span class="p">,</span><span class="w"> </span><span class="n">apoaq</span><span class="p">,</span><span class="w"> </span><span class="n">aqoap</span><span class="p">,</span><span class="w"> </span><span class="n">big</span><span class="p">,</span><span class="w"> </span><span class="n">bigtheta</span><span class="p">,</span><span class="w"> </span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="n">mxaapq</span><span class="p">,</span><span class="w"> </span><span class="n">mxsinj</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">rootbig</span><span class="p">,</span><span class="w"> </span><span class="n">rooteps</span><span class="p">,</span><span class="w"> </span><span class="n">rootsfmin</span><span class="p">,</span><span class="w"> </span><span class="n">roottol</span><span class="p">,</span><span class="w"> </span><span class="n">small</span><span class="p">,</span><span class="w"> </span><span class="n">sn</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">temp1</span><span class="p">,</span><span class="w"> </span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="n">thsign</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">blskip</span><span class="p">,</span><span class="w"> </span><span class="n">emptsw</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ibr</span><span class="p">,</span><span class="w"> </span><span class="n">igl</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">ijblsk</span><span class="p">,</span><span class="w"> </span><span class="n">iswrot</span><span class="p">,</span><span class="w"> </span><span class="n">jbc</span><span class="p">,</span><span class="w"> </span><span class="n">jgl</span><span class="p">,</span><span class="w"> </span><span class="n">kbl</span><span class="p">,</span><span class="w"> </span><span class="n">mvl</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">notrot</span><span class="p">,</span><span class="w"> </span><span class="n">nblc</span><span class="p">,</span><span class="w"> </span><span class="n">nblr</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">pskipped</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="p">,</span><span class="w"> </span><span class="n">rowskip</span><span class="p">,</span><span class="w"> </span><span class="n">swband</span>
<span class="w">           </span><span class="kt">logical</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">applv</span><span class="p">,</span><span class="w"> </span><span class="n">rotok</span><span class="p">,</span><span class="w"> </span><span class="n">rsvec</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="nb">conjg</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span><span class="nb">min</span><span class="p">,</span><span class="nb">sign</span><span class="p">,</span><span class="nb">sqrt</span>
<span class="w">           </span><span class="c">! From Lapack</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="c">! test the input parameters.</span>
<span class="w">           </span><span class="n">applv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">rsvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">applv</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&gt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">n1</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">lda</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="n">applv</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mv</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">ldv</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">).</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="n">applv</span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">ldv</span><span class="o">&lt;</span><span class="n">mv</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">tol</span><span class="o">&lt;=</span><span class="n">eps</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">14</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">nsweep</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">15</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">lwork</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">17</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! #:(</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;CGSVJ1&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">mvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="k">else if</span><span class="p">(</span><span class="w"> </span><span class="n">applv</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">mvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mv</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">rsvec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">applv</span>
<span class="w">           </span><span class="n">rooteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">eps</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">rootsfmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">sfmin</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">small</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sfmin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">eps</span>
<span class="w">           </span><span class="n">big</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sfmin</span>
<span class="w">           </span><span class="n">rootbig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rootsfmin</span>
<span class="w">           </span><span class="c">! large = big / sqrt( real( m*n,KIND=sp) )</span>
<span class="w">           </span><span class="n">bigtheta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">rooteps</span>
<span class="w">           </span><span class="n">roottol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">tol</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! Initialize The Right Singular Vector Matrix </span>
<span class="w">           </span><span class="c">! rsvec = stdlib_lsame( jobv, &#39;y&#39; )</span>
<span class="w">           </span><span class="n">emptsw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n1</span><span class="o">*</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">n1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="c">! .. row-cyclic pivot strategy with de rijk&#39;s pivoting ..</span>
<span class="w">           </span><span class="n">kbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">nblr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">kbl</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nblr</span><span class="o">*</span><span class="n">kbl</span><span class="w"> </span><span class="p">)</span><span class="o">/=</span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="n">nblr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="c">! .. the tiling is nblr-by-nblc [tiles]</span>
<span class="w">           </span><span class="n">nblc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">kbl</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nblc</span><span class="o">*</span><span class="n">kbl</span><span class="w"> </span><span class="p">)</span><span class="o">/=</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="n">nblc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nblc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="n">blskip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">kbl</span><span class="o">**</span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="c">! [tp] blkskip is a tuning parameter that depends on swband and kbl.</span>
<span class="w">           </span><span class="n">rowskip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">kbl</span><span class="w"> </span><span class="p">)</span>
<span class="w">      </span><span class="c">! [tp] rowskip is a tuning parameter.</span>
<span class="w">           </span><span class="n">swband</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="c">! [tp] swband is a tuning parameter. it is meaningful and effective</span>
<span class="w">           </span><span class="c">! if stdlib_cgesvj is used as a computational routine in the preconditioned</span>
<span class="w">           </span><span class="c">! jacobi svd algorithm stdlib_cgejsv.</span>
<span class="w">           </span><span class="c">! | *   *   * [x] [x] [x]|</span>
<span class="w">           </span><span class="c">! | *   *   * [x] [x] [x]|    row-cycling in the nblr-by-nblc [x] blocks.</span>
<span class="w">           </span><span class="c">! | *   *   * [x] [x] [x]|    row-cyclic pivoting inside each [x] block.</span>
<span class="w">           </span><span class="c">! |[x] [x] [x] *   *   * |</span>
<span class="w">           </span><span class="c">! |[x] [x] [x] *   *   * |</span>
<span class="w">           </span><span class="c">! |[x] [x] [x] *   *   * |</span>
<span class="w">           </span><span class="n">loop_1993</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nsweep</span>
<span class="w">           </span><span class="c">! .. go go go ...</span>
<span class="w">              </span><span class="n">mxaapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">mxsinj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">              </span><span class="n">iswrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="n">pskipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="c">! each sweep is unrolled using kbl-by-kbl tiles over the pivot pairs</span>
<span class="w">           </span><span class="c">! 1 &lt;= p &lt; q &lt;= n. this is the first step toward a blocked implementation</span>
<span class="w">           </span><span class="c">! of the rotations. new implementation, based on block transformations,</span>
<span class="w">           </span><span class="c">! is under development.</span>
<span class="w">              </span><span class="n">loop_2000</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">ibr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nblr</span>
<span class="w">                 </span><span class="n">igl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ibr</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">kbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">       </span><span class="c">! ... go to the off diagonal blocks</span>
<span class="w">                 </span><span class="n">igl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ibr</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">kbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="c">! do 2010 jbc = ibr + 1, nbl</span>
<span class="w">                 </span><span class="n">loop_2010</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">jbc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nblc</span>
<span class="w">                    </span><span class="n">jgl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">jbc</span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">kbl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="c">! doing the block at ( ibr, jbc )</span>
<span class="w">                    </span><span class="n">ijblsk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="n">loop_2100</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">igl</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">igl</span><span class="o">+</span><span class="n">kbl</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          </span><span class="n">pskipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                          </span><span class="n">loop_2200</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jgl</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">jgl</span><span class="o">+</span><span class="n">kbl</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">                             </span><span class="n">aaqq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span>
<span class="w">                             </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&gt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                </span><span class="n">aapp0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">           </span><span class="c">! M X 2 Jacobi Svd </span>
<span class="w">              </span><span class="c">! safe gram matrix computation</span>
<span class="w">                                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&gt;=</span><span class="n">one</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                   if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;=</span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      </span><span class="n">rotok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">small</span><span class="o">*</span><span class="n">aapp</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="n">aaqq</span>
<span class="w">                                   </span><span class="k">else</span>
<span class="k">                                      </span><span class="n">rotok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">small</span><span class="o">*</span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;=</span><span class="n">aapp</span>
<span class="w">                                   </span><span class="k">end if</span>
<span class="k">                                   if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&lt;</span><span class="p">(</span><span class="w"> </span><span class="n">big</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      </span><span class="n">aapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_cdotc</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                </span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">                                   </span><span class="k">else</span>
<span class="k">                                      call </span><span class="n">stdlib_ccopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aapp</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="n">aapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_cdotc</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                </span><span class="n">aaqq</span>
<span class="w">                                   </span><span class="k">end if</span>
<span class="k">                                else</span>
<span class="k">                                   if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;=</span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      </span><span class="n">rotok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span><span class="o">&lt;=</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                   </span><span class="k">else</span>
<span class="k">                                      </span><span class="n">rotok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&lt;=</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                   </span><span class="k">end if</span>
<span class="k">                                   if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;</span><span class="p">(</span><span class="w"> </span><span class="n">small</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      </span><span class="n">aapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stdlib_cdotc</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">max</span><span class="p">(&amp;</span>
<span class="w">                                                </span><span class="n">aaqq</span><span class="p">,</span><span class="n">aapp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">aaqq</span><span class="p">,</span><span class="n">aapp</span><span class="p">)</span>
<span class="w">                                   </span><span class="k">else</span>
<span class="k">                                      call </span><span class="n">stdlib_ccopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aaqq</span><span class="p">,</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="n">aapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_cdotc</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                </span><span class="n">aapp</span>
<span class="w">                                   </span><span class="k">end if</span>
<span class="k">                                end if</span>
<span class="w">                                 </span><span class="c">! aapq = aapq * conjg(cwork(p))*cwork(q)</span>
<span class="w">                                </span><span class="n">aapq1</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">aapq</span><span class="p">)</span>
<span class="w">                                </span><span class="n">mxaapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">mxaapq</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="c">! to rotate or not to rotate, that is the question ...</span>
<span class="w">                                </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="n">tol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                   </span><span class="n">ompq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">aapq</span><span class="p">)</span>
<span class="w">                                   </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="c">! [rtd]      rotated  = rotated + 1</span>
<span class="w">                                   </span><span class="n">pskipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                   </span><span class="n">iswrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iswrot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                   </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">rotok</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      </span><span class="n">aqoap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">                                      </span><span class="n">apoaq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aaqq</span>
<span class="w">                                      </span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">half</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">aqoap</span><span class="o">-</span><span class="n">apoaq</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="w"> </span><span class="n">aapq1</span>
<span class="w">                                      </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&gt;</span><span class="n">aapp0</span><span class="w"> </span><span class="p">)</span><span class="n">theta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">theta</span>
<span class="w">                                      </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">theta</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="n">bigtheta</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                         </span><span class="n">t</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">half</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">theta</span>
<span class="w">                                         </span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_crot</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">ompq</span><span class="p">)&amp;</span>
<span class="w">                                                   </span><span class="o">*</span><span class="n">t</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                             call </span><span class="n">stdlib_crot</span><span class="p">(</span><span class="w"> </span><span class="n">mvl</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                       </span><span class="nb">conjg</span><span class="p">(</span><span class="n">ompq</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">end if</span>
<span class="k">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aaqq</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">apoaq</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="n">aqoap</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">mxsinj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">mxsinj</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">else</span>
<span class="w">                       </span><span class="c">! Choose Correct Signum For Theta And Rotate</span>
<span class="w">                                         </span><span class="n">thsign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nb">sign</span><span class="p">(</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&gt;</span><span class="n">aapp0</span><span class="w"> </span><span class="p">)</span><span class="n">thsign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">thsign</span>
<span class="w">                                         </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">theta</span><span class="o">+</span><span class="n">thsign</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">one</span><span class="o">+</span><span class="n">theta</span><span class="o">*</span><span class="n">theta</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="n">cs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">one</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">sn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="n">cs</span>
<span class="w">                                         </span><span class="n">mxsinj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">mxsinj</span><span class="p">,</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">sn</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aaqq</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">apoaq</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="n">aqoap</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_crot</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">ompq</span><span class="p">)&amp;</span>
<span class="w">                                                   </span><span class="o">*</span><span class="n">sn</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                             call </span><span class="n">stdlib_crot</span><span class="p">(</span><span class="w"> </span><span class="n">mvl</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">q</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                       </span><span class="nb">conjg</span><span class="p">(</span><span class="n">ompq</span><span class="p">)</span><span class="o">*</span><span class="n">sn</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">end if</span>
<span class="k">                                      end if</span>
<span class="k">                                      </span><span class="n">d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ompq</span>
<span class="w">                                   </span><span class="k">else</span>
<span class="w">                    </span><span class="c">! .. have to use modified gram-schmidt like transformation</span>
<span class="w">                                    </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;</span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                         call </span><span class="n">stdlib_ccopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aapp</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="n">lda</span><span class="p">,&amp;</span>
<span class="w">                                                   </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aaqq</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                                                    </span><span class="n">lda</span><span class="p">,</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_caxpy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">aapq</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">aaqq</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                                                    </span><span class="n">lda</span><span class="p">,</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aaqq</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">aapq1</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="n">mxsinj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">mxsinj</span><span class="p">,</span><span class="w"> </span><span class="n">sfmin</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span><span class="k">else</span>
<span class="k">                                        call </span><span class="n">stdlib_ccopy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aaqq</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="p">,</span><span class="n">lda</span><span class="p">,&amp;</span>
<span class="w">                                                   </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">aapp</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                                                    </span><span class="n">lda</span><span class="p">,</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_caxpy</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nb">conjg</span><span class="p">(</span><span class="n">aapq</span><span class="p">),</span><span class="n">work</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                                   </span><span class="p">)</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_clascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">aapp</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),&amp;</span>
<span class="w">                                                    </span><span class="n">lda</span><span class="p">,</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">one</span><span class="o">-</span><span class="n">aapq1</span><span class="o">*</span><span class="n">aapq1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                                   </span>
<span class="w">                                         </span><span class="n">mxsinj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">mxsinj</span><span class="p">,</span><span class="w"> </span><span class="n">sfmin</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span><span class="k">end if</span>
<span class="k">                                   end if</span>
<span class="w">                 </span><span class="c">! end if rotok then ... else</span>
<span class="w">                 </span><span class="c">! in the case of cancellation in updating sva(q), sva(p)</span>
<span class="w">                 </span><span class="c">! .. recompute sva(q), sva(p)</span>
<span class="w">                                   </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">&lt;=</span><span class="n">rooteps</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">                                      if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&lt;</span><span class="n">rootbig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">aaqq</span><span class="o">&gt;</span><span class="n">rootsfmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_scnrm2</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">                                       </span><span class="k">else</span>
<span class="k">                                         </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                                         </span><span class="n">aaqq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_classq</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">aaqq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">end if</span>
<span class="k">                                   end if</span>
<span class="k">                                   if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">aapp0</span><span class="w"> </span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">&lt;=</span><span class="n">rooteps</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                      if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&lt;</span><span class="n">rootbig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&gt;</span><span class="n">rootsfmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                         </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_scnrm2</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">else</span>
<span class="k">                                         </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                                         </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                                         </span><span class="k">call </span><span class="n">stdlib_classq</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="n">aapp</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                         </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                      </span><span class="k">end if</span>
<span class="k">                                      </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">                                   </span><span class="k">end if</span>
<span class="w">                    </span><span class="c">! end of ok rotation</span>
<span class="w">                                </span><span class="k">else</span>
<span class="k">                                   </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">notrot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="c">! [rtd]      skipped  = skipped  + 1</span>
<span class="w">                                   </span><span class="n">pskipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pskipped</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                   </span><span class="n">ijblsk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ijblsk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                </span><span class="k">end if</span>
<span class="k">                             else</span>
<span class="k">                                </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">notrot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                </span><span class="n">pskipped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pskipped</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                </span><span class="n">ijblsk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ijblsk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                             </span><span class="k">end if</span>
<span class="k">                             if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">swband</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ijblsk</span><span class="o">&gt;=</span><span class="n">blskip</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">                                </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">                                </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">2011</span>
<span class="w">                             </span><span class="k">end if</span>
<span class="k">                             if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;=</span><span class="n">swband</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.(</span><span class="w"> </span><span class="n">pskipped</span><span class="o">&gt;</span><span class="n">rowskip</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                                </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">aapp</span>
<span class="w">                                </span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">2203</span>
<span class="w">                             </span><span class="k">end if</span>
<span class="k">                          end do </span><span class="n">loop_2200</span>
<span class="w">              </span><span class="c">! end of the q-loop</span>
<span class="w">              </span><span class="mi">2203</span><span class="w"> </span><span class="k">continue</span>
<span class="k">                          </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapp</span>
<span class="w">                       </span><span class="k">else</span>
<span class="k">                          if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">==</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">notrot</span><span class="w"> </span><span class="o">+</span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">jgl</span><span class="o">+</span><span class="n">kbl</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jgl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="o">&lt;</span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="n">notrot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                       </span><span class="k">end if</span>
<span class="k">                    end do </span><span class="n">loop_2100</span>
<span class="w">           </span><span class="c">! end of the p-loop</span>
<span class="w">                 </span><span class="k">end do </span><span class="n">loop_2010</span>
<span class="w">           </span><span class="c">! end of the jbc-loop</span>
<span class="w">           </span><span class="mi">2011</span><span class="w"> </span><span class="k">continue</span>
<span class="w">      </span><span class="c">! 2011 bailed out of the jbc-loop</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">igl</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">igl</span><span class="o">+</span><span class="n">kbl</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end do</span>
<span class="w">      </span><span class="c">! **</span>
<span class="w">              </span><span class="k">end do </span><span class="n">loop_2000</span>
<span class="w">      </span><span class="c">! 2000 :: end of the ibr-loop</span>
<span class="w">           </span><span class="c">! .. update sva(n)</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="o">&lt;</span><span class="n">rootbig</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="o">&gt;</span><span class="n">rootsfmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="k">                 </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_scnrm2</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                 </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zero</span>
<span class="w">                 </span><span class="n">aapp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_classq</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="n">aapp</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! additional steering devices</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">swband</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mxaapq</span><span class="o">&lt;=</span><span class="n">roottol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="n">iswrot</span><span class="o">&lt;=</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="n">swband</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">i</span><span class="o">&gt;</span><span class="n">swband</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">mxaapq</span><span class="o">&lt;</span><span class="nb">sqrt</span><span class="p">(</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="n">tol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,&amp;</span>
<span class="w">                        </span><span class="nb">KIND</span><span class="o">=</span><span class="n">sp</span><span class="p">)</span><span class="o">*</span><span class="n">mxaapq</span><span class="o">*</span><span class="n">mxsinj</span><span class="o">&lt;</span><span class="n">tol</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">1994</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">              if</span><span class="p">(</span><span class="w"> </span><span class="n">notrot</span><span class="o">&gt;=</span><span class="n">emptsw</span><span class="w"> </span><span class="p">)</span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">1994</span>
<span class="w">           </span><span class="k">end do </span><span class="n">loop_1993</span>
<span class="w">           </span><span class="c">! end i=1:nsweep loop</span>
<span class="w">       </span><span class="c">! #:( reaching this point means that the procedure has not converged.</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nsweep</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">1995</span>
<span class="w">           </span><span class="mi">1994</span><span class="w"> </span><span class="k">continue</span>
<span class="w">       </span><span class="c">! #:) reaching this point means numerical convergence after the i-th</span>
<span class="w">           </span><span class="c">! sweep.</span>
<span class="w">           </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">       </span><span class="c">! #:) info = 0 confirms successful iterations.</span>
<span class="w">       </span><span class="mi">1995</span><span class="w"> </span><span class="k">continue</span>
<span class="w">           </span><span class="c">! sort the vector sva() of column norms.</span>
<span class="w">           </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_isamax</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="o">/=</span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                 </span><span class="n">temp1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">sva</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp1</span>
<span class="w">                 </span><span class="n">aapq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="n">d</span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aapq</span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_cswap</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_cswap</span><span class="p">(</span><span class="w"> </span><span class="n">mvl</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           end do</span>
<span class="k">           return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_cgsvj1</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>df45374</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-06 10:42            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>