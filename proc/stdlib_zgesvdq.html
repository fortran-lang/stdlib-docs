<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../favicon.png">

    <title>stdlib_zgesvdq &ndash; Fortran-lang/stdlib</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran-lang/stdlib </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>Contributing and specs</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>stdlib_zgesvdq
      <small>Subroutine</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li> 
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">610 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/stdlib_linalg_lapack_z.fypp"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/stdlib_linalg_lapack_z.fypp.html'>stdlib_linalg_lapack_z.fypp</a></li>
     <li><a href='../module/stdlib_linalg_lapack_z.html'>stdlib_linalg_lapack_z</a></li>
     <li class="active">stdlib_zgesvdq</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_zgesvdq.html#src">stdlib_zgesvdq</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public subroutine stdlib_zgesvdq(joba, jobp, jobr, jobu, jobv, m, n, a, lda, s, u, ldu, v, ldv, numrank, iwork, liwork, cwork, lcwork, rwork, lrwork, info)</h2>
    

    <p>ZCGESVDQ computes the singular value decomposition (SVD) of a complex
M-by-N matrix A, where M &gt;= N. The SVD of A is written as
[++]   [xx]   [x0]   [xx]
A = U * SIGMA * V^*,  [++] = [xx] * [ox] * [xx]
[++]   [xx]
where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal
matrix, and V is an N-by-N unitary matrix. The diagonal elements
of SIGMA are the singular values of A. The columns of U and V are the
left and the right singular vectors of A, respectively.</p>

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-joba~11"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>joba</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jobp~8"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobp</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jobr~8"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobr</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jobu~18"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-jobv~20"></span>character,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>jobv</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-m~533"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>m</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-n~1423"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-a~850"></span>complex(kind=dp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>a</strong>(lda,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lda~807"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lda</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-s~107"></span>real(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>s</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-u~44"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>u</strong>(ldu,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldu~43"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-v~92"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>v</strong>(ldv,*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ldv~65"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ldv</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-numrank~4"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>numrank</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-iwork~213"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>iwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-liwork~48"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>liwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-cwork~5"></span>complex(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>cwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lcwork~2"></span>integer(kind=ilp),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lcwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-rwork~129"></span>real(kind=dp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>rwork</strong>(*)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-lrwork~20"></span>integer(kind=ilp),</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>lrwork</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-info~1131"></span>integer(kind=ilp),</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>info</strong></td><td></td>
</tr>
</tbody>
</table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/stdlib_zgesvdq.html#src">stdlib_zgesvdq</a>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="w">     </span><span class="k">subroutine </span><span class="n">stdlib_zgesvdq</span><span class="p">(</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="n">jobp</span><span class="p">,</span><span class="w"> </span><span class="n">jobr</span><span class="p">,</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">     </span><span class="c">!! ZCGESVDQ computes the singular value decomposition (SVD) of a complex</span>
<span class="w">     </span><span class="c">!! M-by-N matrix A, where M &gt;= N. The SVD of A is written as</span>
<span class="w">     </span><span class="c">!! [++]   [xx]   [x0]   [xx]</span>
<span class="w">     </span><span class="c">!! A = U * SIGMA * V^*,  [++] = [xx] * [ox] * [xx]</span>
<span class="w">     </span><span class="c">!! [++]   [xx]</span>
<span class="w">     </span><span class="c">!! where SIGMA is an N-by-N diagonal matrix, U is an M-by-N orthonormal</span>
<span class="w">     </span><span class="c">!! matrix, and V is an N-by-N unitary matrix. The diagonal elements</span>
<span class="w">     </span><span class="c">!! of SIGMA are the singular values of A. The columns of U and V are the</span>
<span class="w">     </span><span class="c">!! left and the right singular vectors of A, respectively.</span>
<span class="w">               </span><span class="n">numrank</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">liwork</span><span class="p">,</span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">lcwork</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">lrwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! Scalar Arguments </span>
<span class="w">           </span><span class="kt">character</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="n">jobp</span><span class="p">,</span><span class="w"> </span><span class="n">jobr</span><span class="p">,</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="n">jobv</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">liwork</span><span class="p">,</span><span class="w"> </span><span class="n">lrwork</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">numrank</span><span class="p">,</span><span class="w"> </span><span class="n">info</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lcwork</span>
<span class="w">           </span><span class="c">! Array Arguments </span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">lda</span><span class="p">,</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">ldu</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">ldv</span><span class="p">,</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<span class="w">        </span><span class="c">! =====================================================================</span>
<span class="w">           </span>
<span class="w">           </span>
<span class="w">           </span><span class="c">! Local Scalars </span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">optratio</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">q</span>
<span class="w">           </span><span class="kt">integer</span><span class="p">(</span><span class="n">ilp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgelqf</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd2</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">           </span><span class="n">lwrk_zgeqrf</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zunmlq</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zunmqr</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zunmqr2</span><span class="p">,</span><span class="w"> </span><span class="n">lwlqf</span><span class="p">,</span><span class="w"> </span><span class="n">lwqrf</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="n">lwunq</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq2</span><span class="p">,</span><span class="w"> </span><span class="n">lwunlq</span><span class="p">,</span><span class="w"> </span><span class="n">minwrk</span><span class="p">,</span><span class="w"> </span><span class="n">minwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">optwrk</span><span class="p">,</span><span class="w"> </span><span class="n">optwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">iminwrk</span><span class="p">,</span><span class="w"> </span><span class="n">rminwrk</span>
<span class="w">           </span><span class="kt">logical</span><span class="p">(</span><span class="n">lk</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">accla</span><span class="p">,</span><span class="w"> </span><span class="n">acclm</span><span class="p">,</span><span class="w"> </span><span class="n">acclh</span><span class="p">,</span><span class="w"> </span><span class="n">ascaled</span><span class="p">,</span><span class="w"> </span><span class="n">conda</span><span class="p">,</span><span class="w"> </span><span class="n">dntwu</span><span class="p">,</span><span class="w"> </span><span class="n">dntwv</span><span class="p">,</span><span class="w"> </span><span class="n">lquery</span><span class="p">,</span><span class="w"> </span><span class="n">lsvc0</span><span class="p">,</span><span class="w"> </span><span class="n">lsvec</span><span class="p">,&amp;</span>
<span class="w">                      </span><span class="n">rowprm</span><span class="p">,</span><span class="w"> </span><span class="n">rsvec</span><span class="p">,</span><span class="w"> </span><span class="n">rtrans</span><span class="p">,</span><span class="w"> </span><span class="n">wntua</span><span class="p">,</span><span class="w"> </span><span class="n">wntuf</span><span class="p">,</span><span class="w"> </span><span class="n">wntur</span><span class="p">,</span><span class="w"> </span><span class="n">wntus</span><span class="p">,</span><span class="w"> </span><span class="n">wntva</span><span class="p">,</span><span class="w"> </span><span class="n">wntvr</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">big</span><span class="p">,</span><span class="w"> </span><span class="n">epsln</span><span class="p">,</span><span class="w"> </span><span class="n">rtmp</span><span class="p">,</span><span class="w"> </span><span class="n">sconda</span><span class="p">,</span><span class="w"> </span><span class="n">sfmin</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">           </span><span class="c">! Local Arrays</span>
<span class="w">           </span><span class="kt">complex</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="c">! Intrinsic Functions </span>
<span class="w">           </span><span class="k">intrinsic</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">abs</span><span class="p">,</span><span class="nb">conjg</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span><span class="nb">min</span><span class="p">,</span><span class="kt">real</span><span class="p">,</span><span class="nb">sqrt</span>
<span class="w">           </span><span class="c">! Executable Statements </span>
<span class="w">           </span><span class="c">! test the input arguments</span>
<span class="w">           </span><span class="n">wntus</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wntur</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;R&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wntua</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wntuf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;F&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">lsvc0</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">wntus</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntur</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntua</span>
<span class="w">           </span><span class="n">lsvec</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">lsvc0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntuf</span>
<span class="w">           </span><span class="n">dntwu</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobu</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wntvr</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;R&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">wntva</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;V&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">rsvec</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">wntvr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntva</span>
<span class="w">           </span><span class="n">dntwv</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">accla</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">acclm</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;M&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">conda</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;E&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">acclh</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">joba</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;H&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">conda</span>
<span class="w">           </span><span class="n">rowprm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobp</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;P&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="n">rtrans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobr</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;T&#39;</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">iminwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">rminwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">else</span>
<span class="k">              </span><span class="n">iminwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">rminwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="o">*</span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           </span><span class="n">lquery</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">liwork</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">lcwork</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">lrwork</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">           </span><span class="n">info</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">accla</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">acclm</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">acclh</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobp</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">stdlib_lsame</span><span class="p">(</span><span class="w"> </span><span class="n">jobr</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">3</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">dntwu</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">4</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntur</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">dntwv</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">5</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">6</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&lt;</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">&gt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lda</span><span class="o">&lt;</span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ldu</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lsvc0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldu</span><span class="o">&lt;</span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="n">wntuf</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldu</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">12</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ldv</span><span class="o">&lt;</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldv</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ldv</span><span class="o">&lt;</span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">14</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">liwork</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">iminwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">17</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! Compute The Minimal And The Optimal Workspace Lengths</span>
<span class="w">              </span><span class="c">! [[the expressions for computing the minimal and the optimal</span>
<span class="w">              </span><span class="c">! values of lcwork are written with a lot of redundancy and</span>
<span class="w">              </span><span class="c">! can be simplified. however, this detailed form is easier for</span>
<span class="w">              </span><span class="c">! maintenance and modifications of the code.]]</span>
<span class="w">              </span><span class="c">! Minimal Workspace Length For Stdlib_Zgeqp3 Of An M X N Matrix</span>
<span class="w">              </span><span class="n">lwqp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="mi">1</span>
<span class="w">              </span><span class="c">! Minimal Workspace Length For Stdlib_Zunmqr To Build Left Singular Vectors</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntus</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntur</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">lwunq</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntua</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  </span><span class="n">lwunq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">              </span><span class="c">! Minimal Workspace Length For Stdlib_Zpocon Of An N X N Matrix</span>
<span class="w">              </span><span class="n">lwcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span>
<span class="w">              </span><span class="c">! Stdlib_Zgesvd Of An N X N Matrix</span>
<span class="w">              </span><span class="n">lwsvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">stdlib_zgeqp3</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span>
<span class="w">                  </span><span class="n">lwrk_zgeqp3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntus</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntur</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="n">lwrk_zunmqr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                  </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntua</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="n">lwrk_zunmqr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                      </span><span class="n">lwrk_zunmqr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="k">              </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">              </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">lsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! Minimal And Optimal Sizes Of The Complex Workspace If</span>
<span class="w">                  </span><span class="c">! only the singular values are requested</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                     </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                         </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">else</span>
<span class="k">                         </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">+</span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                  end if</span>
<span class="k">              else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">rsvec</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! Minimal And Optimal Sizes Of The Complex Workspace If The</span>
<span class="w">                  </span><span class="c">! singular values and the left singular vectors are requested</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">else</span>
<span class="k">                        call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">end if</span>
<span class="k">                     </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                         </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="p">,</span><span class="n">lwrk_zunmqr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">else</span>
<span class="k">                         </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="p">,</span><span class="n">lwrk_zunmqr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">end if</span>
<span class="k">                  end if</span>
<span class="k">              else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">lsvec</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! Minimal And Optimal Sizes Of The Complex Workspace If The</span>
<span class="w">                  </span><span class="c">! singular values and the right singular vectors are requested</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">else</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">else</span>
<span class="k">                          call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="p">&amp;</span>
<span class="w">                                    </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                      </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">else</span>
<span class="k">                          </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                  end if</span>
<span class="k">              else</span>
<span class="w">                  </span><span class="c">! Minimal And Optimal Sizes Of The Complex Workspace If The</span>
<span class="w">                  </span><span class="c">! full svd is requested</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                         </span><span class="c">! .. minimal workspace length for n x n/2 stdlib_zgeqrf</span>
<span class="w">                         </span><span class="n">lwqrf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="c">! .. minimal workspace length for n/2 x n/2 stdlib_zgesvd</span>
<span class="w">                         </span><span class="n">lwsvd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">lwunq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwqrf</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwsvd2</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwunq2</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">minwrk2</span>
<span class="w">                         </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk</span><span class="p">,</span><span class="w"> </span><span class="n">minwrk2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                  else</span>
<span class="k">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">lwsvd</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">n</span>
<span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                         </span><span class="c">! .. minimal workspace length for n/2 x n stdlib_zgelqf</span>
<span class="w">                         </span><span class="n">lwlqf</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">lwsvd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">lwunlq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwqp3</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwlqf</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwsvd2</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwunlq</span><span class="p">,</span><span class="w"> </span><span class="n">lwunq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="n">minwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">minwrk2</span>
<span class="w">                         </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">minwrk</span><span class="p">,</span><span class="w"> </span><span class="n">minwrk2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">end if</span>
<span class="k">                  end if</span>
<span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                        </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="n">lwrk_zgesvd</span><span class="p">,</span><span class="n">lwrk_zunmqr</span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">optwrk</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                            call </span><span class="n">stdlib_zgeqrf</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="n">cdummy</span><span class="p">,</span><span class="n">cdummy</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                            </span><span class="n">lwrk_zgeqrf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                            </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,&amp;</span>
<span class="w">                                       </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="n">lwrk_zgesvd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                            </span><span class="k">call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="n">lwrk_zunmqr2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                            </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwrk_zgeqrf</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwrk_zgesvd2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="p">&amp;</span>
<span class="w">                                      </span><span class="n">lwrk_zunmqr2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">optwrk2</span>
<span class="w">                            </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk</span><span class="p">,</span><span class="w"> </span><span class="n">optwrk2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                     else</span>
<span class="k">                        call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="n">lwrk_zgesvd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                        </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="n">lwrk_zgesvd</span><span class="p">,</span><span class="n">lwrk_zunmqr</span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">optwrk</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                           call </span><span class="n">stdlib_zgelqf</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="n">cdummy</span><span class="p">,</span><span class="n">cdummy</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                           </span><span class="n">lwrk_zgelqf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                           </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,&amp;</span>
<span class="w">                                      </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rdummy</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span><span class="n">lwrk_zgesvd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                           </span><span class="k">call </span><span class="n">stdlib_zunmlq</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cdummy</span><span class="p">,&amp;</span>
<span class="w">                                     </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span><span class="n">lwrk_zunmlq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">int</span><span class="p">(</span><span class="w"> </span><span class="n">cdummy</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="nb">KIND</span><span class="o">=</span><span class="n">ilp</span><span class="p">)</span>
<span class="w">                           </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">lwrk_zgeqp3</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwrk_zgelqf</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">lwrk_zgesvd2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="p">&amp;</span>
<span class="w">                                     </span><span class="n">lwrk_zunmlq</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk2</span><span class="p">,</span><span class="w"> </span><span class="n">lwcon</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span><span class="n">optwrk2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">optwrk2</span>
<span class="w">                            </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="n">optwrk</span><span class="p">,</span><span class="w"> </span><span class="n">optwrk2</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="k">end if</span>
<span class="k">                     end if</span>
<span class="k">                  end if</span>
<span class="k">              end if</span>
<span class="k">              </span><span class="n">minwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="n">optwrk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">max</span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">optwrk</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lcwork</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">minwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">lquery</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">19</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="w"> </span><span class="p">(</span><span class="n">info</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">lrwork</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">rminwrk</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">lquery</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">21</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="p">(</span><span class="w"> </span><span class="n">info</span><span class="o">/=</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;ZGESVDQ&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lquery</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">           </span><span class="c">! return optimal workspace</span>
<span class="w">               </span><span class="n">iwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iminwrk</span>
<span class="w">               </span><span class="n">cwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">optwrk</span>
<span class="w">               </span><span class="n">cwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">minwrk</span>
<span class="w">               </span><span class="n">rwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rminwrk</span>
<span class="w">               </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! quick return if the matrix is void.</span>
<span class="w">           </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="o">==</span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">           </span><span class="c">! All Output Is Void</span>
<span class="w">              </span><span class="k">return</span>
<span class="k">           end if</span>
<span class="k">           </span><span class="n">big</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="w">           </span><span class="n">ascaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! Reordering The Rows In Decreasing Sequence In The</span>
<span class="w">                 </span><span class="c">! ell-infinity norm - this enhances numerical robustness in</span>
<span class="w">                 </span><span class="c">! the case of differently scaled rows.</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span>
<span class="w">                     </span><span class="c">! rwork(p) = abs( a(p,stdlib_izamax(n,a(p,1),lda)) )</span>
<span class="w">                     </span><span class="c">! [[stdlib_zlange will return nan if an entry of the p-th row is nan]]</span>
<span class="w">                     </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_zlange</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">rdummy</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="c">! .. check for nan&#39;s and inf&#39;s</span>
<span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="p">(</span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                         </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span>
<span class="w">                         </span><span class="k">call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;ZGESVDQ&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                         </span><span class="k">return</span>
<span class="k">                     end if</span>
<span class="k">                 end do</span>
<span class="k">                 do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_idamax</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                 </span><span class="n">iwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">rtmp</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">                    </span><span class="n">rwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="w">                    </span><span class="n">rwork</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rtmp</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 end do</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                    </span><span class="c">! quick return: a is the m x n zero matrix.</span>
<span class="w">                    </span><span class="n">numrank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_dlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntus</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntua</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntva</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">cone</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                        </span><span class="n">iwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                            </span><span class="n">iwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                    end if</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="n">rwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">                 end if</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">big</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                     </span><span class="c">! .. to prevent overflow in the qr factorization, scale the</span>
<span class="w">                     </span><span class="c">! matrix by 1/sqrt(m) if too large entry detected</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zlascl</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)),</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                               </span>
<span class="w">                     </span><span class="n">ascaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">                 call </span><span class="n">stdlib_zlaswp</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">          </span><span class="c">! .. at this stage, preemptive scaling is done only to avoid column</span>
<span class="w">          </span><span class="c">! norms overflows during the qr factorization. the svd procedure should</span>
<span class="w">          </span><span class="c">! have its own scaling to save the singular values from overflows and</span>
<span class="w">          </span><span class="c">! underflows. that depends on the svd procedure.</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">rowprm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">rtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_zlange</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtmp</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">rtmp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="p">(</span><span class="n">rtmp</span><span class="o">*</span><span class="n">zero</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    </span><span class="n">info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_xerbla</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;ZGESVDQ&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">return</span>
<span class="k">               end if</span>
<span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtmp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">big</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                   </span><span class="c">! .. to prevent overflow in the qr factorization, scale the</span>
<span class="w">                   </span><span class="c">! matrix by 1/sqrt(m) if too large entry detected</span>
<span class="w">                   </span><span class="k">call </span><span class="n">stdlib_zlascl</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)),</span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                             </span>
<span class="w">                   </span><span class="n">ascaled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">           end if</span>
<span class="w">           </span><span class="c">! Qr Factorization With Column Pivoting</span>
<span class="w">           </span><span class="c">! a * p = q * [ r ]</span>
<span class="w">                       </span><span class="c">! [ 0 ]</span>
<span class="w">           </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">              </span><span class="c">! All Columns Are Free Columns</span>
<span class="w">              </span><span class="n">iwork</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">           call </span><span class="n">stdlib_zgeqp3</span><span class="p">(</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span>
<span class="w">          </span><span class="c">! if the user requested accuracy level allows truncation in the</span>
<span class="w">          </span><span class="c">! computed upper triangular factor, the matrix r is examined and,</span>
<span class="w">          </span><span class="c">! if possible, replaced with its leading upper trapezoidal part.</span>
<span class="w">           </span><span class="n">epsln</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="w">           </span><span class="n">sfmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dlamch</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
<span class="w">           </span><span class="c">! small = sfmin / epsln</span>
<span class="w">           </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">accla</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! standard absolute error bound suffices. all sigma_i with</span>
<span class="w">              </span><span class="c">! sigma_i &lt; n*eps*||a||_f are flushed to zero. this is an</span>
<span class="w">              </span><span class="c">! aggressive enforcement of lower numerical rank by introducing a</span>
<span class="w">              </span><span class="c">! backward error of the order of n*eps*||a||_f.</span>
<span class="w">              </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="n">rtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">))</span><span class="o">*</span><span class="n">epsln</span>
<span class="w">              </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">rtmp</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">3002</span>
<span class="w">                    </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">              </span><span class="mi">3002</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">acclm</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">              </span><span class="c">! .. similarly as above, only slightly more gentle (less aggressive).</span>
<span class="w">              </span><span class="c">! sudden drop on the diagonal of r is used as the criterion for being</span>
<span class="w">              </span><span class="c">! close-to-rank-deficient. the threshold is set to epsln=stdlib_dlamch(&#39;e&#39;).</span>
<span class="w">              </span><span class="c">! [[this can be made more flexible by replacing this hard-coded value</span>
<span class="w">              </span><span class="c">! with a user specified threshold.]] also, the values that underflow</span>
<span class="w">              </span><span class="c">! will be truncated.</span>
<span class="w">              </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="p">(</span><span class="n">epsln</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sfmin</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">go</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">to</span><span class="w"> </span><span class="mi">3402</span>
<span class="w">                 </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">              </span><span class="mi">3402</span><span class="w"> </span><span class="k">continue</span>
<span class="k">           else</span>
<span class="w">              </span><span class="c">! Rrqr Not Authorized To Determine Numerical Rank Except In The</span>
<span class="w">              </span><span class="c">! obvious case of zero pivots.</span>
<span class="w">              </span><span class="c">! .. inspect r for exact zeros on the diagonal;</span>
<span class="w">              </span><span class="c">! r(i,i)=0 =&gt; r(i:n,i:n)=0.</span>
<span class="w">              </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">3502</span>
<span class="w">                 </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">              </span><span class="k">end do</span>
<span class="k">              </span><span class="mi">3502</span><span class="w"> </span><span class="k">continue</span>
<span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                 </span><span class="c">! estimate the scaled condition number of a. use the fact that it is</span>
<span class="w">                 </span><span class="c">! the same as the scaled condition number of r.</span>
<span class="w">                    </span><span class="c">! V Is Used As Workspace</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="c">! only the leading nr x nr submatrix of the triangular factor</span>
<span class="w">                    </span><span class="c">! is considered. only if nr=n will this give a reliable error</span>
<span class="w">                    </span><span class="c">! bound. however, even for nr &lt; n, this can be used on an</span>
<span class="w">                    </span><span class="c">! expert level and obtain useful information in the sense of</span>
<span class="w">                    </span><span class="c">! perturbation theory.</span>
<span class="w">                    </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                       </span><span class="n">rtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stdlib_dznrm2</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zdscal</span><span class="p">(</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="o">/</span><span class="n">rtmp</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        call </span><span class="n">stdlib_zpocon</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">rtmp</span><span class="p">,</span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                  </span>
<span class="w">                    </span><span class="k">else</span>
<span class="k">                        call </span><span class="n">stdlib_zpocon</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="w"> </span><span class="n">rtmp</span><span class="p">,</span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                  </span>
<span class="w">                    </span><span class="k">end if</span>
<span class="k">                    </span><span class="n">sconda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="n">rtmp</span><span class="p">)</span>
<span class="w">                 </span><span class="c">! for nr=n, sconda is an estimate of sqrt(||(r^* * r)^(-1)||_1),</span>
<span class="w">                 </span><span class="c">! n^(-1/4) * sconda &lt;= ||r^(-1)||_2 &lt;= n^(1/4) * sconda</span>
<span class="w">                 </span><span class="c">! see the reference [1] for more details.</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           endif</span>
<span class="k">           if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntur</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntus</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">wntuf</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntua</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">               </span><span class="n">n1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">           </span><span class="k">end if</span>
<span class="k">           if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">              </span><span class="c">! Only The Singular Values Are Requested</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">               </span><span class="c">! .. compute the singular values of r**h = [a](1:nr,1:n)**h</span>
<span class="w">                 </span><span class="c">! .. set the lower triangle of [a] to [a](1:nr,1:n)**h and</span>
<span class="w">                 </span><span class="c">! the upper triangle of [a] to zero.</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                    </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">a</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">czero</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end do</span>
<span class="k">                 call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">lcwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">else</span>
<span class="w">                 </span><span class="c">! .. compute the singular values of r = [a](1:nr,1:n)</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lda</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span>
<span class="w">                 </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">lcwork</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                           </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">           else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">rsvec</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">             </span><span class="c">! The Singular Values And The Left Singular Vectors Requested</span>
<span class="w">      </span><span class="c">! .......................................................................&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! .. apply stdlib_zgesvd to r**h</span>
<span class="w">                  </span><span class="c">! .. copy r**h into [u] and overwrite [u] with the right singular</span>
<span class="w">                  </span><span class="c">! vectors of r</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                    </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end do</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span>
<span class="w">                 </span><span class="c">! .. the left singular vectors not computed, the nr right singular</span>
<span class="w">                 </span><span class="c">! vectors overwrite [u](1:nr,1:nr) as conjugate transposed. these</span>
<span class="w">                 </span><span class="c">! will be pre-multiplied by q to build the left singular vectors of a.</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                        </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                        </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                    end do</span>
<span class="k">              else</span>
<span class="w">                  </span><span class="c">! Apply Stdlib_Zgesvd To R</span>
<span class="w">                  </span><span class="c">! .. copy r into [u] and overwrite [u] with the left singular vectors</span>
<span class="w">                  </span><span class="k">call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span>
<span class="w">                  </span><span class="c">! .. the right singular vectors not computed, the nr left singular</span>
<span class="w">                  </span><span class="c">! vectors overwrite [u](1:nr,1:nr)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="c">! .. now [u](1:nr,1:nr) contains the nr left singular vectors of</span>
<span class="w">                     </span><span class="c">! r. these will be pre-multiplied by q to build the left singular</span>
<span class="w">                     </span><span class="c">! vectors of a.</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">                 </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                    </span><span class="c">! (m x nr) or (m x n) or (m x m).</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="k">              end if</span>
<span class="w">                 </span><span class="c">! the q matrix from the first qrf is built into the left singular</span>
<span class="w">                 </span><span class="c">! vectors matrix u.</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaswp</span><span class="p">(</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rsvec</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">lsvec</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">             </span><span class="c">! The Singular Values And The Right Singular Vectors Requested</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! .. apply stdlib_zgesvd to r**h</span>
<span class="w">                  </span><span class="c">! .. copy r**h into v and overwrite v with the left singular vectors</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                    </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end do</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span>
<span class="w">                 </span><span class="c">! .. the left singular vectors of r**h overwrite v, the right singular</span>
<span class="w">                 </span><span class="c">! vectors not computed</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntvr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                    call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                        </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                        </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                    end do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                               </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                    end if</span>
<span class="k">                    call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">else</span>
<span class="w">                     </span><span class="c">! .. need all n right singular vectors and nr &lt; n</span>
<span class="w">                     </span><span class="c">! [!] this is simple implementation that augments [v](1:n,1:nr)</span>
<span class="w">                     </span><span class="c">! by padding a zero block. in the case nr &lt;&lt; n, a more efficient</span>
<span class="w">                     </span><span class="c">! way is to first use the qr factorization. for more details</span>
<span class="w">                     </span><span class="c">! how to implement this, see the &quot; full svd &quot; branch.</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                        </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                        </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                           </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                     end do</span>
<span class="k">                     call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                 </span><span class="k">end if</span>
<span class="k">               else</span>
<span class="w">                  </span><span class="c">! Aply Stdlib_Zgesvd To R</span>
<span class="w">                  </span><span class="c">! Copy R Into V And Overwrite V With The Right Singular Vectors</span>
<span class="w">                  </span><span class="k">call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                            </span>
<span class="w">                  </span><span class="c">! .. the right singular vectors overwrite v, the nr left singular</span>
<span class="w">                  </span><span class="c">! vectors stored in u(1:nr,1:nr)</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntvr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                     call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="c">! .. now [v](1:nr,1:n) contains v(1:n,1:nr)**h</span>
<span class="w">                  </span><span class="k">else</span>
<span class="w">                     </span><span class="c">! .. need all n right singular vectors and nr &lt; n</span>
<span class="w">                     </span><span class="c">! [!] this is simple implementation that augments [v](1:nr,1:n)</span>
<span class="w">                     </span><span class="c">! by padding a zero block. in the case nr &lt;&lt; n, a more efficient</span>
<span class="w">                     </span><span class="c">! way is to first use the lq factorization. for more details</span>
<span class="w">                     </span><span class="c">! how to implement this, see the &quot; full svd &quot; branch.</span>
<span class="w">                      </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                      </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                      </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                  </span><span class="k">end if</span>
<span class="w">                  </span><span class="c">! .. now [v] contains the adjoint of the matrix of the right singular</span>
<span class="w">                  </span><span class="c">! vectors of a.</span>
<span class="w">               </span><span class="k">end if</span>
<span class="k">           else</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">             </span><span class="c">! Full Svd Requested</span>
<span class="w">      </span><span class="c">! .......................................................................</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rtrans</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! .. apply stdlib_zgesvd to r**h [[this option is left for r</span>
<span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntvr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">! .. copy r**h into [v] and overwrite [v] with the left singular</span>
<span class="w">                  </span><span class="c">! vectors of r**h</span>
<span class="w">                 </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                    </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                       </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                    </span><span class="k">end do</span>
<span class="k">                 end do</span>
<span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span>
<span class="w">                 </span><span class="c">! .. the left singular vectors of r**h overwrite [v], the nr right</span>
<span class="w">                 </span><span class="c">! singular vectors of r**h stored in [u](1:nr,1:nr) as conjugate</span>
<span class="w">                 </span><span class="c">! transposed</span>
<span class="w">                    </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="c">! Assemble V</span>
<span class="w">                    </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                       </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                       </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                          </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                          </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                          </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                       </span><span class="k">end do</span>
<span class="k">                    end do</span>
<span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                              </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                    end if</span>
<span class="k">                    call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                        </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                        </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                        </span><span class="k">end do</span>
<span class="k">                     end do</span>
<span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                       </span><span class="k">end if</span>
<span class="k">                    end if</span>
<span class="k">                 else</span>
<span class="w">                     </span><span class="c">! .. need all n right singular vectors and nr &lt; n</span>
<span class="w">                  </span><span class="c">! .. copy r**h into [v] and overwrite [v] with the left singular</span>
<span class="w">                  </span><span class="c">! vectors of r**h</span>
<span class="w">                     </span><span class="c">! [[the optimal ratio n/nr for using qrf instead of padding</span>
<span class="w">                       </span><span class="c">! with zeros. here hard coded to 2; it must be at least</span>
<span class="w">                       </span><span class="c">! two due to work space constraints.]]</span>
<span class="w">                     </span><span class="c">! optratio = stdlib_ilaenv(6, &#39;zgesvd&#39;, &#39;s&#39; // &#39;o&#39;, nr,n,0,0)</span>
<span class="w">                     </span><span class="c">! optratio = max( optratio, 2 )</span>
<span class="w">                     </span><span class="n">optratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">optratio</span><span class="o">*</span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                        do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                              </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                                  </span>
<span class="w">                        </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                        </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                           </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                              </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                              </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                              </span><span class="n">v</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                        call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                    </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                    </span><span class="c">! (m x n1), i.e. (m x n) or (m x m).</span>
<span class="w">                        </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                           </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                              </span><span class="n">ctmp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="w">                              </span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                              </span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ctmp</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                           call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                             call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                             </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span><span class="k">end if</span>
<span class="k">                        end if</span>
<span class="k">                     else</span>
<span class="w">                        </span><span class="c">! .. copy r**h into [u] and overwrite [u] with the right</span>
<span class="w">                        </span><span class="c">! singular vectors of r</span>
<span class="w">                        </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                              </span><span class="n">u</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
<span class="w">                           </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">2</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                                  </span>
<span class="w">                        </span><span class="k">call </span><span class="n">stdlib_zgeqrf</span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                  </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                        </span><span class="k">do </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span>
<span class="w">                            </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span>
<span class="w">                                </span><span class="n">v</span><span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">conjg</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="n">q</span><span class="p">))</span>
<span class="w">                            </span><span class="k">end do</span>
<span class="k">                        end do</span>
<span class="k">                       call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nr</span><span class="o">+</span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="mi">1</span><span class="p">),</span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">v</span><span class="p">,</span><span class="n">ldv</span><span class="p">,&amp;</span>
<span class="w">                                 </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                       </span><span class="c">! (m x nr) or (m x n) or (m x m).</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">end if</span>
<span class="k">                       end if</span>
<span class="k">                     end if</span>
<span class="k">                 end if</span>
<span class="k">              else</span>
<span class="w">                  </span><span class="c">! .. apply stdlib_zgesvd to r [[this is the recommended option]]</span>
<span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">wntvr</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                      </span><span class="c">! .. copy r into [v] and overwrite v with the right singular vectors</span>
<span class="w">                      </span><span class="k">call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                               </span>
<span class="w">                     </span><span class="c">! .. the right singular vectors of r overwrite [v], the nr left</span>
<span class="w">                     </span><span class="c">! singular vectors of r stored in [u](1:nr,1:nr)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                               </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="c">! .. now [v](1:nr,1:n) contains v(1:n,1:nr)**h</span>
<span class="w">                     </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                    </span><span class="c">! (m x nr) or (m x n) or (m x m).</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                       </span><span class="k">end if</span>
<span class="k">                    end if</span>
<span class="k">                  else</span>
<span class="w">                    </span><span class="c">! .. need all n right singular vectors and nr &lt; n</span>
<span class="w">                    </span><span class="c">! The Requested Number Of The Left Singular Vectors</span>
<span class="w">                     </span><span class="c">! is then n1 (n or m)</span>
<span class="w">                     </span><span class="c">! [[the optimal ratio n/nr for using lq instead of padding</span>
<span class="w">                       </span><span class="c">! with zeros. here hard coded to 2; it must be at least</span>
<span class="w">                       </span><span class="c">! two due to work space constraints.]]</span>
<span class="w">                     </span><span class="c">! optratio = stdlib_ilaenv(6, &#39;zgesvd&#39;, &#39;s&#39; // &#39;o&#39;, nr,n,0,0)</span>
<span class="w">                     </span><span class="c">! optratio = max( optratio, 2 )</span>
<span class="w">                    </span><span class="n">optratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">optratio</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                       call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                                 </span>
<span class="w">                    </span><span class="c">! .. the right singular vectors of r overwrite [v], the nr left</span>
<span class="w">                       </span><span class="c">! singular vectors of r stored in [u](1:nr,1:nr)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="c">! .. now [v] contains the adjoint of the matrix of the right</span>
<span class="w">                       </span><span class="c">! singular vectors of a. the leading n left singular vectors</span>
<span class="w">                       </span><span class="c">! are in [u](1:n,1:n)</span>
<span class="w">                       </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                       </span><span class="c">! (m x n1), i.e. (m x n) or (m x m).</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                           call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                             call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                             </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                           </span><span class="k">end if</span>
<span class="k">                       end if</span>
<span class="k">                    else</span>
<span class="k">                       call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                                 </span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zgelqf</span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlacpy</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                                 </span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zgesvd</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nr</span><span class="o">+</span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="w"> </span><span class="n">rwork</span><span class="p">,</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">v</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldv</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zunmlq</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">,</span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="p">&amp;</span>
<span class="w">                                 </span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">                       </span><span class="k">call </span><span class="n">stdlib_zlapmt</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">ldv</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="w"> </span><span class="p">)</span>
<span class="w">                     </span><span class="c">! Assemble The Left Singular Vector Matrix U Of Dimensions</span>
<span class="w">                    </span><span class="c">! (m x nr) or (m x n) or (m x m).</span>
<span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.(</span><span class="n">wntuf</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                          call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">ldu</span><span class="p">)</span>
<span class="w">                          </span><span class="k">call </span><span class="n">stdlib_zlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">m</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">n1</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="n">czero</span><span class="p">,</span><span class="n">cone</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">ldu</span><span class="w"> </span><span class="p">)</span>
<span class="w">                                    </span>
<span class="w">                          </span><span class="k">end if</span>
<span class="k">                       end if</span>
<span class="k">                    end if</span>
<span class="k">                  end if</span>
<span class="w">              </span><span class="c">! .. end of the &quot;r**h or r&quot; branch</span>
<span class="w">              </span><span class="k">end if</span>
<span class="w">                 </span><span class="c">! the q matrix from the first qrf is built into the left singular</span>
<span class="w">                 </span><span class="c">! vectors matrix u.</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zunmqr</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">lda</span><span class="p">,</span><span class="w"> </span><span class="n">cwork</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">cwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">lcwork</span><span class="o">-</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">)</span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">rowprm</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">wntuf</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_zlaswp</span><span class="p">(</span><span class="w"> </span><span class="n">n1</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">ldu</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iwork</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! ... end of the &quot;full svd&quot; branch</span>
<span class="w">           </span><span class="k">end if</span>
<span class="w">           </span><span class="c">! check whether some singular values are returned as zeros, e.g.</span>
<span class="w">           </span><span class="c">! due to underflow, and update the numerical rank.</span>
<span class="w">           </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span>
<span class="w">           </span><span class="k">do </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">4002</span>
<span class="w">               </span><span class="n">nr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">           </span><span class="k">end do</span>
<span class="k">           </span><span class="mi">4002</span><span class="w"> </span><span class="k">continue</span>
<span class="w">           </span><span class="c">! .. if numerical rank deficiency is detected, the truncated</span>
<span class="w">           </span><span class="c">! singular values are set to zero.</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">nr</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">stdlib_dlaset</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">nr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">zero</span><span class="p">,</span><span class="n">zero</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">nr</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">)</span>
<span class="w">           </span><span class="c">! .. undo scaling; this may cause overflow in the largest singular</span>
<span class="w">           </span><span class="c">! values.</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ascaled</span><span class="w"> </span><span class="p">)</span><span class="k">call </span><span class="n">stdlib_dlascl</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">one</span><span class="p">,</span><span class="nb">sqrt</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="nb">KIND</span><span class="o">=</span><span class="n">dp</span><span class="p">)),</span><span class="w"> </span><span class="n">nr</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ierr</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                     </span><span class="p">)</span>
<span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">conda</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">rwork</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sconda</span>
<span class="w">           </span><span class="n">rwork</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">nr</span>
<span class="w">           </span><span class="c">! .. p-nr is the number of singular values that are computed as</span>
<span class="w">           </span><span class="c">! exact zeros in stdlib_zgesvd() applied to the (possibly truncated)</span>
<span class="w">           </span><span class="c">! full row rank triangular (trapezoidal) factor of a.</span>
<span class="w">           </span><span class="n">numrank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nr</span>
<span class="w">           </span><span class="k">return</span>
<span class="k">     end subroutine </span><span class="n">stdlib_zgesvdq</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>Fortran-lang/stdlib was developed by fortran-lang/stdlib contributors<br>&copy; 2024 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>f53ad6b</small></p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2024-04-04 11:23            </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>