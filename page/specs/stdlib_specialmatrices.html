<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="A community driven standard library for (modern) Fortran">
    <meta name="author" content="fortran-lang/stdlib contributors" >
    <link rel="icon" href="../../favicon.png">

    <title>specialmatrices &ndash; Fortran-lang/stdlib</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../../css/fontawesome.min.css" rel="stylesheet">
    <link href="../../css/brands.min.css" rel="stylesheet">
    <link href="../../css/regular.min.css" rel="stylesheet">
    <link href="../../css/solid.min.css" rel="stylesheet">
    <link href="../../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../../css/local.css" rel="stylesheet">
    <link href="../../css/pygments.css" rel="stylesheet">
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">Fortran-lang/stdlib </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">Contributing and specs</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>specialmatrices</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>Contributing and specs</a></li>
                <li class="breadcrumb-item"><a href='index.html'>Specifications (specs)</a></li>
              <li class="breadcrumb-item active" aria-current="page">specialmatrices</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Contributing and specs</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link" href="../License.html">Fortran stdlib License (MIT)</a>
              <a class="nav-link" href="../changelog.html">Changelog</a>
              <a class="nav-link" href="../contributing/index.html">Contributing</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="../contributing/CodeOfConduct.html">Contributor Code of Conduct</a>
              <a class="nav-link" href="../contributing/StyleGuide.html">Style Guide</a>
              <a class="nav-link" href="../contributing/Workflow.html">Workflow for Contributors</a>

                </nav>
              <a class="nav-link" href="index.html">Specifications (specs)</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="stdlib_ansi.html">terminal colors</a>
              <a class="nav-link" href="stdlib_array.html">array</a>
              <a class="nav-link" href="stdlib_ascii.html">ascii</a>
              <a class="nav-link" href="stdlib_bitsets.html">bitsets</a>
              <a class="nav-link" href="stdlib_constants.html">constants</a>
              <a class="nav-link" href="stdlib_error.html">error</a>
              <a class="nav-link" href="stdlib_error_state_type.html">state_type</a>
              <a class="nav-link" href="stdlib_hash_procedures.html">hash</a>
              <a class="nav-link" href="stdlib_hashmaps.html">Hash maps</a>
              <a class="nav-link" href="stdlib_intrinsics.html">intrinsics</a>
              <a class="nav-link" href="stdlib_io.html">io</a>
              <a class="nav-link" href="stdlib_kinds.html">kinds</a>
              <a class="nav-link" href="stdlib_linalg.html">linalg</a>
              <a class="nav-link" href="stdlib_linalg_iterative_solvers.html">linalg_iterative_solvers</a>
              <a class="nav-link" href="stdlib_linalg_state_type.html">linalg_state_type</a>
              <a class="nav-link" href="stdlib_logger.html">logger</a>
              <a class="nav-link" href="stdlib_math.html">math</a>
              <a class="nav-link" href="stdlib_optval.html">optval</a>
              <a class="nav-link" href="stdlib_quadrature.html">quadrature</a>
              <a class="nav-link" href="stdlib_random.html">random</a>
              <a class="nav-link" href="stdlib_selection.html">selection</a>
              <a class="nav-link" href="stdlib_sorting.html">sorting</a>
              <a class="nav-link" href="stdlib_sparse.html">sparse</a>
              <a class="nav-link" href="stdlib_specialfunctions.html">specialfunctions</a>
              <a class="nav-link" href="stdlib_specialfunctions_activations.html">specialfunctions_activations</a>
              <a class="nav-link" href="stdlib_specialfunctions_gamma.html">specialfunctions_gamma</a>
              <a class="nav-link active disabled" href="stdlib_specialmatrices.html">specialmatrices</a>
              <a class="nav-link" href="stdlib_stats.html">stats</a>
              <a class="nav-link" href="stdlib_stats_distribution_exponential.html">stats_distribution_exponential</a>
              <a class="nav-link" href="stdlib_stats_distribution_normal.html">stats_distribution_normal</a>
              <a class="nav-link" href="stdlib_stats_distribution_uniform.html">stats_distribution_uniform</a>
              <a class="nav-link" href="stdlib_str2num.html">str2num</a>
              <a class="nav-link" href="stdlib_string_type.html">string_type</a>
              <a class="nav-link" href="stdlib_stringlist_type.html">stringlist_type</a>
              <a class="nav-link" href="stdlib_strings.html">strings</a>
              <a class="nav-link" href="stdlib_system.html">system</a>
              <a class="nav-link" href="stdlib_version.html">version</a>

                </nav>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <h1 id="the-stdlib_specialmatrices-module">The <code>stdlib_specialmatrices</code> module</h1>
<div class="toc">
<ul>
<li><a href="#the-stdlib_specialmatrices-module">The stdlib_specialmatrices module</a><ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#list-of-derived-types-for-special-matrices">List of derived types for special matrices</a><ul>
<li><a href="#Tridiagonal">Tridiagonal matrices</a><ul>
<li><a href="#status">Status</a></li>
<li><a href="#description">Description</a></li>
<li><a href="#syntax">Syntax</a></li>
<li><a href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#specialized-drivers-for-linear-algebra-tasks">Specialized drivers for linear algebra tasks</a><ul>
<li><a href="#spmv">Matrix-vector products with spmv</a><ul>
<li><a href="#status_1">Status</a></li>
<li><a href="#description_1">Description</a></li>
<li><a href="#syntax_1">Syntax</a></li>
<li><a href="#arguments">Arguments</a></li>
<li><a href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#utility-functions">Utility functions</a><ul>
<li><a href="#dense">dense : converting a special matrix to a standard Fortran array</a><ul>
<li><a href="#status_2">Status</a></li>
<li><a href="#description_2">Description</a></li>
<li><a href="#syntax_2">Syntax</a></li>
<li><a href="#arguments_1">Arguments</a></li>
</ul>
</li>
<li><a href="#transpose">transpose : Transposition of a special matrix</a><ul>
<li><a href="#status_3">Status</a></li>
<li><a href="#description_3">Description</a></li>
<li><a href="#syntax_3">Syntax</a></li>
<li><a href="#arguments_2">Arguments</a></li>
</ul>
</li>
<li><a href="#hermitian">hermitian : Complex-conjugate transpose of a special matrix</a><ul>
<li><a href="#status_4">Status</a></li>
<li><a href="#description_4">Description</a></li>
<li><a href="#syntax_4">Syntax</a></li>
<li><a href="#arguments_3">Arguments</a></li>
</ul>
</li>
<li><a href="#operators">Operator overloading (+, -, *)</a><ul>
<li><a href="#status_5">Status</a></li>
<li><a href="#description_5">Description</a></li>
<li><a href="#syntax_5">Syntax</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="introduction">Introduction</h2>
<p>The <code>stdlib_specialmatrices</code> module provides derived types and specialized drivers for highly structured matrices often encountered in scientific computing as well as control and signal processing applications.
These include:</p>
<ul>
<li>Tridiagonal matrices</li>
<li>Symmetric Tridiagonal matrices (not yet supported)</li>
<li>Circulant matrices (not yet supported)</li>
<li>Toeplitz matrices (not yet supported)</li>
<li>Hankel matrices (not yet supported)</li>
</ul>
<p>In addition, it also provides a <code>Poisson2D</code> matrix type (not yet supported) corresponding to the sparse block tridiagonal matrix obtained from discretizing the Laplace operator on a 2D grid with the standard second-order accurate central finite-difference scheme.</p>
<h2 id="list-of-derived-types-for-special-matrices">List of derived types for special matrices</h2>
<p>Below is a list of the currently supported derived types corresponding to different special matrices.
Note that this module is under active development and this list will eventually grow.</p>
<h3 id="Tridiagonal">Tridiagonal matrices</h3>
<h4 id="status">Status</h4>
<p>Experimental</p>
<h4 id="description">Description</h4>
<p>Tridiagonal matrices are ubiquituous in scientific computing and often appear when discretizing 1D differential operators.
A generic tridiagonal matrix has the following structure:
<script type="math/tex; mode=display">
    A
    =
    \begin{bmatrix}
        a_1 &  b_1  \\
        c_1 &  a_2      &  b_2  \\
            &  \ddots   &  \ddots   &  \ddots   \\
            &           &  c_{n-2} &  a_{n-1}  &  b_{n-1} \\
            &           &           &  c_{n-1} &  a_n
    \end{bmatrix}.
</script>
Hence, only one vector of size <code>n</code> and two of size <code>n-1</code> need to be stored to fully represent the matrix.
This particular structure also lends itself to specialized implementations for many linear algebra tasks.
Interfaces to the most common ones will soon be provided by <code>stdlib_specialmatrices</code>.
Tridiagonal matrices are available with all supported data types as <code>tridiagonal_&lt;kind&gt;_type</code>, for example:</p>
<ul>
<li><code>tridiagonal_sp_type</code>   : Tridiagonal matrix of size <code>n</code> with <code>real</code>/<code>single precision</code> data.</li>
<li><code>tridiagonal_dp_type</code>   : Tridiagonal matrix of size <code>n</code> with <code>real</code>/<code>double precision</code> data.</li>
<li><code>tridiagonal_xdp_type</code>  : Tridiagonal matrix of size <code>n</code> with <code>real</code>/<code>extended precision</code> data.</li>
<li><code>tridiagonal_qp_type</code>   : Tridiagonal matrix of size <code>n</code> with <code>real</code>/<code>quadruple precision</code> data.</li>
<li><code>tridiagonal_csp_type</code>  : Tridiagonal matrix of size <code>n</code> with <code>complex</code>/<code>single precision</code> data.</li>
<li><code>tridiagonal_cdp_type</code>  : Tridiagonal matrix of size <code>n</code> with <code>complex</code>/<code>double precision</code> data.</li>
<li><code>tridiagonal_cxdp_type</code> : Tridiagonal matrix of size <code>n</code> with <code>complex</code>/<code>extended precision</code> data.</li>
<li><code>tridiagonal_cqp_type</code>  : Tridiagonal matrix of size <code>n</code> with <code>complex</code>/<code>quadruple precision</code> data.</li>
</ul>
<h4 id="syntax">Syntax</h4>
<ul>
<li>To construct a tridiagonal matrix from already allocated arrays <code>dl</code> (lower diagonal, size <code>n-1</code>), <code>dv</code> (main diagonal, size <code>n</code>) and <code>du</code> (upper diagonal, size <code>n-1</code>):</li>
</ul>
<p><code>A =</code> <a href="../../interface/tridiagonal.html">tridiagonal</a> <code>(dl, dv, du)</code></p>
<ul>
<li>To construct a tridiagonal matrix of size <code>n x n</code> with constant diagonal elements <code>dl</code>, <code>dv</code>, and <code>du</code>:</li>
</ul>
<p><code>A =</code> <a href="../../interface/tridiagonal.html">tridiagonal</a> <code>(dl, dv, du, n)</code></p>
<h4 id="example">Example</h4>
<div class="codehilite"><pre><span></span><code><span class="k">program </span><span class="n">example_tridiagonal_matrix</span>
<span class="w">   </span><span class="k">use </span><span class="n">stdlib_linalg_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<span class="w">   </span><span class="k">use </span><span class="n">stdlib_specialmatrices</span>
<span class="w">   </span><span class="k">implicit none</span>

<span class="k">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">   </span><span class="k">type</span><span class="p">(</span><span class="n">Tridiagonal_dp_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dl</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">dv</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">du</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">   </span><span class="c">! Generate random tridiagonal elements.</span>
<span class="w">   </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
<span class="w">   </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">dv</span><span class="p">)</span>
<span class="w">   </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">du</span><span class="p">)</span>

<span class="w">   </span><span class="c">! Create the corresponding Tridiagonal matrix.</span>
<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Tridiagonal</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="p">,</span><span class="w"> </span><span class="n">du</span><span class="p">)</span>

<span class="k">end program </span><span class="n">example_tridiagonal_matrix</span>
</code></pre></div>

<h2 id="specialized-drivers-for-linear-algebra-tasks">Specialized drivers for linear algebra tasks</h2>
<p>Below is a list of all the specialized drivers for linear algebra tasks currently provided by the <code>stdlib_specialmatrices</code> module.</p>
<h3 id="spmv">Matrix-vector products with <code>spmv</code></h3>
<h4 id="status_1">Status</h4>
<p>Experimental</p>
<h4 id="description_1">Description</h4>
<p>With the exception of <code>extended precision</code> and <code>quadruple precision</code>, all the types provided by <code>stdlib_specialmatrices</code> benefit from specialized kernels for matrix-vector products accessible via the common <code>spmv</code> interface.</p>
<ul>
<li>For <code>tridiagonal</code> matrices, the backend is either LAPACK <code>lagtm</code> or the generalized routine <code>glagtm</code>, depending on the values and types of <code>alpha</code> and <code>beta</code>.</li>
</ul>
<h4 id="syntax_1">Syntax</h4>
<p><code>call</code> <a href="../../interface/spmv~2.html">spmv</a> <code>(A, x, y [, alpha, beta, op])</code></p>
<h4 id="arguments">Arguments</h4>
<ul>
<li>
<p><code>A</code> : Shall be a matrix of one of the types provided by <code>stdlib_specialmatrices</code>. It is an <code>intent(in)</code> argument.</p>
</li>
<li>
<p><code>x</code> : Shall be a rank-1 or rank-2 array with the same kind as <code>A</code>. It is an <code>intent(in)</code> argument.</p>
</li>
<li>
<p><code>y</code> : Shall be a rank-1 or rank-2 array with the same kind as <code>A</code>. It is an <code>intent(inout)</code> argument.</p>
</li>
<li>
<p><code>alpha</code> (optional) : Scalar value of the same type as <code>x</code>. It is an <code>intent(in)</code> argument. By default, <code>alpha = 1</code>.</p>
</li>
<li>
<p><code>beta</code> (optional) : Scalar value of the same type as <code>y</code>. It is an <code>intent(in)</code> argument. By default <code>beta = 0</code>.</p>
</li>
<li>
<p><code>op</code> (optional) : In-place operator identifier. Shall be a character(1) argument. It can have any of the following values: <code>N</code>: no transpose, <code>T</code>: transpose, <code>H</code>: hermitian or complex transpose.</p>
</li>
</ul>
<h4 id="examples">Examples</h4>
<div class="codehilite"><pre><span></span><code><span class="k">program </span><span class="n">example_tridiagonal_matrix</span>
<span class="w">   </span><span class="k">use </span><span class="n">stdlib_linalg_constants</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dp</span>
<span class="w">   </span><span class="k">use </span><span class="n">stdlib_specialmatrices</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">tridiagonal_dp_type</span><span class="p">,</span><span class="w"> </span><span class="n">tridiagonal</span><span class="p">,</span><span class="w"> </span><span class="n">dense</span><span class="p">,</span><span class="w"> </span><span class="n">spmv</span>
<span class="w">   </span><span class="k">implicit none</span>

<span class="k">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">   </span><span class="k">type</span><span class="p">(</span><span class="n">tridiagonal_dp_type</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">A</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dl</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">dv</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">du</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">   </span><span class="kt">real</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="w"> </span><span class="n">y_dense</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>

<span class="w">   </span><span class="c">! Create an arbitrary tridiagonal matrix.</span>
<span class="w">   </span><span class="n">dl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span><span class="w"> </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)];</span><span class="w"> </span><span class="n">du</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)]</span>
<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tridiagonal</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="p">,</span><span class="w"> </span><span class="n">du</span><span class="p">)</span>

<span class="w">   </span><span class="c">! Initialize vectors.</span>
<span class="w">   </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_dp</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span><span class="p">;</span><span class="w"> </span><span class="n">y_dense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_dp</span>

<span class="w">   </span><span class="c">! Perform matrix-vector products.</span>
<span class="w">   </span><span class="k">call </span><span class="n">spmv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">   </span><span class="n">y_dense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">matmul</span><span class="p">(</span><span class="n">dense</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>

<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dense       :&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y_dense</span>
<span class="w">   </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Tridiagonal :&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span>

<span class="k">end program </span><span class="n">example_tridiagonal_matrix</span>
</code></pre></div>

<h2 id="utility-functions">Utility functions</h2>
<h3 id="dense"><code>dense</code> : converting a special matrix to a standard Fortran array</h3>
<h4 id="status_2">Status</h4>
<p>Experimental</p>
<h4 id="description_2">Description</h4>
<p>Utility function to convert all the matrix types provided by <code>stdlib_specialmatrices</code> to a standard rank-2 array of the appropriate kind.</p>
<h4 id="syntax_2">Syntax</h4>
<p><code>B =</code> <a href="../../interface/dense.html">dense</a> <code>(A)</code></p>
<h4 id="arguments_1">Arguments</h4>
<ul>
<li>
<p><code>A</code> : Shall be a matrix of one of the types provided by <code>stdlib_specialmatrices</code>. It is an <code>intent(in)</code> argument.</p>
</li>
<li>
<p><code>B</code> : Shall be a rank-2 allocatable array of the appropriate <code>real</code> or <code>complex</code> kind.</p>
</li>
</ul>
<h3 id="transpose"><code>transpose</code> : Transposition of a special matrix</h3>
<h4 id="status_3">Status</h4>
<p>Experimental</p>
<h4 id="description_3">Description</h4>
<p>Utility function returning the transpose of a special matrix. The returned matrix is of the same type and kind as the input one.</p>
<h4 id="syntax_3">Syntax</h4>
<p><code>B =</code> <a href="../../interface/transpose.html">transpose</a> <code>(A)</code></p>
<h4 id="arguments_2">Arguments</h4>
<ul>
<li>
<p><code>A</code> : Shall be a matrix of one of the types provided by <code>stdlib_specialmatrices</code>. It is an <code>intent(in)</code> argument.</p>
</li>
<li>
<p><code>B</code> : Shall be a matrix of one of the same type and kind as <code>A</code>.</p>
</li>
</ul>
<h3 id="hermitian"><code>hermitian</code> : Complex-conjugate transpose of a special matrix</h3>
<h4 id="status_4">Status</h4>
<p>Experimental</p>
<h4 id="description_4">Description</h4>
<p>Utility function returning the complex-conjugate transpose of a special matrix. The returned matrix is of the same type and kind as the input one. For real-valued matrices, <code>hermitian</code> is equivalent to <code>transpose</code>.</p>
<h4 id="syntax_4">Syntax</h4>
<p><code>B =</code> <a href="../../interface/hermitian~2.html">hermitian</a> <code>(A)</code></p>
<h4 id="arguments_3">Arguments</h4>
<ul>
<li>
<p><code>A</code> : Shall be a matrix of one of the types provided by <code>stdlib_specialmatrices</code>. It is an <code>intent(in)</code> argument.</p>
</li>
<li>
<p><code>B</code> : Shall be a matrix of one of the same type and kind as <code>A</code>.</p>
</li>
</ul>
<h3 id="operators">Operator overloading (<code>+</code>, <code>-</code>, <code>*</code>)</h3>
<h4 id="status_5">Status</h4>
<p>Experimental</p>
<h4 id="description_5">Description</h4>
<p>The definition of all standard artihmetic operators have been overloaded to be applicable for the matrix types defined by <code>stdlib_specialmatrices</code>:</p>
<ul>
<li>Overloading the <code>+</code> operator for adding two matrices of the same type and kind.</li>
<li>Overloading the <code>-</code> operator for subtracting two matrices of the same type and kind.</li>
<li>Overloading the <code>*</code> for scalar-matrix multiplication.</li>
</ul>
<h4 id="syntax_5">Syntax</h4>
<ul>
<li>Adding two matrices of the same type:</li>
</ul>
<p><code>C = A</code> [[stdlib_specialmatrices(module):operator(+)(interface)]] <code>B</code></p>
<ul>
<li>Subtracting two matrices of the same type:</li>
</ul>
<p><code>C = A</code> [[stdlib_specialmatrices(module):operator(-)(interface)]] <code>B</code></p>
<ul>
<li>Scalar multiplication</li>
</ul>
<p><code>B = alpha</code> [[stdlib_specialmatrices(module):operator(*)(interface)]] <code>A</code></p>
<div class="alert alert-info">
<p class="alert-title h4">Note</p>
<p>For addition (<code>+</code>) and subtraction (<code>-</code>), matrices <code>A</code>, <code>B</code> and <code>C</code> all need to be of the same type and kind. For scalar multiplication (<code>*</code>), <code>A</code> and <code>B</code> need to be of the same type and kind, while <code>alpha</code> is either <code>real</code> or <code>complex</code> (with the same kind again) depending on the type being used.</p>
</div>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              Fortran-lang/stdlib
 was developed by fortran-lang/stdlib contributors<br>              &copy; 2026 <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
<br /><small>9da8d33e</small></p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2026-01-09 08:55 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>